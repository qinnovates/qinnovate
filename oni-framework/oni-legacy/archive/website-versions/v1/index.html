<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XNPBK7CRGG"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XNPBK7CRGG');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONI Model | Neural Security Standard</title>
    <meta name="description" content="BCIs are being implanted in humans today — with no security standard. ONI is building one. 14 layers extending OSI into the biological domain.">
    <meta name="keywords" content="BCI security, neural interface, brain-computer interface, neurosecurity, ONI model, neural security standard, neuroethics">

    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://unpkg.com https://www.googletagmanager.com; style-src 'self' 'unsafe-inline' https://unpkg.com; img-src 'self' https: data:; connect-src 'self' https://raw.githubusercontent.com https://api.github.com https://www.google-analytics.com https://analytics.google.com; font-src 'self';">

    <!-- Three.js 3D Engine -->
    <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>

    <!-- AOS (Animate on Scroll) - CDN with SRI -->
    <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet" integrity="sha384-/rJKQnzOkEo+daG0jMjU1IwwY9unxt1NBw3Ef2fmOJ3PW/TfAg2KXVoWwMZQZtw9" crossorigin="anonymous">

    <!-- Open Graph -->
    <meta property="og:title" content="ONI Model | The OSI of Mind">
    <meta property="og:description" content="The neural security standard. 14 layers extending OSI to protect brain-computer interfaces.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://qinnovates.github.io/ONI/">
    <meta property="og:image" content="https://qinnovates.github.io/ONI/images/ONI_Banner_Logo.png">
    <meta property="og:video" content="https://qinnovates.github.io/ONI/video/ONI-Demo-720p.mp4">

    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: rgba(17, 24, 39, 0.85);
            --bg-card: rgba(26, 35, 50, 0.9);
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-cyan: #06b6d4;
            --accent-pink: #ec4899;
            --accent-amber: #f59e0b;
            --accent-emerald: #10b981;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #1e293b;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html {
            scroll-behavior: smooth;
            background: var(--bg-primary);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: transparent;
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }

        /* Hyperspeed Canvas Background */
        #hyperspeed-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 0;
            pointer-events: none;
        }

        /* Content layers above canvas */
        nav { z-index: 100; }
        .hero, .section, section, footer { position: relative; z-index: 1; }

        /* ONI Layers Animation */
        .oni-layers-stack {
            display: flex;
            flex-direction: column;
            gap: 4px;
            padding: 20px 20px 20px 50px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
            position: relative;
        }

        .oni-layer-bar {
            height: 42px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            opacity: 0;
            transform: translateX(-30px) scale(0.95);
            transition: opacity 0.4s ease-out, transform 0.4s ease-out, box-shadow 0.3s ease;
            cursor: pointer;
            pointer-events: auto;
        }

        .oni-layer-bar:hover {
            filter: brightness(1.15);
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
        }

        .oni-layer-bar.visible {
            opacity: 1;
            transform: translateX(0) scale(1);
        }

        .oni-layer-bar.active {
            transform: translateX(0) scale(1.03);
        }

        .oni-layer-bar.gateway {
            height: 52px;
            border-radius: 10px;
            transition: opacity 0.4s ease-out, transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.5s ease, height 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .oni-layer-bar.gateway.active {
            box-shadow: 0 0 30px rgba(255, 150, 50, 0.6), 0 0 60px rgba(255, 150, 50, 0.3);
            transform: translateX(0) scale(1.06);
        }

        /* L8 Expanded state - DRAMATIC expansion during scroll snap */
        .oni-layer-bar.gateway.expanded {
            height: 120px;
            transform: translateX(0) scale(1.35);
            box-shadow:
                0 0 60px rgba(255, 150, 50, 1),
                0 0 120px rgba(255, 150, 50, 0.7),
                0 0 180px rgba(255, 150, 50, 0.4),
                0 0 240px rgba(255, 100, 0, 0.2),
                inset 0 0 30px rgba(255, 255, 255, 0.15);
            z-index: 100;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            animation: gatewayBreathing 2s ease-in-out infinite;
        }

        @keyframes gatewayBreathing {
            0%, 100% {
                transform: translateX(0) scale(1.35);
                box-shadow:
                    0 0 60px rgba(255, 150, 50, 1),
                    0 0 120px rgba(255, 150, 50, 0.7),
                    0 0 180px rgba(255, 150, 50, 0.4);
            }
            50% {
                transform: translateX(0) scale(1.4);
                box-shadow:
                    0 0 80px rgba(255, 150, 50, 1),
                    0 0 160px rgba(255, 150, 50, 0.8),
                    0 0 240px rgba(255, 150, 50, 0.5),
                    0 0 300px rgba(255, 100, 0, 0.3);
            }
        }

        .oni-layer-bar.gateway.expanded .oni-layer-id {
            font-size: 1.8rem !important;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .oni-layer-bar.gateway.expanded .oni-layer-name {
            font-size: 1.4rem !important;
            font-weight: 700 !important;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .oni-layer-bar.gateway.expanded .oni-layer-zone {
            font-size: 1.1rem !important;
            color: rgba(255, 255, 255, 0.8) !important;
        }


        .oni-layer-id {
            font-weight: 700;
            font-size: 0.95rem;
            color: #fff;
            font-family: 'SF Mono', 'Monaco', monospace;
            min-width: 32px;
        }

        .oni-layer-name {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.9);
            flex: 1;
            margin-left: 12px;
        }

        .oni-layer-zone {
            font-size: 0.7rem;
            color: rgba(255,255,255,0.5);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .oni-zone-label {
            position: absolute;
            left: 8px;
            font-size: 0.65rem;
            font-weight: 600;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            transform: rotate(180deg);
            opacity: 0;
            transition: opacity 0.4s ease;
            white-space: nowrap;
        }

        .oni-zone-label.visible {
            opacity: 1;
        }

        .oni-zone-label.silicon {
            color: #60a5fa;
            top: 20px;
            height: 322px; /* Spans L1-L7 */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .oni-zone-label.biology {
            color: #4ade80;
            bottom: 20px;
            height: 276px; /* Spans L9-L14 */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 1rem 2rem;
            background: rgba(10, 15, 26, 0.9);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border);
        }

        .nav-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            text-decoration: none;
            letter-spacing: -0.02em;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: color 0.2s;
        }

        .nav-links a:hover { color: var(--text-primary); }

        .nav-links .nav-model {
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #10b981 !important;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .nav-links .nav-model:hover {
            background: rgba(16, 185, 129, 0.25);
            border-color: rgba(16, 185, 129, 0.5);
            transform: translateY(-1px);
        }

        .nav-links .nav-demo {
            background: rgba(139, 92, 246, 0.15);
            border: 1px solid rgba(139, 92, 246, 0.3);
            color: var(--accent-purple) !important;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .nav-links .nav-demo:hover {
            background: rgba(139, 92, 246, 0.25);
            border-color: rgba(139, 92, 246, 0.5);
            transform: translateY(-1px);
        }

        .alpha-tag {
            font-size: 0.6rem;
            background: rgba(139, 92, 246, 0.3);
            color: var(--accent-purple);
            padding: 0.1rem 0.35rem;
            border-radius: 3px;
            margin-left: 0.4rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            vertical-align: middle;
            font-weight: 600;
        }

        /* Hero */
        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            padding: 8rem 2rem 4rem;
            background:
                radial-gradient(ellipse at 30% 20%, rgba(59, 130, 246, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 80%, rgba(139, 92, 246, 0.06) 0%, transparent 50%);
        }

        .hero-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }

        .hero-content h1 {
            font-size: 3.5rem;
            font-weight: 700;
            letter-spacing: -0.03em;
            line-height: 1.1;
            margin-bottom: 0.5rem;
        }

        .hero-content h1 span {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-tagline {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            font-weight: 400;
        }

        .hero-desc {
            color: var(--text-muted);
            font-size: 1.1rem;
            margin-bottom: 2rem;
            max-width: 480px;
        }

        .hero-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.875rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            text-decoration: none;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: #243044;
            border-color: var(--accent-blue);
        }

        .hero-image {
            display: flex;
            justify-content: center;
        }

        .hero-image img {
            max-width: 100%;
            height: auto;
            max-height: 500px;
            border-radius: 16px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        /* Layer Pills */
        .layer-pills {
            display: flex;
            gap: 0.75rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .pill {
            padding: 0.5rem 1rem;
            border-radius: 100px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .pill-silicon { background: rgba(59, 130, 246, 0.15); color: #60a5fa; }
        .pill-bridge { background: rgba(245, 158, 11, 0.15); color: #fbbf24; }
        .pill-biology { background: rgba(236, 72, 153, 0.15); color: #f472b6; }

        /* === ONI 3D Visualization === */
        #oni-3d-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            height: 600px;
            margin: 0 auto;
            border-radius: 16px;
            overflow: hidden;
            background: radial-gradient(ellipse at center, rgba(15, 23, 42, 0.8) 0%, rgba(10, 15, 26, 0.95) 70%);
        }

        #oni-3d-container canvas {
            width: 100% !important;
            height: 100% !important;
            display: block;
        }

        .oni3d-label {
            position: absolute;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            padding: 6px 14px;
            border-radius: 6px;
            background: rgba(0, 0, 0, 0.55);
            backdrop-filter: blur(6px);
            pointer-events: none;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 1s ease;
        }

        .oni3d-label.visible { opacity: 1; }

        .oni3d-label-silicon {
            color: #60a5fa;
            border: 1px solid rgba(96, 165, 250, 0.3);
            top: 12%;
            right: 8%;
        }

        .oni3d-label-gateway {
            color: #fbbf24;
            border: 1px solid rgba(251, 191, 36, 0.4);
            right: 6%;
            top: 46%;
        }

        .oni3d-label-biology {
            color: #f472b6;
            border: 1px solid rgba(244, 114, 185, 0.3);
            bottom: 14%;
            right: 8%;
        }

        #oni3d-signal-log {
            position: absolute;
            bottom: 12px;
            left: 12px;
            display: flex;
            flex-direction: column;
            gap: 4px;
            pointer-events: none;
            z-index: 10;
        }

        .oni3d-log-entry {
            font-size: 0.65rem;
            font-weight: 500;
            font-family: 'SF Mono', Monaco, monospace;
            letter-spacing: 0.03em;
            padding: 3px 8px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            white-space: nowrap;
            opacity: 1;
            transition: opacity 0.5s ease;
        }

        .oni3d-log-entry.fade { opacity: 0; }

        .oni3d-legend {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .oni3d-legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .oni3d-legend-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }

        #oni-3d-container { cursor: crosshair; }

        #oni3d-explainer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 380px;
            max-width: 85%;
            background: rgba(10, 15, 30, 0.92);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(59, 130, 246, 0.25);
            border-radius: 12px;
            padding: 1.5rem 1.75rem;
            z-index: 20;
            color: var(--text-primary);
            font-size: 0.85rem;
            line-height: 1.6;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6), 0 0 40px rgba(59, 130, 246, 0.08);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        #oni3d-explainer.hidden {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.95);
            pointer-events: none;
        }

        #oni3d-explainer h4 {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.6rem;
            color: var(--accent-cyan);
            letter-spacing: 0.02em;
        }

        #oni3d-explainer p {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        #oni3d-explainer strong {
            color: var(--text-primary);
        }

        #oni3d-explainer ul {
            list-style: none;
            padding: 0;
            margin: 0.5rem 0;
        }

        #oni3d-explainer ul li {
            padding: 0.2rem 0;
            color: var(--text-secondary);
        }

        #oni3d-explainer ul li::before {
            content: '→ ';
            color: var(--text-muted);
        }

        #oni3d-explainer-close {
            position: absolute;
            top: 10px;
            right: 12px;
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.4rem;
            cursor: pointer;
            padding: 0;
            line-height: 1;
            transition: color 0.2s;
        }

        #oni3d-explainer-close:hover {
            color: var(--text-primary);
        }

        /* Section */
        .section {
            padding: 6rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-header h2 {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .section-header p {
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Quick Start Grid */
        .quick-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .quick-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            transition: all 0.2s;
            text-decoration: none;
            color: inherit;
            display: block;
        }

        .quick-card:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
        }

        a.quick-card:hover {
            cursor: pointer;
        }

        .quick-card .icon {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.5rem;
        }

        .quick-card h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .quick-card p {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .quick-card a {
            color: var(--accent-blue);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .quick-card a:hover { text-decoration: underline; }

        /* Visualization Cards */
        .viz-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.25rem;
        }

        @media (max-width: 1000px) {
            .viz-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 650px) {
            .viz-grid { grid-template-columns: 1fr; }
        }

        .viz-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.2s;
            text-decoration: none;
            color: inherit;
            display: block;
        }

        .viz-card:hover {
            border-color: var(--accent-purple);
            transform: translateY(-3px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
        }

        .viz-preview {
            height: 140px;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid var(--border);
        }

        .viz-preview svg {
            width: 85%;
            height: 85%;
            opacity: 0.9;
        }

        .viz-content {
            padding: 1.25rem;
        }

        .viz-card .label {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        .viz-card h4 {
            font-size: 1rem;
            margin-bottom: 0.375rem;
        }

        .viz-card p {
            color: var(--text-muted);
            font-size: 0.85rem;
            line-height: 1.5;
        }

        /* Stats Row */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1.5rem;
            padding: 3rem;
            background: var(--bg-secondary);
            border-radius: 16px;
            margin-bottom: 4rem;
        }

        .stat {
            text-align: center;
            text-decoration: none;
            color: inherit;
            padding: 1rem;
            border-radius: 12px;
            transition: all 0.2s;
            display: block;
        }

        .stat:hover {
            background: rgba(59, 130, 246, 0.1);
            transform: translateY(-2px);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat:hover .stat-value {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-top: 0.25rem;
        }

        .stat:hover .stat-label {
            color: var(--text-secondary);
        }

        /* Resources */
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.25rem;
        }

        .resource-card {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            text-decoration: none;
            color: inherit;
            transition: all 0.2s;
        }

        .resource-card:hover {
            border-color: var(--accent-cyan);
        }

        .resource-card .icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 1.25rem;
        }

        .resource-card h4 {
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }

        .resource-card p {
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 3rem 2rem;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        footer a {
            color: var(--text-secondary);
            text-decoration: none;
        }

        footer a:hover { color: var(--text-primary); }

        .footer-links {
            display: flex;
            gap: 2rem;
            justify-content: center;
            margin-bottom: 1rem;
        }

        /* Code Block */
        .code-block {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem 1.25rem;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 0.9rem;
            color: var(--accent-cyan);
            margin-top: 1rem;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .hero-inner { grid-template-columns: 1fr; text-align: center; }
            .hero-content h1 { font-size: 2.5rem; }
            .hero-desc { margin: 0 auto 2rem; }
            .hero-actions { justify-content: center; }
            .layer-pills { justify-content: center; }
            .hero-image { order: -1; margin-bottom: 2rem; }
            .hero-image img { max-height: 350px; }
            #oni-3d-container { height: 400px; }
            .oni3d-label { font-size: 0.65rem; }
            .quick-grid { grid-template-columns: 1fr; }
            .stats-row { grid-template-columns: repeat(3, 1fr); }
            .resources-grid { grid-template-columns: 1fr; }
            .nav-links { display: none; }
        }

        @media (max-width: 600px) {
            .hero-content h1 { font-size: 2rem; }
            .section { padding: 4rem 1.5rem; }
            #oni-3d-container { height: 320px; }
        }

        @media (max-width: 900px) {
            #problem > div > div:last-of-type { grid-template-columns: 1fr !important; }
            #audience > div:last-of-type { grid-template-columns: repeat(2, 1fr) !important; }
            #vision > div > div:last-of-type { grid-template-columns: 1fr !important; }
            #contribute > div:first-of-type { grid-template-columns: 1fr !important; }
        }

        @media (max-width: 600px) {
            #audience > div:last-of-type { grid-template-columns: 1fr !important; }
        }

        /* ============================================
           DYNAMIC ANIMATIONS
           ============================================ */

        /* Hero text gradient animation */
        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .hero-content h1 span {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple), var(--accent-cyan), var(--accent-blue));
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-shift 6s ease infinite;
        }

        /* Floating animation for pills */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-6px); }
        }

        .pill {
            animation: float 3s ease-in-out infinite;
        }
        .pill:nth-child(2) { animation-delay: 0.5s; }
        .pill:nth-child(3) { animation-delay: 1s; }

        /* Pulse animation for stats */
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0); }
            50% { box-shadow: 0 0 30px rgba(59, 130, 246, 0.3); }
        }

        .stat:hover {
            animation: pulse-glow 2s ease-in-out infinite;
        }

        /* Card shimmer effect on hover */
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .viz-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
            background-size: 200% 100%;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            border-radius: 12px;
        }

        .viz-card:hover::before {
            opacity: 1;
            animation: shimmer 1.5s infinite;
        }

        .viz-card {
            position: relative;
        }

        /* Animated background gradient for hero */
        .hero {
            background:
                radial-gradient(ellipse at 30% 20%, rgba(59, 130, 246, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 80%, rgba(139, 92, 246, 0.06) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(6, 182, 212, 0.04) 0%, transparent 60%);
            animation: bg-pulse 8s ease-in-out infinite alternate;
        }

        @keyframes bg-pulse {
            0% {
                background:
                    radial-gradient(ellipse at 30% 20%, rgba(59, 130, 246, 0.08) 0%, transparent 50%),
                    radial-gradient(ellipse at 70% 80%, rgba(139, 92, 246, 0.06) 0%, transparent 50%),
                    radial-gradient(ellipse at 50% 50%, rgba(6, 182, 212, 0.04) 0%, transparent 60%);
            }
            100% {
                background:
                    radial-gradient(ellipse at 40% 30%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                    radial-gradient(ellipse at 60% 70%, rgba(59, 130, 246, 0.08) 0%, transparent 50%),
                    radial-gradient(ellipse at 50% 50%, rgba(236, 72, 153, 0.05) 0%, transparent 60%);
            }
        }

        /* Typing cursor effect */
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .hero-desc::after {
            content: '|';
            animation: blink 1s step-end infinite;
            margin-left: 2px;
            color: var(--accent-cyan);
        }

        /* Neural network dots animation in background */
        .neural-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            pointer-events: none;
            z-index: 0;
        }

        .neural-dot {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--accent-blue);
            border-radius: 50%;
            opacity: 0.3;
            animation: neural-pulse 4s ease-in-out infinite;
        }

        @keyframes neural-pulse {
            0%, 100% { transform: scale(1); opacity: 0.2; }
            50% { transform: scale(1.5); opacity: 0.5; }
        }

        /* Text reveal animation - left to right */
        @keyframes text-reveal {
            from { max-width: 0; }
            to { max-width: 100%; }
        }

        .text-reveal {
            display: inline-block;
            overflow: hidden;
            white-space: nowrap;
            max-width: 0;
            vertical-align: bottom;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .text-reveal.animate {
            animation: text-reveal 1.2s ease-out forwards;
        }

        /* Button hover glow */
        .btn-primary {
            position: relative;
            overflow: hidden;
        }

        .btn-primary::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-primary:hover::after {
            width: 300px;
            height: 300px;
        }

        /* Stats counter animation */
        .stat-value {
            display: inline-block;
        }

        /* Smooth reveal for sections */
        [data-aos] {
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Video Player Styles */
        .video-container {
            position: relative;
            cursor: pointer;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .video-container:hover {
            transform: scale(1.02);
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.6);
        }

        .video-thumbnail {
            position: relative;
            width: 100%;
        }

        .video-thumbnail img {
            width: 100%;
            height: auto;
            display: block;
        }

        .play-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.4);
            transition: background 0.3s ease;
        }

        .video-container:hover .play-overlay {
            background: rgba(0, 0, 0, 0.3);
        }

        .play-button {
            width: 80px;
            height: 80px;
            background: var(--accent-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 40px rgba(59, 130, 246, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .video-container:hover .play-button {
            transform: scale(1.1);
            box-shadow: 0 15px 50px rgba(59, 130, 246, 0.6);
        }

        .play-button svg {
            width: 30px;
            height: 30px;
            fill: white;
            margin-left: 4px;
        }

        .video-label {
            position: absolute;
            bottom: 16px;
            left: 16px;
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            backdrop-filter: blur(8px);
        }

        .video-duration {
            position: absolute;
            bottom: 16px;
            right: 16px;
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.85rem;
            color: var(--text-primary);
            font-family: 'SF Mono', Monaco, monospace;
            backdrop-filter: blur(8px);
        }

        /* Video Modal */
        .video-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            padding: 2rem;
            align-items: center;
            justify-content: center;
        }

        .video-modal.active {
            display: flex;
        }

        .video-modal-content {
            position: relative;
            max-width: 1200px;
            width: 100%;
        }

        .video-modal video {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.5);
        }

        .video-close {
            position: absolute;
            top: -40px;
            right: 0;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 2rem;
            cursor: pointer;
            padding: 8px;
            transition: color 0.2s;
        }

        .video-close:hover {
            color: var(--text-primary);
        }

        /* Coming soon badge for video */
        .coming-soon-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-pink));
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
    </style>
</head>
<body>
    <!-- Hyperspeed Starfield Background -->
    <canvas id="hyperspeed-canvas"></canvas>
    <nav>
        <div class="nav-inner">
            <a href="#" class="nav-logo">ONI Neural Security</a>
            <ul class="nav-links">
                <li><a href="#mission">Mission</a></li>
                <li><a href="#explore">Explore</a></li>
                <li><a href="#vision">Roadmap</a></li>
                <li><a href="#contribute">Contribute</a></li>
                <li><a href="../documentation/">Docs</a></li>
                <li><a href="https://github.com/qinnovates/mindloft">GitHub</a></li>
                <li><a href="https://medium.com/@qikevinl" target="_blank" rel="noopener">Blogs</a></li>
                <li><a href="../visualizations/08-oni-framework-viz.html" class="nav-model">ONI Model</a></li>
                <li><a href="https://frontend-phi-seven-64.vercel.app" target="_blank" rel="noopener" class="nav-demo" title="Interactive learning demo built on ONI">ONI Search <span class="alpha-tag">WIP</span></a></li>
            </ul>
        </div>
    </nav>

    <section class="hero">
        <!-- Animated neural network background dots -->
        <div class="neural-bg" id="neuralBg"></div>

        <div class="hero-inner" style="position: relative; z-index: 1;">
            <div class="hero-content">
                <p data-aos="fade-down" data-aos-delay="100" style="font-size: 0.9rem; color: var(--accent-cyan); font-weight: 600; letter-spacing: 0.1em; margin-bottom: 0.5rem;">NEURAL SECURITY STANDARD</p>
                <h1 data-aos="fade-up" data-aos-delay="200"><span>ONI</span> Framework</h1>
                <p class="hero-tagline" data-aos="fade-up" data-aos-delay="300"><em>The OSI of Mind</em></p>

                <p class="hero-desc" data-aos="fade-up" data-aos-delay="400">
                    Securing the most important connection you'll ever make.
                </p>

                <div class="hero-actions" data-aos="fade-up" data-aos-delay="500">
                    <a href="../whitepaper/" class="btn btn-primary">
                        Read Whitepaper
                    </a>
                    <a href="https://github.com/qinnovates/mindloft" class="btn btn-secondary">
                        View on GitHub
                    </a>
                </div>

                <div class="layer-pills" data-aos="fade-up" data-aos-delay="600">
                    <span class="pill pill-silicon">L1-L7 Silicon</span>
                    <span class="pill pill-bridge">L8 Neural Gateway</span>
                    <span class="pill pill-biology">L9-L14 Biology</span>
                </div>
            </div>

            <div class="hero-image">
                <div class="video-container" onclick="openVideoModal()">
                    <div class="video-thumbnail">
                        <img src="../images/ONI_Banner_Logo.png" alt="ONI Model - Neural Security Standard">
                        <div class="play-overlay">
                            <div class="play-button">
                                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8 5v14l11-7z"/>
                                </svg>
                            </div>
                        </div>
                        <div class="video-label">Watch Demo</div>
                        <div class="video-duration">3:51</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Slogan Banner -->
    <div style="text-align: center; padding: 3rem 2rem;" data-aos="fade-up">
        <p id="slogan-text" style="font-size: 1.75rem; font-style: italic; color: var(--text-secondary); font-weight: 300; letter-spacing: 0.02em;">Only life's most important connections deserve the most thought.™</p>
    </div>

    <section class="section" id="install" style="padding-top: 2rem;">
        <!-- ONI Layers Animation - Scroll Reveal -->
        <div style="text-align: center; margin-bottom: 2rem;">
            <!-- Section Title -->
            <h2 style="font-size: 2.5rem; font-weight: 700; color: var(--text-primary); margin-bottom: 0.5rem; letter-spacing: -0.02em;">From OSI to ONI</h2>
            <p style="font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 2rem; font-weight: 400;">The 14 layers that complete bio-digital interoperability</p>

            <div id="layers-reveal-container" style="display: inline-block; position: relative; max-width: 600px; width: 100%;">
                <div class="oni-layers-stack">
                    <!-- Silicon Layers (L1-L7) -->
                    <div class="oni-zone-label silicon">Silicon Layers — OSI Model</div>
                    <div class="oni-layer-bar" data-layer="1" style="background: linear-gradient(135deg, #1e3a5f, #2d4a6f);">
                        <span class="oni-layer-id">L1</span>
                        <span class="oni-layer-name">Physical Carrier</span>
                        <span class="oni-layer-zone">Physical</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="2" style="background: linear-gradient(135deg, #1e4d6f, #2d5d7f);">
                        <span class="oni-layer-id">L2</span>
                        <span class="oni-layer-name">Signal Processing</span>
                        <span class="oni-layer-zone">Data Link</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="3" style="background: linear-gradient(135deg, #1e5f7f, #2d6f8f);">
                        <span class="oni-layer-id">L3</span>
                        <span class="oni-layer-name">Protocol</span>
                        <span class="oni-layer-zone">Network</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="4" style="background: linear-gradient(135deg, #1e6f8f, #2d7f9f);">
                        <span class="oni-layer-id">L4</span>
                        <span class="oni-layer-name">Transport</span>
                        <span class="oni-layer-zone">Transport</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="5" style="background: linear-gradient(135deg, #1e7f9f, #2d8faf);">
                        <span class="oni-layer-id">L5</span>
                        <span class="oni-layer-name">Session</span>
                        <span class="oni-layer-zone">Session</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="6" style="background: linear-gradient(135deg, #1e8faf, #3d9fbf);">
                        <span class="oni-layer-id">L6</span>
                        <span class="oni-layer-name">Presentation</span>
                        <span class="oni-layer-zone">Presentation</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="7" style="background: linear-gradient(135deg, #2d9fbf, #4dafcf);">
                        <span class="oni-layer-id">L7</span>
                        <span class="oni-layer-name">Application Interface</span>
                        <span class="oni-layer-zone">Application</span>
                    </div>

                    <!-- Neural Gateway (L8) -->
                    <div class="oni-layer-bar gateway" data-layer="8" style="background: linear-gradient(135deg, #b45309, #d97706, #f59e0b);">
                        <span class="oni-layer-id" style="font-size: 1.1rem;">L8</span>
                        <span class="oni-layer-name" style="font-weight: 600;">Neural Gateway</span>
                        <span class="oni-layer-zone" style="color: rgba(255,255,255,0.7);">Firewall</span>
                    </div>

                    <!-- Biology Layers (L9-L14) -->
                    <div class="oni-zone-label biology">Biology Layers — Cognitive Systems</div>
                    <div class="oni-layer-bar" data-layer="9" style="background: linear-gradient(135deg, #14532d, #166534);">
                        <span class="oni-layer-id">L9</span>
                        <span class="oni-layer-name">Signal Processing</span>
                        <span class="oni-layer-zone">Filtering</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="10" style="background: linear-gradient(135deg, #166534, #15803d);">
                        <span class="oni-layer-id">L10</span>
                        <span class="oni-layer-name">Neural Protocol</span>
                        <span class="oni-layer-zone">Encoding</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="11" style="background: linear-gradient(135deg, #15803d, #16a34a);">
                        <span class="oni-layer-id">L11</span>
                        <span class="oni-layer-name">Cognitive Transport</span>
                        <span class="oni-layer-zone">Delivery</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="12" style="background: linear-gradient(135deg, #16a34a, #22c55e);">
                        <span class="oni-layer-id">L12</span>
                        <span class="oni-layer-name">Cognitive Session</span>
                        <span class="oni-layer-zone">Context</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="13" style="background: linear-gradient(135deg, #22c55e, #4ade80);">
                        <span class="oni-layer-id">L13</span>
                        <span class="oni-layer-name">Semantic Layer</span>
                        <span class="oni-layer-zone">Intent</span>
                    </div>
                    <div class="oni-layer-bar" data-layer="14" style="background: linear-gradient(135deg, #4ade80, #86efac);">
                        <span class="oni-layer-id">L14</span>
                        <span class="oni-layer-name">Identity Layer</span>
                        <span class="oni-layer-zone">Self</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="stats-row" data-aos="fade-up">
            <a href="../visualizations/06-oni-threat-matrix.html" class="stat" data-aos="zoom-in" data-aos-delay="100">
                <div class="stat-value" id="stat-threats" data-count="25" data-suffix="+">25+</div>
                <div class="stat-label">Threat Signatures</div>
            </a>
            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/legacy-core/oni-framework/ONI_LAYERS.md" class="stat" data-aos="zoom-in" data-aos-delay="200">
                <div class="stat-value" id="stat-layers" data-count="14">14</div>
                <div class="stat-label">Layers</div>
            </a>
            <a href="../visualizations/" class="stat" data-aos="zoom-in" data-aos-delay="300">
                <div class="stat-value" id="stat-tools" data-count="6">6</div>
                <div class="stat-label">Interactive Tools</div>
            </a>
            <a href="https://github.com/qinnovates/mindloft/wiki" class="stat" data-aos="zoom-in" data-aos-delay="400">
                <div class="stat-value" id="stat-portals" data-count="1">1</div>
                <div class="stat-label">Framework</div>
            </a>
            <div class="stat" data-aos="zoom-in" data-aos-delay="500">
                <div class="stat-value" style="font-size: 2.5rem;">∞</div>
                <div class="stat-label">Possibilities</div>
            </div>
        </div>

        <div class="quick-grid">
            <a href="https://pypi.org/project/oni-framework/" class="quick-card">
                <div class="icon" style="background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan));">
                    <span style="font-size: 1.2rem;">Cₛ</span>
                </div>
                <h3>Cₛ Core <span style="font-size: 0.6rem; padding: 0.2rem 0.5rem; background: rgba(59, 130, 246, 0.2); color: #60a5fa; border-radius: 4px; vertical-align: middle; margin-left: 0.5rem;">API</span></h3>
                <p>Entropy-based anomaly detection using ML-trained baselines to identify signals outside normal variance thresholds.</p>
                <div class="code-block">pip install oni-framework</div>
                <span style="color: var(--accent-blue); font-weight: 500; font-size: 0.9rem;">View on PyPI &rarr;</span>
            </a>

            <a href="https://pypi.org/project/oni-tara/" class="quick-card">
                <div class="icon" style="background: linear-gradient(135deg, var(--accent-purple), var(--accent-pink));">
                    <span>T</span>
                </div>
                <h3>TARA Stack <span style="font-size: 0.6rem; padding: 0.2rem 0.5rem; background: rgba(139, 92, 246, 0.2); color: #a78bfa; border-radius: 4px; vertical-align: middle; margin-left: 0.5rem;">MVP</span></h3>
                <p style="padding: 0 1.5rem;">Telemetry Analysis & Response Automation platform with real-time monitoring.</p>
                <div class="code-block">pip install oni-tara</div>
                <span style="color: var(--accent-purple); font-weight: 500; font-size: 0.9rem;">View on PyPI &rarr;</span>
            </a>

            <a href="https://pypi.org/project/oni-academy/" class="quick-card">
                <div class="icon" style="background: linear-gradient(135deg, var(--accent-emerald), var(--accent-cyan));">
                    <span>A</span>
                </div>
                <h3>Autodidact <span style="font-size: 0.6rem; padding: 0.2rem 0.5rem; background: rgba(16, 185, 129, 0.2); color: #34d399; border-radius: 4px; vertical-align: middle; margin-left: 0.5rem;">EDU</span></h3>
                <p style="padding: 0 1.5rem;">AI-powered local learning engine that adapts to your style and generates personalized content, visualizations, and exercises on demand.</p>
                <div class="code-block">pip install oni-academy</div>
                <span style="color: var(--accent-emerald); font-weight: 500; font-size: 0.9rem;">View on PyPI &rarr;</span>
            </a>
        </div>
    </section>

    <section class="section" id="explore">
        <div class="section-header" data-aos="fade-up">
            <h2>Interactive Learning</h2>
            <p>These demos introduce ONI's multi-modal approach to <a href="https://github.com/qinnovates/mindloft/blob/main/autodidact/oni-academy/ONI_ACADEMY.md" style="color: var(--accent-cyan);">neurosecurity</a>.</p>
        </div>

        <div class="viz-grid">
            <!-- Coherence Metric Playground -->
            <a href="../visualizations/01-coherence-metric-playground.html" class="viz-card" data-aos="fade-up" data-aos-delay="100">
                <div class="viz-preview">
                    <svg viewBox="0 0 200 100">
                        <defs>
                            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#00d4ff"/>
                                <stop offset="100%" style="stop-color:#8b5cf6"/>
                            </linearGradient>
                        </defs>
                        <path d="M10 50 Q30 20 50 50 T90 50 T130 50 T170 50 T190 50" stroke="url(#grad1)" stroke-width="3" fill="none"/>
                        <circle cx="100" cy="50" r="20" fill="none" stroke="#00d4ff" stroke-width="2" opacity="0.5"/>
                        <text x="100" y="55" text-anchor="middle" fill="#00d4ff" font-size="12" font-weight="bold">0.87</text>
                    </svg>
                </div>
                <div class="viz-content">
                    <span class="label" style="background: rgba(59, 130, 246, 0.15); color: #60a5fa;">Core Concept</span>
                    <h4>Coherence Metric Playground</h4>
                    <p>Calculate Cₛ = e^(−(σ²φ + σ²τ + σ²γ)) in real-time. See how variance components affect signal trust scores.</p>
                </div>
            </a>

            <!-- ONI Layer Explorer -->
            <a href="../visualizations/02-oni-layer-explorer.html" class="viz-card" data-aos="fade-up" data-aos-delay="200">
                <div class="viz-preview">
                    <svg viewBox="0 0 200 100">
                        <rect x="30" y="10" width="140" height="12" rx="2" fill="#3b82f6" opacity="0.6"/>
                        <rect x="30" y="25" width="140" height="12" rx="2" fill="#3b82f6" opacity="0.5"/>
                        <rect x="30" y="40" width="140" height="12" rx="2" fill="#8b5cf6" opacity="0.7"/>
                        <rect x="30" y="55" width="140" height="12" rx="2" fill="#8b5cf6" opacity="0.6"/>
                        <rect x="30" y="70" width="140" height="12" rx="2" fill="#ec4899" opacity="0.8"/>
                        <rect x="30" y="85" width="140" height="12" rx="2" fill="#ec4899" opacity="0.7"/>
                        <text x="20" y="50" fill="#64748b" font-size="8">14</text>
                        <text x="175" y="50" fill="#64748b" font-size="8">1</text>
                    </svg>
                </div>
                <div class="viz-content">
                    <span class="label" style="background: rgba(139, 92, 246, 0.15); color: #a78bfa;">Architecture</span>
                    <h4>ONI Layer Explorer</h4>
                    <p>Navigate all 14 layers from physical transmission to cognitive identity.</p>
                </div>
            </a>

            <!-- NSAM Checkpoint Simulator -->
            <a href="../visualizations/04-nsam-checkpoint-simulator.html" class="viz-card" data-aos="fade-up" data-aos-delay="300">
                <div class="viz-preview">
                    <svg viewBox="0 0 200 100">
                        <circle cx="40" cy="50" r="15" fill="#10b981"/>
                        <circle cx="80" cy="50" r="15" fill="#10b981"/>
                        <circle cx="120" cy="50" r="15" fill="#f59e0b"/>
                        <circle cx="160" cy="50" r="15" fill="#1e293b" stroke="#64748b"/>
                        <text x="40" y="54" text-anchor="middle" fill="white" font-size="10">1</text>
                        <text x="80" y="54" text-anchor="middle" fill="white" font-size="10">2</text>
                        <text x="120" y="54" text-anchor="middle" fill="white" font-size="10">3</text>
                        <text x="160" y="54" text-anchor="middle" fill="#64748b" font-size="10">4</text>
                        <line x1="55" y1="50" x2="65" y2="50" stroke="#10b981" stroke-width="2"/>
                        <line x1="95" y1="50" x2="105" y2="50" stroke="#10b981" stroke-width="2"/>
                        <line x1="135" y1="50" x2="145" y2="50" stroke="#64748b" stroke-width="2"/>
                    </svg>
                </div>
                <div class="viz-content">
                    <span class="label" style="background: rgba(245, 158, 11, 0.15); color: #fbbf24;">Interactive</span>
                    <h4>NSAM Checkpoint Simulator</h4>
                    <p>Become the Neural Signal Assurance Model. Analyze signals and protect the brain.</p>
                </div>
            </a>

            <!-- Scale-Frequency Navigator -->
            <a href="../visualizations/05-scale-frequency-navigator.html" class="viz-card" data-aos="fade-up" data-aos-delay="400">
                <div class="viz-preview">
                    <svg viewBox="0 0 200 100">
                        <rect x="20" y="20" width="160" height="60" rx="4" fill="#0a0e17" stroke="#1e293b"/>
                        <path d="M30 50 Q50 30 70 50 T110 50 T150 50 T170 50" stroke="#ec4899" stroke-width="2" fill="none" opacity="0.5"/>
                        <path d="M30 50 Q40 40 50 50 T70 50 T90 50 T110 50 T130 50 T150 50 T170 50" stroke="#8b5cf6" stroke-width="2" fill="none"/>
                        <text x="30" y="90" fill="#64748b" font-size="8">1ms</text>
                        <text x="90" y="90" fill="#64748b" font-size="8">1s</text>
                        <text x="150" y="90" fill="#64748b" font-size="8">1hr</text>
                    </svg>
                </div>
                <div class="viz-content">
                    <span class="label" style="background: rgba(236, 72, 153, 0.15); color: #f472b6;">Explore</span>
                    <h4>Scale-Frequency Navigator</h4>
                    <p>From femtoseconds to years. Explore neural patterns across temporal scales.</p>
                </div>
            </a>

            <!-- ONI Threat Matrix -->
            <a href="../visualizations/06-oni-threat-matrix.html" class="viz-card" data-aos="fade-up" data-aos-delay="500">
                <div class="viz-preview">
                    <svg viewBox="0 0 200 100">
                        <!-- Clean MITRE-style matrix grid -->
                        <defs>
                            <linearGradient id="threatGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#3b82f6"/>
                                <stop offset="50%" style="stop-color:#8b5cf6"/>
                                <stop offset="100%" style="stop-color:#ef4444"/>
                            </linearGradient>
                        </defs>
                        <!-- Header row with gradient -->
                        <rect x="15" y="15" width="170" height="14" rx="2" fill="url(#threatGrad)" opacity="0.8"/>
                        <!-- Grid cells - 7 tactics -->
                        <rect x="15" y="32" width="22" height="50" rx="2" fill="#1e293b" stroke="#3b82f6" stroke-width="1"/>
                        <rect x="40" y="32" width="22" height="50" rx="2" fill="#1e293b" stroke="#6366f1" stroke-width="1"/>
                        <rect x="65" y="32" width="22" height="50" rx="2" fill="#1e293b" stroke="#8b5cf6" stroke-width="1"/>
                        <rect x="90" y="32" width="22" height="50" rx="2" fill="#1e293b" stroke="#a855f7" stroke-width="1"/>
                        <rect x="115" y="32" width="22" height="50" rx="2" fill="#1e293b" stroke="#d946ef" stroke-width="1"/>
                        <rect x="140" y="32" width="22" height="50" rx="2" fill="#1e293b" stroke="#ec4899" stroke-width="1"/>
                        <rect x="165" y="32" width="22" height="50" rx="2" fill="#1e293b" stroke="#ef4444" stroke-width="1"/>
                        <!-- Technique indicators -->
                        <circle cx="26" cy="42" r="3" fill="#3b82f6"/>
                        <circle cx="26" cy="52" r="3" fill="#3b82f6" opacity="0.6"/>
                        <circle cx="51" cy="42" r="3" fill="#6366f1"/>
                        <circle cx="76" cy="42" r="3" fill="#8b5cf6"/>
                        <circle cx="76" cy="52" r="3" fill="#8b5cf6" opacity="0.6"/>
                        <circle cx="101" cy="42" r="3" fill="#a855f7"/>
                        <circle cx="126" cy="42" r="3" fill="#d946ef"/>
                        <circle cx="151" cy="42" r="3" fill="#ec4899"/>
                        <circle cx="151" cy="52" r="3" fill="#ec4899" opacity="0.6"/>
                        <circle cx="176" cy="42" r="3" fill="#ef4444"/>
                        <circle cx="176" cy="52" r="3" fill="#ef4444" opacity="0.6"/>
                        <circle cx="176" cy="62" r="3" fill="#ef4444" opacity="0.4"/>
                        <text x="100" y="94" text-anchor="middle" fill="#64748b" font-size="7">7 TACTICS × 21 TECHNIQUES</text>
                    </svg>
                </div>
                <div class="viz-content">
                    <span class="label" style="background: rgba(239, 68, 68, 0.15); color: #f87171;">Security</span>
                    <h4>ONI Threat Matrix</h4>
                    <p>Neural threat framework. 7 tactics, 21 techniques mapped to ONI layers.</p>
                </div>
            </a>

            <!-- Academic Research Alignment -->
            <a href="../visualizations/03-academic-alignment.html" class="viz-card" data-aos="fade-up" data-aos-delay="600">
                <div class="viz-preview">
                    <svg viewBox="0 0 200 100">
                        <circle cx="60" cy="50" r="25" fill="none" stroke="#10b981" stroke-width="2" opacity="0.6"/>
                        <circle cx="100" cy="50" r="25" fill="none" stroke="#10b981" stroke-width="2" opacity="0.6"/>
                        <circle cx="140" cy="50" r="25" fill="none" stroke="#10b981" stroke-width="2" opacity="0.6"/>
                        <text x="60" y="54" text-anchor="middle" fill="#10b981" font-size="8">Kohno</text>
                        <text x="100" y="54" text-anchor="middle" fill="#10b981" font-size="8">ONI</text>
                        <text x="140" y="54" text-anchor="middle" fill="#10b981" font-size="8">Bonaci</text>
                        <text x="100" y="90" text-anchor="middle" fill="#64748b" font-size="7">12+ Universities</text>
                    </svg>
                </div>
                <div class="viz-content">
                    <span class="label" style="background: rgba(16, 185, 129, 0.15); color: #34d399;">Research</span>
                    <h4>Academic Research Alignment</h4>
                    <p>Built on peer-reviewed research from 12+ universities. Explore the scientific foundation.</p>
                </div>
            </a>
        </div>
    </section>

    <!-- ONI 3D Neural Security Visualization -->
    <section class="section" id="oni-neural-viz" style="padding: 4rem 2rem;">
        <div class="section-header" data-aos="fade-up">
            <h2>The Neural Security Stack</h2>
            <p>14 layers protecting the most important interface — from silicon to synapse.<br>
            <span style="color: var(--text-muted); font-size: 0.9rem;">Click anywhere on the model to inject a signal. Watch how wavefronts propagate through layers.</span></p>
        </div>
        <div id="oni-3d-container" data-aos="fade-up" data-aos-delay="200">
            <!-- Three.js canvas injected here by initONI3D() -->
            <div class="oni3d-label oni3d-label-silicon">L1–L7 Silicon</div>
            <div class="oni3d-label oni3d-label-gateway">L8 Neural Gateway</div>
            <div class="oni3d-label oni3d-label-biology">L9–L14 Biology</div>
            <!-- Signal event log -->
            <div id="oni3d-signal-log"></div>
            <!-- Explainer popup -->
            <div id="oni3d-explainer">
                <button id="oni3d-explainer-close" aria-label="Close">&times;</button>
                <h4>What You're Seeing</h4>
                <p><strong>Why circles?</strong> Waves are circles. Every brain signal is a wave, and waves are built from spinning circles (sine and cosine). A Fourier Transform breaks any signal into these circles — each with a speed, size, and starting position. ONI's Coherence Metric checks whether those circles match the patient's brain. If they don't, the signal gets blocked.</p>
                <p>This also enables <strong>active defense</strong>: detect a malicious signal's wave pattern, generate the mirror opposite, and cancel it out — the same math behind noise-cancelling headphones.</p>
                <p style="font-size:0.85rem;"><a href="SIGNAL_VISUALIZATION_DESIGN.md#why-circles-the-fourier-foundation" style="color: var(--accent-cyan);">How this works →</a></p>
                <ul style="margin-top:0.75rem;">
                    <li><span style="color:#60a5fa;">Blue</span> — normal &nbsp; <span style="color:#f87171;">Red</span> — threat &nbsp; <span style="color:#4ade80;">Green</span> — therapeutic</li>
                </ul>
                <p><strong style="color:#fbbf24;">L8</strong> checks every signal. Threats get blocked. Verified signals pass through to the brain.</p>
                <p style="color:var(--text-muted); font-size:0.8rem; margin-top:0.5rem;">Click anywhere to inject a signal.</p>
            </div>
        </div>
        <!-- Signal legend -->
        <div class="oni3d-legend" data-aos="fade-up" data-aos-delay="400">
            <div class="oni3d-legend-item">
                <span class="oni3d-legend-dot" style="background: #60a5fa;"></span>
                <span>Normal Signal</span>
            </div>
            <div class="oni3d-legend-item">
                <span class="oni3d-legend-dot" style="background: #f87171;"></span>
                <span>Threat Signal</span>
            </div>
            <div class="oni3d-legend-item">
                <span class="oni3d-legend-dot" style="background: #fbbf24;"></span>
                <span>L8 Gateway Check</span>
            </div>
            <div class="oni3d-legend-item">
                <span class="oni3d-legend-dot" style="background: #4ade80;"></span>
                <span>Signal Passed</span>
            </div>
        </div>
    </section>

    <!-- Mission Section (loads from brand.json) -->
    <section class="section" id="mission" style="background: var(--bg-secondary); margin: 0; max-width: 100%; padding: 5rem 2rem;">
        <div style="max-width: 800px; margin: 0 auto; text-align: center;">
            <div class="section-header">
                <h2>Mission</h2>
            </div>
            <div style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1)); border-left: 3px solid var(--accent-blue); padding: 1.5rem 2rem; border-radius: 0 12px 12px 0; text-align: left;">
                <p id="mission-text" style="font-size: 1.15rem; color: var(--text-primary); font-weight: 500; line-height: 1.6; margin: 0;">The power of mind is our frontier. We're making sure it's protected from day one with a universal, open standard that leaves no brain behind. Because important connections <span class="text-reveal">deserve the most thought.</span></p>
            </div>
        </div>
    </section>

    <!-- Vision / Roadmap Section -->
    <section class="section" id="vision" style="background: var(--bg-secondary); margin: 0; max-width: 100%; padding: 5rem 2rem;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <div class="section-header">
                <h2>Vision & Roadmap</h2>
                <p>Where we're going</p>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: start;">
                <!-- Vision -->
                <div>
                    <h3 style="color: var(--accent-blue); margin-bottom: 1rem; font-size: 1.1rem;">THE VISION</h3>
                    <p id="vision-text" style="color: var(--text-secondary); line-height: 1.7; margin-bottom: 1.5rem;">
                        A world where brain-computer interfaces are as secure as they are powerful.
                        Where neural data is protected by law and by design. Where the boundary
                        between mind and machine is guarded by open standards, with security and privacy built in from inception.
                    </p>
                    <p id="vision-goal" style="color: var(--text-primary); font-weight: 500;">
                        ONI aims to become the IEEE 802 of neural interfaces — the foundation
                        that all BCI security builds upon.
                    </p>
                </div>

                <!-- Roadmap -->
                <div>
                    <h3 style="color: var(--accent-purple); margin-bottom: 1rem; font-size: 1.1rem;">ROADMAP</h3>
                    <div style="border-left: 2px solid var(--border); padding-left: 1.5rem;">
                        <div style="margin-bottom: 1.25rem; position: relative;">
                            <div style="position: absolute; left: -1.85rem; top: 0.25rem; width: 10px; height: 10px; background: var(--accent-emerald); border-radius: 50%;"></div>
                            <div style="color: var(--accent-emerald); font-size: 0.8rem; font-weight: 600;">COMPLETE</div>
                            <div style="color: var(--text-primary);">14-layer model, Coherence Metric, TARA MVP, Autodidact Module</div>
                        </div>
                        <div style="margin-bottom: 1.25rem; position: relative;">
                            <div style="position: absolute; left: -1.85rem; top: 0.25rem; width: 10px; height: 10px; background: var(--accent-amber); border-radius: 50%;"></div>
                            <div style="color: var(--accent-amber); font-size: 0.8rem; font-weight: 600;">IN PROGRESS</div>
                            <div style="color: var(--text-primary);">OpenBCI hardware validation, bidirectional security</div>
                        </div>
                        <div style="margin-bottom: 1.25rem; position: relative;">
                            <div style="position: absolute; left: -1.85rem; top: 0.25rem; width: 10px; height: 10px; background: var(--border); border-radius: 50%;"></div>
                            <div style="color: var(--text-muted); font-size: 0.8rem; font-weight: 600;">PLANNED</div>
                            <div style="color: var(--text-secondary);">IEEE standards proposal, regulatory alignment</div>
                        </div>
                        <div style="position: relative;">
                            <div style="position: absolute; left: -1.85rem; top: 0.25rem; width: 10px; height: 10px; background: var(--border); border-radius: 50%;"></div>
                            <div style="color: var(--text-muted); font-size: 0.8rem; font-weight: 600;">FUTURE</div>
                            <div style="color: var(--text-secondary);">Clinical trial integration, international adoption</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section" id="resources">
        <div class="section-header">
            <h2>Documentation & Resources</h2>
            <p>Everything you need to understand and contribute to ONI</p>
        </div>

        <div class="resources-grid">
            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/legacy-core/INDEX.md" class="resource-card">
                <div class="icon" style="background: var(--accent-blue);">
                    <span>W</span>
                </div>
                <div>
                    <h4>Main Wiki (INDEX.md)</h4>
                    <p>Central hub for navigation, dependencies, cross-references, and roadmap.</p>
                </div>
            </a>

            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/legacy-core/oni-framework/ONI_LAYERS.md" class="resource-card">
                <div class="icon" style="background: var(--accent-purple);">
                    <span>14</span>
                </div>
                <div>
                    <h4>ONI Layers Reference</h4>
                    <p>Complete 14-layer model specification with attack surfaces and defenses.</p>
                </div>
            </a>

            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/qif/governance/NEUROETHICS_ALIGNMENT.md" class="resource-card">
                <div class="icon" style="background: var(--accent-emerald);">
                    <span>E</span>
                </div>
                <div>
                    <h4>Neuroethics Alignment</h4>
                    <p>How ONI maps to neuroethics principles. Privacy-first, not surveillance.</p>
                </div>
            </a>

            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/legacy-core/ACADEMIC_LANDSCAPE.md" class="resource-card">
                <div class="icon" style="background: var(--accent-cyan);">
                    <span>A</span>
                </div>
                <div>
                    <h4>Academic Landscape</h4>
                    <p>Key researchers, leading institutions, and the academic landscape.</p>
                </div>
            </a>

            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/legacy-core/RELATED_WORK.md" class="resource-card">
                <div class="icon" style="background: var(--accent-amber);">
                    <span>R</span>
                </div>
                <div>
                    <h4>Related Work</h4>
                    <p>Prior BCI security research. Kohno, Bonaci, and foundational contributions.</p>
                </div>
            </a>

            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/qif/governance/TRANSPARENCY.md" class="resource-card">
                <div class="icon" style="background: var(--accent-pink);">
                    <span>T</span>
                </div>
                <div>
                    <h4>Transparency Statement</h4>
                    <p>Human-AI collaboration audit trail. How this framework was built.</p>
                </div>
            </a>

            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/legacy-core/publications/mathematical-foundations/TechDoc-Equations_Reference.md" class="resource-card">
                <div class="icon" style="background: var(--accent-blue);">
                    <span>Eq</span>
                </div>
                <div>
                    <h4>Equations Reference</h4>
                    <p>Master catalog of all equations — Maxwell, Boltzmann, Nernst, Hodgkin-Huxley, Fourier to Cₛ(S).</p>
                </div>
            </a>

            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/legacy-core/resources/EXTERNAL_TOOLS.md" class="resource-card">
                <div class="icon" style="background: var(--accent-emerald);">
                    <span>Lib</span>
                </div>
                <div>
                    <h4>External Tools & Libraries</h4>
                    <p>BrainFlow, MNE-Python, MOABB, SciPy, and every tool ONI builds on.</p>
                </div>
            </a>

            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/legacy-core/publications/mathematical-foundations/TechDoc-Mathematical_Audit.md" class="resource-card">
                <div class="icon" style="background: var(--accent-amber);">
                    <span>Au</span>
                </div>
                <div>
                    <h4>Mathematical Audit</h4>
                    <p>Self-audit of every mathematical claim — what's valid, what's corrected, what's open.</p>
                </div>
            </a>
        </div>
    </section>

    <!-- Who It's For Section -->
    <section class="section" id="audience">
        <div class="section-header" data-aos="fade-up">
            <h2>Who ONI Is For</h2>
            <p>A shared vocabulary for everyone building, securing, and governing BCIs</p>
        </div>

        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.5rem;">
            <div style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; text-align: center;">
                <div style="font-size: 2rem; margin-bottom: 0.75rem;">🔬</div>
                <h4 style="margin-bottom: 0.5rem;">Researchers</h4>
                <p style="color: var(--text-muted); font-size: 0.85rem;">Academic teams studying BCI security, neuroethics, and neural engineering.</p>
            </div>
            <div style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; text-align: center;">
                <div style="font-size: 2rem; margin-bottom: 0.75rem;">💻</div>
                <h4 style="margin-bottom: 0.5rem;">Developers</h4>
                <p style="color: var(--text-muted); font-size: 0.85rem;">Engineers building neural interfaces who need security primitives.</p>
            </div>
            <div style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; text-align: center;">
                <div style="font-size: 2rem; margin-bottom: 0.75rem;">⚖️</div>
                <h4 style="margin-bottom: 0.5rem;">Regulators</h4>
                <p style="color: var(--text-muted); font-size: 0.85rem;">FDA, FCC, and policy makers defining neural device requirements.</p>
            </div>
            <div style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; text-align: center;">
                <div style="font-size: 2rem; margin-bottom: 0.75rem;">🛡️</div>
                <h4 style="margin-bottom: 0.5rem;">Security Teams</h4>
                <p style="color: var(--text-muted); font-size: 0.85rem;">Red teams, pentesters, and security researchers in medical devices.</p>
            </div>
        </div>
    </section>

    <!-- Get Involved Section -->
    <section class="section" id="contribute">
        <div class="section-header">
            <h2>Get Involved</h2>
            <p>ONI is open-source and community-driven</p>
        </div>

        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem;">
            <a href="https://github.com/qinnovates/mindloft" style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 2rem; text-decoration: none; color: inherit; transition: all 0.2s; text-align: center;" onmouseover="this.style.borderColor='var(--accent-blue)'" onmouseout="this.style.borderColor='var(--border)'">
                <div style="font-size: 2rem; margin-bottom: 1rem;">⭐</div>
                <h4 style="margin-bottom: 0.5rem;">Star on GitHub</h4>
                <p style="color: var(--text-muted); font-size: 0.9rem;">Help us reach more researchers and developers.</p>
            </a>
            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/legacy-core/CONTRIBUTING.md" style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 2rem; text-decoration: none; color: inherit; transition: all 0.2s; text-align: center;" onmouseover="this.style.borderColor='var(--accent-purple)'" onmouseout="this.style.borderColor='var(--border)'">
                <div style="font-size: 2rem; margin-bottom: 1rem;">🔧</div>
                <h4 style="margin-bottom: 0.5rem;">Contribute Code</h4>
                <p style="color: var(--text-muted); font-size: 0.9rem;">Add attack patterns, improve the firewall, extend TARA.</p>
            </a>
            <a href="https://github.com/qinnovates/mindloft/issues" style="background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 2rem; text-decoration: none; color: inherit; transition: all 0.2s; text-align: center;" onmouseover="this.style.borderColor='var(--accent-cyan)'" onmouseout="this.style.borderColor='var(--border)'">
                <div style="font-size: 2rem; margin-bottom: 1rem;">💬</div>
                <h4 style="margin-bottom: 0.5rem;">Join Discussion</h4>
                <p style="color: var(--text-muted); font-size: 0.9rem;">Share ideas, report issues, propose new features.</p>
            </a>
        </div>
    </section>

    <footer>
        <div class="footer-links">
            <a href="https://github.com/qinnovates/mindloft">GitHub</a>
            <a href="https://github.com/qinnovates/mindloft/blob/main/neurosecurity/legacy-core/INDEX.md">Documentation</a>
            <a href="https://pypi.org/project/oni-framework/">PyPI</a>
            <a href="https://github.com/qinnovates/mindloft/blob/main/LICENSE">Apache 2.0</a>
        </div>
        <p style="margin-top: 1rem;">
            <strong>ONI Framework</strong> &mdash; Open-source neural interface security
        </p>
        <p style="margin-top: 1rem; font-size: 0.5rem; color: var(--text-muted); max-width: 800px; line-height: 1.4; text-align: center; margin-left: auto; margin-right: auto; opacity: 0.5;">
            © 2024-2026 Kevin L. Qi / Qinnovate. All rights reserved. ONI Framework™, Open Neurosecurity Interoperability™, and TARA Stack™ are trademarks of Kevin L. Qi / Qinnovate. Source code is licensed under Apache 2.0. You may use these trademarks to accurately describe or refer to this project. Use of logos or trademarks implying endorsement, or incorporation into other product names, requires written permission.
        </p>
    </footer>

    <!-- Video Modal -->
    <div id="videoModal" class="video-modal" onclick="closeVideoModal(event)">
        <div class="video-modal-content" onclick="event.stopPropagation()">
            <button class="video-close" onclick="closeVideoModal()">&times;</button>
            <video id="demoVideo" controls poster="images/ONI_Banner_Logo.png">
                <source src="video/ONI-Demo-720p.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
    </div>

    <script>
        function openVideoModal() {
            const modal = document.getElementById('videoModal');
            const video = document.getElementById('demoVideo');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            video.play();
        }

        function closeVideoModal(event) {
            if (event && event.target !== event.currentTarget) return;
            const modal = document.getElementById('videoModal');
            const video = document.getElementById('demoVideo');
            modal.classList.remove('active');
            document.body.style.overflow = '';
            video.pause();
            video.currentTime = 0;
        }

        // Close on escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeVideoModal();
            }
        });
    </script>

    <!-- AOS (Animate on Scroll) - CDN -->
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js" integrity="sha384-n1AULnKdMJlK1oQCLNDL9qZsDgXtH6jRYFCpBtWFc+a9Yve0KSoMn575rk755NJZ" crossorigin="anonymous"></script>

    <script>
        // Initialize AOS
        AOS.init({
            duration: 800,
            easing: 'ease-out-cubic',
            once: true,
            offset: 50
        });

        // Flowing Wave Lines Animation
        function initHyperspeed() {
            const canvas = document.getElementById('hyperspeed-canvas');
            const ctx = canvas.getContext('2d');

            let width, height;
            let time = 0;

            // Config
            const lineCount = 12;
            const color = '59, 130, 246'; // accent-blue RGB
            const speed = 0.008;

            function resize() {
                width = canvas.width = window.innerWidth;
                height = canvas.height = window.innerHeight;
            }

            function drawWave(yOffset, amplitude, frequency, phase, opacity) {
                ctx.beginPath();
                ctx.moveTo(0, height / 2 + yOffset);

                for (let x = 0; x <= width; x += 3) {
                    const y = height / 2 + yOffset +
                        Math.sin(x * frequency + phase) * amplitude +
                        Math.sin(x * frequency * 0.5 + phase * 1.3) * (amplitude * 0.5);
                    ctx.lineTo(x, y);
                }

                ctx.strokeStyle = `rgba(${color}, ${opacity})`;
                ctx.lineWidth = 1.5;
                ctx.stroke();
            }

            function animate() {
                // Clear with dark background
                ctx.fillStyle = '#0a0f1a';
                ctx.fillRect(0, 0, width, height);

                // Draw multiple wave lines
                for (let i = 0; i < lineCount; i++) {
                    const yOffset = (i - lineCount / 2) * 60;
                    const amplitude = 20 + Math.sin(time + i * 0.5) * 10;
                    const frequency = 0.003 + i * 0.0002;
                    const phase = time * (1 + i * 0.1);
                    const opacity = 0.15 + (1 - Math.abs(i - lineCount / 2) / (lineCount / 2)) * 0.2;

                    drawWave(yOffset, amplitude, frequency, phase, opacity);
                }

                time += speed;
                requestAnimationFrame(animate);
            }

            window.addEventListener('resize', resize);

            resize();
            animate();
        }

        // Create neural network background dots
        function createNeuralBackground() {
            const container = document.getElementById('neuralBg');
            if (!container) return;

            const dotCount = 20;
            for (let i = 0; i < dotCount; i++) {
                const dot = document.createElement('div');
                dot.className = 'neural-dot';
                dot.style.left = Math.random() * 100 + '%';
                dot.style.top = Math.random() * 100 + '%';
                dot.style.animationDelay = Math.random() * 4 + 's';
                dot.style.animationDuration = (3 + Math.random() * 2) + 's';
                container.appendChild(dot);
            }
        }

        // Counter animation for stats
        function animateCounters() {
            const counters = document.querySelectorAll('[data-count]');
            counters.forEach(counter => {
                const target = parseInt(counter.getAttribute('data-count'));
                const suffix = counter.getAttribute('data-suffix') || '';
                const duration = 2000;
                const step = target / (duration / 16);
                let current = 0;

                const updateCounter = () => {
                    current += step;
                    if (current < target) {
                        counter.textContent = Math.floor(current) + suffix;
                        requestAnimationFrame(updateCounter);
                    } else {
                        counter.textContent = target + suffix;
                    }
                };

                // Start counting when element is in view
                const observer = new IntersectionObserver((entries) => {
                    if (entries[0].isIntersecting) {
                        updateCounter();
                        observer.disconnect();
                    }
                });
                observer.observe(counter);
            });
        }

        // ONI Layers scroll reveal animation
        function initLayersReveal() {
            const container = document.getElementById('layers-reveal-container');
            const layerBars = document.querySelectorAll('.oni-layer-bar');
            const zoneLabels = document.querySelectorAll('.oni-zone-label');

            if (!container || layerBars.length === 0) return;

            // Total elements to animate (2 zone labels + 14 layer bars = 16)
            const totalElements = 16;
            // L8 is at index 8 (0: silicon label, 1-7: L1-L7, 8: L8)
            // For L8 to be visible, visibleCount must be >= 9, so progress >= 9/16
            const L8_VISIBLE_PROGRESS = 9 / totalElements;     // ~0.5625 - when L8 first appears
            // Scroll snap zone: when raw progress would show L8, we "pause" here
            const L8_SNAP_START = L8_VISIBLE_PROGRESS;
            const L8_SNAP_END = (9 + 2) / totalElements;       // ~0.6875 - extra scroll needed to continue
            let lastActiveIndex = -1;

            function updateReveal() {
                const rect = container.getBoundingClientRect();
                const windowHeight = window.innerHeight;

                // Calculate how much of the container is visible
                // Start revealing when container enters viewport, complete when it's mostly visible
                const startPoint = windowHeight;
                const endPoint = windowHeight * 0.2;

                // Raw progress from 0 (just entering) to 1 (fully revealed)
                let rawProgress = (startPoint - rect.top) / (startPoint - endPoint);
                rawProgress = Math.max(0, Math.min(1, rawProgress));

                // Apply scroll snap transformation at L8
                // This creates a "sticky" zone where L8 stays expanded while user scrolls more
                let progress;
                const gatewayBar = layerBars[7]; // L8

                if (rawProgress < L8_SNAP_START) {
                    // Before L8: normal linear progress
                    progress = rawProgress;
                    if (gatewayBar) {
                        gatewayBar.classList.remove('expanded');
                    }
                } else if (rawProgress >= L8_SNAP_START && rawProgress < L8_SNAP_END) {
                    // In the snap zone: hold at showing L8, keep it expanded
                    progress = L8_VISIBLE_PROGRESS; // Exactly enough to show L8
                    if (gatewayBar) {
                        gatewayBar.classList.add('expanded');
                    }
                } else {
                    // After snap zone: resume from Biology label onwards
                    // Map remaining scroll (L8_SNAP_END to 1) to remaining elements (index 9+ to 16)
                    const remainingRaw = rawProgress - L8_SNAP_END;
                    const remainingRange = 1 - L8_SNAP_END;
                    const biologyStartProgress = 10 / totalElements; // Biology label is index 9
                    progress = biologyStartProgress + (remainingRaw / remainingRange) * (1 - biologyStartProgress);
                    if (gatewayBar) {
                        gatewayBar.classList.remove('expanded');
                    }
                }

                progress = Math.max(0, Math.min(1, progress));

                // Calculate which elements should be visible based on scroll progress
                const visibleCount = Math.floor(progress * totalElements);

                // Animate zone labels and layer bars sequentially
                // Order: Silicon label, L1-L7, L8, Biology label, L9-L14
                const animationOrder = [];

                // Silicon zone label (sideways on left)
                animationOrder.push({ type: 'zone', element: zoneLabels[0], layer: 0 });
                // L1-L7
                for (let i = 0; i < 7; i++) {
                    animationOrder.push({ type: 'bar', element: layerBars[i], layer: i + 1 });
                }
                // L8 (gateway)
                animationOrder.push({ type: 'bar', element: layerBars[7], layer: 8 });
                // Biology zone label (sideways on left)
                animationOrder.push({ type: 'zone', element: zoneLabels[1], layer: 9 });
                // L9-L14
                for (let i = 8; i < 14; i++) {
                    animationOrder.push({ type: 'bar', element: layerBars[i], layer: i + 1 });
                }

                // Apply visibility and active states
                animationOrder.forEach((item, index) => {
                    if (!item.element) return;

                    if (index < visibleCount) {
                        item.element.classList.add('visible');

                        // Add active class only to the most recently revealed layer bar
                        if (item.type === 'bar') {
                            if (index === visibleCount - 1 ||
                                (index < visibleCount - 1 && animationOrder[index + 1].type === 'zone')) {
                                item.element.classList.add('active');
                            } else {
                                item.element.classList.remove('active');
                            }
                        }
                    } else {
                        item.element.classList.remove('visible');
                        if (item.type === 'bar') {
                            item.element.classList.remove('active');
                        }
                    }
                });

                // Keep all visible once fully scrolled
                if (progress >= 1) {
                    animationOrder.forEach(item => {
                        if (item.element) {
                            item.element.classList.add('visible');
                            item.element.classList.remove('active');
                        }
                    });
                    // Keep L8 gateway with subtle glow when complete
                    if (layerBars[7]) {
                        layerBars[7].classList.add('active');
                    }
                }
            }

            // Listen to scroll
            window.addEventListener('scroll', updateReveal, { passive: true });

            // Initial call
            updateReveal();

            // Fallback: Use IntersectionObserver to ensure animation starts when visible
            const observer = new IntersectionObserver((entries) => {
                if (entries[0].isIntersecting) {
                    updateReveal();
                    // Small delay to ensure smooth animation start
                    setTimeout(updateReveal, 100);
                }
            }, { threshold: 0.1 });
            observer.observe(container);

            // Additional fallback: retry after layout settles
            setTimeout(updateReveal, 500);

            // Make layer bars clickable - navigate to Layer Explorer
            layerBars.forEach(bar => {
                bar.addEventListener('click', (e) => {
                    const layerNum = bar.dataset.layer;
                    if (layerNum) {
                        window.location.href = `visualizations/02-oni-layer-explorer.html?layer=${layerNum}`;
                    }
                });
            });
        }

        // Security: Sanitize and validate brand.json input
        function sanitizeText(input, maxLength = 500) {
            if (typeof input !== 'string') return null;
            // Limit length to prevent DoS
            if (input.length > maxLength) return null;
            // Remove any HTML-like content as extra protection (even though textContent is safe)
            if (/<[^>]*>/.test(input)) return null;
            // Remove control characters
            return input.replace(/[\x00-\x1F\x7F]/g, '');
        }

        function sanitizeNumber(input, min = 0, max = 10000) {
            const num = parseInt(input, 10);
            if (isNaN(num) || num < min || num > max) return null;
            return num;
        }

        // Load brand constants from brand.json
        async function loadBrandConstants() {
            try {
                // Try to load brand.json from repo (works on GitHub Pages)
                const response = await fetch('https://raw.githubusercontent.com/qinnovates/mindloft/main/neurosecurity/legacy-core/resources/brand/brand.json');
                if (!response.ok) throw new Error('Failed to fetch brand.json');

                const brand = await response.json();

                // Validate structure
                if (!brand || typeof brand !== 'object' || !brand.oni) {
                    throw new Error('Invalid brand.json structure');
                }

                // Update mission text (with validation)
                const missionEl = document.getElementById('mission-text');
                const safeMission = sanitizeText(brand.oni.mission, 500);
                if (missionEl && safeMission) {
                    missionEl.textContent = safeMission;
                }

                // Update slogan text (with validation)
                const sloganEl = document.getElementById('slogan-text');
                const safeSlogan = sanitizeText(brand.oni.slogan, 200);
                if (sloganEl && safeSlogan) {
                    sloganEl.textContent = '"' + safeSlogan + '"';
                }

                // Update vision text (with validation)
                const visionEl = document.getElementById('vision-text');
                const safeVision = sanitizeText(brand.oni.vision, 600);
                if (visionEl && safeVision) {
                    visionEl.textContent = safeVision;
                }

                // Update MANUAL stats from brand.json (with validation)
                // These require human updates: security_layers (always 14), threat_signatures, learning_portals
                if (brand.stats && typeof brand.stats === 'object') {
                    const manualStats = {
                        'stat-layers': { value: sanitizeNumber(brand.stats.security_layers, 1, 100), suffix: '' },
                        'stat-threats': { value: sanitizeNumber(brand.stats.threat_signatures, 1, 1000), suffix: '+' },
                        'stat-portals': { value: sanitizeNumber(brand.stats.learning_portals, 1, 100), suffix: '' }
                    };
                    for (const [id, config] of Object.entries(manualStats)) {
                        const el = document.getElementById(id);
                        if (el && config.value !== null) {
                            el.textContent = config.value + config.suffix;
                            el.setAttribute('data-count', config.value);
                        }
                    }
                }

                console.log('Brand loaded:', sanitizeText(brand.oni.name, 50), 'v' + sanitizeText(brand.oni.version, 20));
            } catch (err) {
                console.log('Using default brand values (brand.json not available)');
            }

            // ===========================================
            // AUTO-UPDATING STATS (fetched from GitHub API)
            // - Commits: Total commit count on main branch
            // - Interactive Tools: Count of .html files in docs/visualizations/
            // - Python Packages: Count of pyproject.toml files in MAIN/
            // ===========================================

            // Fetch interactive tools count (HTML files in visualizations/)
            try {
                const vizResponse = await fetch('https://api.github.com/repos/qinnovates/mindloft/contents/docs/visualizations');
                if (vizResponse.ok) {
                    const files = await vizResponse.json();
                    const htmlFiles = files.filter(f => f.name.endsWith('.html') && f.name !== 'index.html');
                    const toolsEl = document.getElementById('stat-tools');
                    if (toolsEl && htmlFiles.length > 0) {
                        toolsEl.textContent = htmlFiles.length;
                        toolsEl.setAttribute('data-count', htmlFiles.length);
                    }
                }
            } catch (err) {
                console.log('Using default tools count');
            }

        }

        // Text reveal animation on scroll
        function initTextReveal() {
            const textRevealElements = document.querySelectorAll('.text-reveal');
            textRevealElements.forEach(el => {
                const observer = new IntersectionObserver((entries) => {
                    if (entries[0].isIntersecting) {
                        el.classList.add('animate');
                        observer.disconnect();
                    }
                }, { threshold: 0.5 });
                observer.observe(el);
            });
        }

        // === ONI 3D Neural Security Visualization (Realistic) ===
        function initONI3D() {
            var container = document.getElementById('oni-3d-container');
            if (!container || typeof THREE === 'undefined') return;

            var isMobile = window.innerWidth <= 900;

            // --- Fresnel Shader (realistic rim glow) ---
            var fresnelVert = [
                'varying vec3 vNormal;',
                'varying vec3 vViewPos;',
                'void main() {',
                '  vNormal = normalize(normalMatrix * normal);',
                '  vec4 mv = modelViewMatrix * vec4(position, 1.0);',
                '  vViewPos = -mv.xyz;',
                '  gl_Position = projectionMatrix * mv;',
                '}'
            ].join('\n');

            var fresnelFrag = [
                'uniform vec3 uColor;',
                'uniform float uOpacity;',
                'uniform float uFresnelPower;',
                'uniform float uGlowIntensity;',
                'uniform float uTime;',
                'varying vec3 vNormal;',
                'varying vec3 vViewPos;',
                'void main() {',
                '  vec3 vd = normalize(vViewPos);',
                '  float fresnel = pow(1.0 - abs(dot(vd, vNormal)), uFresnelPower);',
                '  float shimmer = 1.0 + 0.08 * sin(uTime * 2.0 + vNormal.x * 12.0);',
                '  float alpha = fresnel * uOpacity * shimmer;',
                '  vec3 col = uColor * (1.0 + fresnel * uGlowIntensity);',
                '  gl_FragColor = vec4(col, alpha);',
                '}'
            ].join('\n');

            // --- Gateway shader (pulsing energy field) ---
            var gatewayFrag = [
                'uniform vec3 uColor;',
                'uniform float uOpacity;',
                'uniform float uTime;',
                'varying vec3 vNormal;',
                'varying vec3 vViewPos;',
                'void main() {',
                '  vec3 vd = normalize(vViewPos);',
                '  float fresnel = pow(1.0 - abs(dot(vd, vNormal)), 2.5);',
                '  float pulse = 0.6 + 0.4 * sin(uTime * 3.0);',
                '  float energy = fresnel * pulse;',
                '  float scan = 0.5 + 0.5 * sin(vNormal.y * 20.0 + uTime * 4.0);',
                '  energy += scan * 0.15 * fresnel;',
                '  vec3 col = uColor * (1.0 + energy * 2.0);',
                '  gl_FragColor = vec4(col, energy * uOpacity);',
                '}'
            ].join('\n');

            // --- Renderer ---
            var renderer = new THREE.WebGLRenderer({
                alpha: true,
                antialias: !isMobile,
                powerPreference: 'high-performance'
            });
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setClearColor(0x000000, 0);
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.2;
            container.insertBefore(renderer.domElement, container.firstChild);

            // --- Scene & Camera ---
            var scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x0a0f1a, 0.05);

            var camera = new THREE.PerspectiveCamera(40, container.clientWidth / container.clientHeight, 0.1, 100);
            camera.position.set(0, 0.3, 7);

            // --- Groups ---
            var autoRotateGroup = new THREE.Group();
            var parallaxGroup = new THREE.Group();
            scene.add(autoRotateGroup);
            autoRotateGroup.add(parallaxGroup);

            // --- Lighting (cinematic multi-source) ---
            scene.add(new THREE.AmbientLight(0x1a2744, 0.3));

            var keyLight = new THREE.PointLight(0x3b82f6, 2.0, 25);
            keyLight.position.set(4, 3, 5);
            scene.add(keyLight);

            var fillLight = new THREE.PointLight(0x8b5cf6, 1.2, 20);
            fillLight.position.set(-3, -2, 3);
            scene.add(fillLight);

            var rimLight = new THREE.PointLight(0x06b6d4, 1.5, 20);
            rimLight.position.set(0, 1, -5);
            scene.add(rimLight);

            var gatewayLight = new THREE.PointLight(0xf59e0b, 1.0, 12);
            gatewayLight.position.set(0, 0, 3);
            scene.add(gatewayLight);

            // --- Layer Config ---
            var allLayers = [
                { id:'L1',  r:2.90, c:[0.145,0.388,0.922], zone:'silicon', fp:3.5 },
                { id:'L2',  r:2.72, c:[0.173,0.424,0.941], zone:'silicon', fp:3.2 },
                { id:'L3',  r:2.55, c:[0.200,0.463,0.953], zone:'silicon', fp:3.0 },
                { id:'L4',  r:2.38, c:[0.231,0.510,0.965], zone:'silicon', fp:2.8 },
                { id:'L5',  r:2.22, c:[0.271,0.561,0.969], zone:'silicon', fp:2.6 },
                { id:'L6',  r:2.06, c:[0.310,0.612,0.976], zone:'silicon', fp:2.5 },
                { id:'L7',  r:1.90, c:[0.376,0.647,0.980], zone:'silicon', fp:2.4 },
                { id:'L8',  r:1.72, c:[0.961,0.620,0.043], zone:'gateway', fp:2.0 },
                { id:'L9',  r:1.52, c:[0.063,0.725,0.506], zone:'biology', fp:2.8 },
                { id:'L10', r:1.38, c:[0.204,0.827,0.600], zone:'biology', fp:2.6 },
                { id:'L11', r:1.24, c:[0.431,0.906,0.718], zone:'biology', fp:2.4 },
                { id:'L12', r:1.10, c:[0.655,0.545,0.984], zone:'biology', fp:2.3 },
                { id:'L13', r:0.96, c:[0.753,0.518,0.988], zone:'biology', fp:2.2 },
                { id:'L14', r:0.82, c:[0.925,0.282,0.600], zone:'biology', fp:2.0 },
            ];

            var mobileIdx = [0,2,4,6,7,9,11,13];
            var activeLayers = isMobile ? mobileIdx.map(function(i){return allLayers[i];}) : allLayers;

            // --- Shells with Fresnel Shaders ---
            var shellGeo = new THREE.SphereGeometry(1, 64, 48);
            var shellMeshes = [], shellUniforms = [];

            activeLayers.forEach(function(layer) {
                var isGW = layer.zone === 'gateway';
                var u = {
                    uColor: { value: new THREE.Vector3(layer.c[0], layer.c[1], layer.c[2]) },
                    uOpacity: { value: isGW ? 0.7 : 0.45 },
                    uFresnelPower: { value: layer.fp },
                    uGlowIntensity: { value: isGW ? 2.5 : 1.2 },
                    uTime: { value: 0 }
                };
                var mat = new THREE.ShaderMaterial({
                    uniforms: u,
                    vertexShader: fresnelVert,
                    fragmentShader: isGW ? gatewayFrag : fresnelFrag,
                    transparent: true,
                    side: THREE.FrontSide,
                    depthWrite: false,
                    blending: THREE.AdditiveBlending,
                });
                var mesh = new THREE.Mesh(shellGeo, mat);
                mesh.scale.setScalar(layer.r);
                mesh.userData = layer;
                parallaxGroup.add(mesh);
                shellMeshes.push(mesh);
                shellUniforms.push(u);
            });

            // --- Wireframe overlay on select shells ---
            var wireIndices = isMobile ? [0,3,5,7] : [0,3,6,7,10,13];
            var wireGeo = new THREE.IcosahedronGeometry(1, 2);
            wireIndices.forEach(function(idx) {
                if (idx >= activeLayers.length) return;
                var L = activeLayers[idx];
                var wm = new THREE.MeshBasicMaterial({
                    color: new THREE.Color(L.c[0], L.c[1], L.c[2]),
                    wireframe: true, transparent: true,
                    opacity: L.zone === 'gateway' ? 0.12 : 0.05,
                    depthWrite: false,
                });
                var wMesh = new THREE.Mesh(wireGeo, wm);
                wMesh.scale.setScalar(L.r * 1.002);
                parallaxGroup.add(wMesh);
            });

            // --- Brain Core (organic displaced sphere) ---
            var coreGeo = new THREE.SphereGeometry(0.55, 48, 36);
            var cp = coreGeo.attributes.position;
            for (var i = 0; i < cp.count; i++) {
                var x = cp.getX(i), y = cp.getY(i), z = cp.getZ(i);
                var n1 = Math.sin(x*6)*Math.cos(y*7)*Math.sin(z*5)*0.04;
                var n2 = Math.sin(x*12+1)*Math.cos(y*11+2)*0.02;
                var n3 = Math.cos(z*15+x*8)*0.012;
                var len = Math.sqrt(x*x+y*y+z*z);
                var s = (0.55+n1+n2+n3)/len;
                cp.setXYZ(i, x*s, y*s*0.85, z*s);
            }
            coreGeo.computeVertexNormals();

            var coreVert = [
                'varying vec3 vNormal; varying vec3 vViewPos; varying vec3 vWP;',
                'void main() {',
                '  vNormal = normalize(normalMatrix * normal);',
                '  vec4 mv = modelViewMatrix * vec4(position,1.0);',
                '  vViewPos = -mv.xyz; vWP = position;',
                '  gl_Position = projectionMatrix * mv;',
                '}'
            ].join('\n');

            var coreFrag = [
                'uniform float uTime;',
                'varying vec3 vNormal; varying vec3 vViewPos; varying vec3 vWP;',
                'void main() {',
                '  vec3 vd = normalize(vViewPos);',
                '  float fresnel = pow(1.0-abs(dot(vd,vNormal)),2.0);',
                '  float sss = pow(max(0.0,dot(vd,-vNormal)),1.5)*0.4;',
                '  float wave = sin(vWP.x*8.0+uTime*2.5)*sin(vWP.z*8.0+uTime*1.8);',
                '  wave = wave*0.5+0.5;',
                '  vec3 base = vec3(0.85,0.2,0.45);',
                '  vec3 glow = vec3(0.5,0.15,0.65);',
                '  vec3 col = mix(base,glow,fresnel);',
                '  col += vec3(0.3,0.1,0.4)*sss;',
                '  col += vec3(0.2,0.05,0.3)*wave*0.3;',
                '  gl_FragColor = vec4(col, 0.7+fresnel*0.3);',
                '}'
            ].join('\n');

            var coreU = { uTime:{value:0} };
            var coreMat = new THREE.ShaderMaterial({
                uniforms: coreU,
                vertexShader: coreVert,
                fragmentShader: coreFrag,
                transparent: true, depthWrite: true,
            });
            var coreMesh = new THREE.Mesh(coreGeo, coreMat);
            parallaxGroup.add(coreMesh);

            // Inner glow
            var glowMat = new THREE.MeshBasicMaterial({
                color: 0xec4899, transparent: true, opacity: 0.15,
                depthWrite: false, blending: THREE.AdditiveBlending,
            });
            var glowMesh = new THREE.Mesh(new THREE.SphereGeometry(0.45,24,16), glowMat);
            parallaxGroup.add(glowMesh);

            // --- Neural Nodes (flickering surface particles) ---
            var nodeCount = isMobile ? 60 : 120;
            var nPos = new Float32Array(nodeCount*3);
            var nSizes = new Float32Array(nodeCount);
            for (var i=0; i<nodeCount; i++) {
                var theta = Math.random()*Math.PI*2;
                var phi = Math.acos(2*Math.random()-1);
                var r = 0.50+Math.random()*0.06;
                nPos[i*3]   = r*Math.sin(phi)*Math.cos(theta);
                nPos[i*3+1] = r*Math.sin(phi)*Math.sin(theta)*0.85;
                nPos[i*3+2] = r*Math.cos(phi);
                nSizes[i] = 0.02+Math.random()*0.03;
            }
            var nodeGeo = new THREE.BufferGeometry();
            nodeGeo.setAttribute('position', new THREE.BufferAttribute(nPos,3));
            nodeGeo.setAttribute('size', new THREE.BufferAttribute(nSizes,1));

            var nodeVert = [
                'attribute float size; uniform float uTime; varying float vAlpha;',
                'void main() {',
                '  vec4 mv = modelViewMatrix * vec4(position,1.0);',
                '  float flicker = 0.5+0.5*sin(uTime*3.0+position.x*20.0+position.z*15.0);',
                '  vAlpha = flicker;',
                '  gl_PointSize = size * 300.0 / -mv.z * flicker;',
                '  gl_Position = projectionMatrix * mv;',
                '}'
            ].join('\n');

            var nodeFrag = [
                'varying float vAlpha;',
                'void main() {',
                '  float d = length(gl_PointCoord-vec2(0.5));',
                '  if(d>0.5) discard;',
                '  float glow = exp(-d*6.0);',
                '  vec3 col = mix(vec3(1.0,0.6,0.8),vec3(0.8,0.9,1.0),d);',
                '  gl_FragColor = vec4(col, glow*vAlpha*0.9);',
                '}'
            ].join('\n');

            var nodeU = { uTime:{value:0} };
            var nodeMat = new THREE.ShaderMaterial({
                uniforms: nodeU, vertexShader: nodeVert, fragmentShader: nodeFrag,
                transparent: true, depthWrite: false, blending: THREE.AdditiveBlending,
            });
            var nodeCloud = new THREE.Points(nodeGeo, nodeMat);
            parallaxGroup.add(nodeCloud);

            // --- Synapse Lines ---
            var linePos = [];
            var lc = 0, maxD = 0.35;
            for (var i=0; i<nodeCount && lc<80; i++) {
                for (var j=i+1; j<nodeCount && lc<80; j++) {
                    var dx=nPos[i*3]-nPos[j*3], dy=nPos[i*3+1]-nPos[j*3+1], dz=nPos[i*3+2]-nPos[j*3+2];
                    if (Math.sqrt(dx*dx+dy*dy+dz*dz) < maxD) {
                        linePos.push(nPos[i*3],nPos[i*3+1],nPos[i*3+2]);
                        linePos.push(nPos[j*3],nPos[j*3+1],nPos[j*3+2]);
                        lc++;
                    }
                }
            }
            var synapseLines = null;
            if (linePos.length > 0) {
                var lineGeo = new THREE.BufferGeometry();
                lineGeo.setAttribute('position', new THREE.Float32BufferAttribute(linePos,3));
                synapseLines = new THREE.LineSegments(lineGeo, new THREE.LineBasicMaterial({
                    color: 0xec4899, transparent: true, opacity: 0.15,
                    depthWrite: false, blending: THREE.AdditiveBlending,
                }));
                parallaxGroup.add(synapseLines);
            }

            // --- Ambient Dust Particles ---
            var dustCount = isMobile ? 100 : 250;
            var dPos = new Float32Array(dustCount*3);
            for (var i=0; i<dustCount; i++) {
                dPos[i*3]   = (Math.random()-0.5)*10;
                dPos[i*3+1] = (Math.random()-0.5)*8;
                dPos[i*3+2] = (Math.random()-0.5)*6;
            }
            var dustGeo = new THREE.BufferGeometry();
            dustGeo.setAttribute('position', new THREE.BufferAttribute(dPos,3));
            var dustCloud = new THREE.Points(dustGeo, new THREE.PointsMaterial({
                color: 0x60a5fa, size: 0.015, transparent: true, opacity: 0.3,
                depthWrite: false, blending: THREE.AdditiveBlending, sizeAttenuation: true,
            }));
            scene.add(dustCloud);

            // --- Interaction ---
            var mouseX = 0, mouseY = 0;
            var clock = new THREE.Clock();
            var isVisible = true;

            if (!isMobile) {
                container.addEventListener('mousemove', function(e) {
                    var rect = container.getBoundingClientRect();
                    mouseX = ((e.clientX-rect.left)/rect.width-0.5)*2;
                    mouseY = ((e.clientY-rect.top)/rect.height-0.5)*2;
                });
                container.addEventListener('mouseleave', function() { mouseX=0; mouseY=0; });
            }

            var visObs = new IntersectionObserver(function(entries) {
                isVisible = entries[0].isIntersecting;
            }, { threshold: 0 });
            visObs.observe(container);

            function onResize() {
                var w = container.clientWidth, h = container.clientHeight;
                if (!w || !h) return;
                camera.aspect = w/h;
                camera.updateProjectionMatrix();
                renderer.setSize(w,h);
            }
            window.addEventListener('resize', onResize);

            // =============================================
            // WAVEFRONT SIGNAL SYSTEM
            // Simulates electromagnetic/ionic wavefronts
            // propagating through ONI layers — just as real
            // BCI signals traverse tissue and hardware.
            // =============================================

            var activeSignals = [];
            var signalLog = document.getElementById('oni3d-signal-log');

            // Layer names for log display
            var layerNames = {
                'L1':'Physical Carrier','L2':'Signal Processing','L3':'Protocol',
                'L4':'Transport','L5':'Session','L6':'Presentation','L7':'Application',
                'L8':'Neural Gateway',
                'L9':'Bio Signal Processing','L10':'Neural Protocol','L11':'Cognitive Transport',
                'L12':'Cognitive Session','L13':'Semantic Layer','L14':'Identity Layer'
            };

            // Signal types with different behaviors
            var SIGNAL_TYPES = {
                normal: {
                    color: [0.376, 0.647, 0.980],   // blue
                    speed: 0.8,
                    passGateway: true,
                    label: 'NORMAL'
                },
                threat: {
                    color: [0.973, 0.443, 0.443],    // red
                    speed: 1.2,
                    passGateway: false,
                    label: 'THREAT'
                },
                stimulation: {
                    color: [0.290, 0.855, 0.498],    // green
                    speed: 0.6,
                    passGateway: true,
                    label: 'STIM'
                }
            };

            // Ripple ring shader
            var rippleVert = [
                'varying vec2 vUv;',
                'void main() {',
                '  vUv = uv;',
                '  gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);',
                '}'
            ].join('\n');

            var rippleFrag = [
                'uniform float uProgress;',
                'uniform vec3 uColor;',
                'uniform float uDirection;', // 1.0 = inward, -1.0 = outward
                'varying vec2 vUv;',
                'void main() {',
                '  vec2 center = vec2(0.5);',
                '  float d = distance(vUv, center) * 2.0;',
                '  // Expanding ring',
                '  float ring = uDirection > 0.0 ? uProgress : 1.0 - uProgress;',
                '  float width = 0.12;',
                '  float intensity = exp(-pow((d - ring) / width, 2.0) * 4.0);',
                '  // Fade overall with progress',
                '  float fade = 1.0 - uProgress;',
                '  float alpha = intensity * fade * 1.5;',
                '  gl_FragColor = vec4(uColor * (1.0 + intensity), alpha);',
                '}'
            ].join('\n');

            // Create a wavefront signal
            function createSignal(injectionLayerIndex, type, direction) {
                var sigType = SIGNAL_TYPES[type] || SIGNAL_TYPES.normal;
                var startLayer = activeLayers[injectionLayerIndex];
                if (!startLayer) return;

                // direction: 'inward' (toward brain), 'outward' (toward L1), 'both'
                var dir = direction || 'inward';

                var signal = {
                    type: type,
                    sigType: sigType,
                    startLayerIdx: injectionLayerIndex,
                    startRadius: startLayer.r,
                    direction: dir,
                    progress: 0,        // 0 to 1
                    speed: sigType.speed,
                    alive: true,
                    blocked: false,
                    ripples: [],         // visual ring meshes
                    reachedCore: false,
                    gatewayChecked: false
                };

                // Create initial ripple ring at injection point
                addRipple(signal, startLayer.r);

                activeSignals.push(signal);

                // Log the injection
                logSignalEvent(sigType.label + ' signal injected at ' + startLayer.id + ' — ' + layerNames[startLayer.id], sigType.color);

                return signal;
            }

            function addRipple(signal, radius) {
                var ringGeo = new THREE.RingGeometry(radius * 0.92, radius * 1.08, 64);
                var u = {
                    uProgress: { value: 0 },
                    uColor: { value: new THREE.Vector3(signal.sigType.color[0], signal.sigType.color[1], signal.sigType.color[2]) },
                    uDirection: { value: signal.direction === 'inward' ? 1.0 : -1.0 }
                };
                var mat = new THREE.ShaderMaterial({
                    uniforms: u,
                    vertexShader: rippleVert,
                    fragmentShader: rippleFrag,
                    transparent: true,
                    side: THREE.DoubleSide,
                    depthWrite: false,
                    blending: THREE.AdditiveBlending,
                });
                var ring = new THREE.Mesh(ringGeo, mat);
                // Random orientation for variety
                ring.rotation.x = Math.random() * Math.PI;
                ring.rotation.y = Math.random() * Math.PI;
                parallaxGroup.add(ring);
                signal.ripples.push({ mesh: ring, uniforms: u, birthProgress: signal.progress });
            }

            // Propagating wavefront particles
            function createWavefrontParticles(signal, radius, count) {
                var pts = new Float32Array(count * 3);
                for (var i = 0; i < count; i++) {
                    var theta = Math.random() * Math.PI * 2;
                    var phi = Math.acos(2 * Math.random() - 1);
                    pts[i*3]   = radius * Math.sin(phi) * Math.cos(theta);
                    pts[i*3+1] = radius * Math.sin(phi) * Math.sin(theta) * 0.85;
                    pts[i*3+2] = radius * Math.cos(phi);
                }
                var geo = new THREE.BufferGeometry();
                geo.setAttribute('position', new THREE.BufferAttribute(pts, 3));
                var col = signal.sigType.color;
                var mat = new THREE.PointsMaterial({
                    color: new THREE.Color(col[0], col[1], col[2]),
                    size: 0.04, transparent: true, opacity: 0.8,
                    depthWrite: false, blending: THREE.AdditiveBlending,
                    sizeAttenuation: true,
                });
                var cloud = new THREE.Points(geo, mat);
                parallaxGroup.add(cloud);
                return { mesh: cloud, material: mat, startRadius: radius, basePositions: pts.slice() };
            }

            // Update signal propagation
            function updateSignals(dt, t) {
                for (var s = activeSignals.length - 1; s >= 0; s--) {
                    var sig = activeSignals[s];
                    if (!sig.alive) continue;

                    sig.progress += dt * sig.speed * 0.3;

                    // Calculate current wavefront radius
                    var targetRadius, currentRadius;
                    if (sig.direction === 'inward') {
                        targetRadius = 0.55; // brain core
                        currentRadius = sig.startRadius - (sig.startRadius - targetRadius) * sig.progress;
                    } else {
                        targetRadius = 3.2; // beyond outermost shell
                        currentRadius = sig.startRadius + (targetRadius - sig.startRadius) * sig.progress;
                    }

                    // Check gateway interaction (L8 at radius ~1.72)
                    var gatewayR = 1.72;
                    if (!sig.gatewayChecked) {
                        var crossingGateway = (sig.direction === 'inward' && currentRadius <= gatewayR + 0.1 && currentRadius >= gatewayR - 0.1) ||
                                              (sig.direction === 'outward' && currentRadius >= gatewayR - 0.1 && currentRadius <= gatewayR + 0.1);
                        if (crossingGateway) {
                            sig.gatewayChecked = true;
                            if (!sig.sigType.passGateway) {
                                // BLOCKED — threat detected
                                sig.blocked = true;
                                sig.speed = 0; // freeze
                                logSignalEvent('L8 GATEWAY: Threat blocked — anomaly in coherence score', [0.973, 0.443, 0.443]);
                                // Flash gateway shell
                                flashShell(7, [1.0, 0.3, 0.3], 0.6);
                                // Signal dies after flash
                                setTimeout(function() {
                                    var idx = activeSignals.indexOf(sig);
                                    if (idx >= 0) {
                                        sig.alive = false;
                                    }
                                }, 1500);
                            } else {
                                logSignalEvent('L8 GATEWAY: Signal verified — coherence Cₛ > 0.85', [0.290, 0.855, 0.498]);
                                flashShell(7, [0.290, 0.855, 0.498], 0.4);
                            }
                        }
                    }

                    // Check if reached core (inward) or escaped (outward)
                    if (sig.direction === 'inward' && currentRadius <= 0.6 && !sig.reachedCore && !sig.blocked) {
                        sig.reachedCore = true;
                        logSignalEvent('Signal reached neural core — ' + (sig.type === 'stimulation' ? 'stimulation applied' : 'data received'), sig.sigType.color);
                        // Flash brain core
                        flashCore(sig.sigType.color);
                    }

                    // Update ripple visuals
                    sig.ripples.forEach(function(rip) {
                        var localP = Math.min(1, (sig.progress - rip.birthProgress) * 2);
                        rip.uniforms.uProgress.value = localP;

                        // Scale ring to current wavefront radius
                        var scale = currentRadius / sig.startRadius;
                        rip.mesh.scale.setScalar(scale);
                    });

                    // Cleanup completed signals
                    if (sig.progress >= 1.0 || (sig.blocked && sig.speed === 0)) {
                        if (sig.progress >= 1.0) sig.alive = false;
                    }

                    // Remove dead signals
                    if (!sig.alive && sig.progress > 1.2) {
                        sig.ripples.forEach(function(rip) {
                            parallaxGroup.remove(rip.mesh);
                            rip.mesh.geometry.dispose();
                            rip.mesh.material.dispose();
                        });
                        activeSignals.splice(s, 1);
                    }
                }
            }

            // Flash a shell (visual feedback when signal crosses it)
            function flashShell(shellIdx, color, intensity) {
                if (shellIdx >= shellUniforms.length) return;
                var u = shellUniforms[shellIdx];
                var origOpacity = u.uOpacity.value;
                var origColor = { x: u.uColor.value.x, y: u.uColor.value.y, z: u.uColor.value.z };
                u.uColor.value.set(color[0], color[1], color[2]);
                u.uOpacity.value = intensity;
                setTimeout(function() {
                    u.uColor.value.set(origColor.x, origColor.y, origColor.z);
                    u.uOpacity.value = origOpacity;
                }, 400);
            }

            // Flash brain core
            function flashCore(color) {
                var origOpacity = glowMat.opacity;
                glowMat.color.setRGB(color[0], color[1], color[2]);
                glowMat.opacity = 0.5;
                setTimeout(function() {
                    glowMat.color.setHex(0xec4899);
                    glowMat.opacity = origOpacity;
                }, 500);
            }

            // Event log
            function logSignalEvent(text, color) {
                if (!signalLog) return;
                var entry = document.createElement('div');
                entry.className = 'oni3d-log-entry';
                var c = Array.isArray(color) ? color : [0.5, 0.5, 0.5];
                entry.style.color = 'rgb(' + Math.round(c[0]*255) + ',' + Math.round(c[1]*255) + ',' + Math.round(c[2]*255) + ')';
                entry.style.borderLeft = '2px solid rgb(' + Math.round(c[0]*255) + ',' + Math.round(c[1]*255) + ',' + Math.round(c[2]*255) + ')';
                entry.textContent = '> ' + text;
                signalLog.appendChild(entry);
                // Keep max 4 entries
                while (signalLog.children.length > 4) {
                    signalLog.removeChild(signalLog.firstChild);
                }
                // Auto-fade after 5s
                setTimeout(function() {
                    entry.classList.add('fade');
                    setTimeout(function() {
                        if (entry.parentNode) entry.parentNode.removeChild(entry);
                    }, 600);
                }, 5000);
            }

            // --- Click-to-inject ---
            var raycaster = new THREE.Raycaster();
            var clickMouse = new THREE.Vector2();

            container.addEventListener('click', function(e) {
                // Skip signal injection if explainer popup is still visible
                var expl = document.getElementById('oni3d-explainer');
                if (expl && !expl.classList.contains('hidden')) return;

                var rect = container.getBoundingClientRect();
                clickMouse.x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
                clickMouse.y = -((e.clientY - rect.top) / rect.height) * 2 + 1;

                raycaster.setFromCamera(clickMouse, camera);
                var hits = raycaster.intersectObjects(shellMeshes);

                if (hits.length > 0) {
                    var hit = hits[0];
                    var layerIdx = shellMeshes.indexOf(hit.object);
                    if (layerIdx >= 0) {
                        // Random signal type: 60% normal, 25% threat, 15% stimulation
                        var rand = Math.random();
                        var type = rand < 0.6 ? 'normal' : (rand < 0.85 ? 'threat' : 'stimulation');
                        createSignal(layerIdx, type, 'inward');
                    }
                } else {
                    // Clicked empty space — inject from outermost layer
                    createSignal(0, Math.random() < 0.7 ? 'normal' : 'threat', 'inward');
                }
            });

            // --- Ambient auto-signals (every few seconds) ---
            var lastAutoSignal = 0;
            var autoSignalInterval = 4; // seconds

            function maybeAutoSignal(t) {
                if (t - lastAutoSignal > autoSignalInterval) {
                    lastAutoSignal = t;
                    // Pick random layer and type
                    var idx = Math.floor(Math.random() * activeLayers.length);
                    var rand = Math.random();
                    var type = rand < 0.5 ? 'normal' : (rand < 0.8 ? 'threat' : 'stimulation');
                    var dir = idx > activeLayers.length / 2 ? 'outward' : 'inward';
                    createSignal(idx, type, dir);
                    // Vary interval
                    autoSignalInterval = 3 + Math.random() * 4;
                }
            }

            // --- Animation Loop ---
            function animate() {
                requestAnimationFrame(animate);
                if (!isVisible) return;

                var dt = clock.getDelta();
                var t = clock.getElapsedTime();

                // Update shader uniforms
                shellUniforms.forEach(function(u) { u.uTime.value = t; });
                coreU.uTime.value = t;
                nodeU.uTime.value = t;

                // Auto-rotation
                autoRotateGroup.rotation.y += 0.002;
                autoRotateGroup.rotation.x = Math.sin(t*0.15)*0.08;

                // Mouse parallax
                if (!isMobile) {
                    parallaxGroup.rotation.x += (mouseY*0.2 - parallaxGroup.rotation.x)*0.04;
                    parallaxGroup.rotation.y += (mouseX*0.3 - parallaxGroup.rotation.y)*0.04;
                }

                // Brain pulse
                var pulse = 1 + Math.sin(t*1.2)*0.025;
                coreMesh.scale.set(pulse, pulse*0.85, pulse);
                nodeCloud.scale.set(pulse, pulse*0.85, pulse);
                if (synapseLines) synapseLines.scale.set(pulse, pulse*0.85, pulse);

                // Inner glow pulse
                glowMat.opacity = 0.12 + Math.sin(t*1.8)*0.05;
                glowMesh.scale.setScalar(0.45 + Math.sin(t*1.2)*0.02);

                // Shell breathing
                shellMeshes.forEach(function(mesh, i) {
                    mesh.scale.setScalar(mesh.userData.r * (1 + Math.sin(t*0.6+i*0.5)*0.006));
                });

                // Gateway light pulse
                gatewayLight.intensity = 0.8 + Math.sin(t*3.0)*0.4;

                // Dust drift
                dustCloud.rotation.y = t*0.02;
                dustCloud.rotation.x = Math.sin(t*0.1)*0.05;

                // Signal propagation
                updateSignals(dt, t);
                maybeAutoSignal(t);

                renderer.render(scene, camera);
            }
            animate();

            // Show labels
            setTimeout(function() {
                document.querySelectorAll('.oni3d-label').forEach(function(el) {
                    el.classList.add('visible');
                });
            }, 1200);

            // Explainer popup — dismiss on close button or after first click on model
            var explainer = document.getElementById('oni3d-explainer');
            var explainerClose = document.getElementById('oni3d-explainer-close');
            if (explainer && explainerClose) {
                explainerClose.addEventListener('click', function(e) {
                    e.stopPropagation();
                    explainer.classList.add('hidden');
                });
                // Also dismiss when user clicks on the 3D canvas (first signal inject)
                container.addEventListener('click', function dismissExplainer() {
                    if (explainer && !explainer.classList.contains('hidden')) {
                        explainer.classList.add('hidden');
                    }
                    container.removeEventListener('click', dismissExplainer);
                }, { once: false });
            }
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            initHyperspeed();
            createNeuralBackground();
            animateCounters();
            loadBrandConstants();
            initLayersReveal();
            initTextReveal();
            initONI3D();
        });
    </script>
</body>
</html>
