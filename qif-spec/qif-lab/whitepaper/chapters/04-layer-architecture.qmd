---
title: "The QIF Layer Architecture"
---

```{python}
#| label: setup
#| include: false
import sys, os
sys.path.insert(0, '/Users/mac/Documents/PROJECTS/qinnovates/mindloft/drafts/ai-working/qif-lab')
from src.config import BANDS, ZONES, BRAIN_REGION_MAP, FRAMEWORK, DETERMINACY_SPECTRUM, V2_TO_V3_MIGRATION
import pandas as pd
```

## Why OSI Failed

The OSI model was designed in 1984 for packet-switched telecommunications. Its 7 layers — Physical, Data Link, Network, Transport, Session, Presentation, Application — describe how a byte moves between computers. A brain-computer interface is not a packet-switched network. There is no MAC addressing at the electrode-tissue boundary. There is no IP routing in the cortex. TCP flow control does not apply to neural oscillations.

QIF v2.0 stacked 7 neural layers on top of 7 OSI layers, creating a 14-layer tower. This was a metaphor, not a model. It implied the neural domain sits "above" silicon in some processing hierarchy. In reality, the electrode-tissue interface is where silicon and biology *physically touch* — they are adjacent, not stacked.

**QIF v3.0 removes all OSI heritage.** The layer model is now derived entirely from neuroscience and quantum physics.

## The Hourglass

```{python}
#| label: fig-hourglass
#| fig-cap: "QIF v3.0 — 7-Band Hourglass Architecture (3-1-3 symmetric). Width represents state space / possibility space. Narrowest at I0 (measurement collapses possibilities). The classical ceiling separates chaotic (N2) from quantum uncertain (N3)."

import matplotlib.pyplot as plt
import matplotlib.patches as mpatches

fig, ax = plt.subplots(figsize=(10, 10))
zone_colors = {z_id: z["color"] for z_id, z in ZONES.items()}
n = len(BANDS)

for i, band in enumerate(BANDS):
    y = n - 1 - i
    color = zone_colors[band["zone"]]
    alpha = 0.95 if band["id"] == "I0" else 0.8

    width = 0.2 + band["hourglass_width"] * 0.7
    x_offset = (1.0 - width) / 2

    rect = plt.Rectangle((x_offset, y), width, 0.85, facecolor=color, alpha=alpha,
                          edgecolor='white', linewidth=2, zorder=2)
    ax.add_patch(rect)
    ax.text(0.5, y + 0.42, f"{band['id']}: {band['name']}",
            ha='center', va='center', fontsize=10, fontweight='bold', color='white', zorder=3)

    # QI range
    qi_lo, qi_hi = band["qi_range"]
    qi_text = f"QI {qi_lo}–{qi_hi}" if qi_hi > 0 else "QI ≈ 0"
    ax.text(0.5 + width / 2 + 0.15, y + 0.42, qi_text,
            ha='left', va='center', fontsize=8, color='gray', zorder=3)

# Zone labels — computed dynamically
neural_ys = [n - 1 - i for i, b in enumerate(BANDS) if b["zone"] == "neural"]
interface_ys = [n - 1 - i for i, b in enumerate(BANDS) if b["zone"] == "interface"]
silicon_ys = [n - 1 - i for i, b in enumerate(BANDS) if b["zone"] == "silicon"]

ax.text(1.15, sum(neural_ys)/len(neural_ys) + 0.42, 'Neural\nDomain',
        ha='left', va='center', fontsize=10, color=zone_colors['neural'], fontweight='bold')
ax.text(1.15, sum(interface_ys)/len(interface_ys) + 0.42, 'Interface\nZone',
        ha='left', va='center', fontsize=10, color=zone_colors['interface'], fontweight='bold')
ax.text(1.15, sum(silicon_ys)/len(silicon_ys) + 0.42, 'Silicon\nDomain',
        ha='left', va='center', fontsize=10, color=zone_colors['silicon'], fontweight='bold')

# Classical ceiling — between N3 and N2 (dynamic)
n3_y = n - 1 - 0 + 0.42
n2_y = n - 1 - 1 + 0.42
ceiling_y = (n3_y + n2_y) / 2
ax.axhline(y=ceiling_y, color='#f39c12', linestyle='--', alpha=0.5, linewidth=1.5, xmin=0.05, xmax=0.95)
ax.text(0.97, ceiling_y + 0.05, 'Classical Ceiling', ha='right', va='bottom', fontsize=8,
        color='#f39c12', fontstyle='italic')

ax.set_xlim(-0.15, 1.5)
ax.set_ylim(-0.5, n + 0.5)
ax.set_aspect('auto')
ax.axis('off')
ax.set_title(f'QIF {FRAMEWORK["layer_model_version"]} — {n}-Band Hourglass Architecture',
             fontsize=14, fontweight='bold', pad=20)
plt.tight_layout()
plt.show()
```

## The 7 Bands

```{python}
#| label: tbl-bands
#| tbl-cap: "QIF v3.0 — 7-Band Hourglass Architecture (3-1-3 symmetric)"

rows = []
for band in BANDS:
    qi_lo, qi_hi = band["qi_range"]
    qi_str = f"{qi_lo}–{qi_hi}" if qi_hi > 0 else "≈ 0"
    regions = ", ".join(band["brain_regions"]) if band["brain_regions"] else "—"
    rows.append({
        "Band": band["id"],
        "Name": band["name"],
        "Zone": ZONES[band["zone"]]["name"],
        "Determinacy": band["determinacy"],
        "QI Range": qi_str,
        "Brain Regions": regions,
    })
pd.DataFrame(rows)
```

### Hourglass Geometry

- **Width = state space / possibility space.** At any horizontal slice of the hourglass, width represents how many states the system could occupy.
- **Widest at N3** — integrative association cortex, maximum security-relevant indeterminacy.
- **Widest at S3** — maximum classical pathways, full deterministic branching.
- **Narrowest at I0** — measurement collapses possibilities. All information must pass through this bottleneck.
- **3-1-3 symmetry** — 3 neural bands, 1 interface band, 3 silicon bands. The hourglass is structurally balanced.
- **The bottleneck has real thickness** — the quasi-quantum zone is not a line but a band where partial decoherence has occurred (0 < ΓD < 1).

### Naming Convention

- Format: `{Zone}{Number}` — N3, N2, N1, I0, S1, S2, S3
- Numbers increase **away from the interface** in both directions
- No relation to OSI layer numbers

## The Classical Ceiling

The boundary between N2 (chaotic) and N3 (quantum uncertain) is the **classical ceiling** — the dividing line between two fundamentally different kinds of unpredictability:

```{python}
#| label: tbl-determinacy
#| tbl-cap: "Determinacy Spectrum — 4 levels mapped to QIF bands"

rows = []
for level in DETERMINACY_SPECTRUM:
    rows.append({
        "Level": level["name"],
        "Bands": ", ".join(level["bands"]),
        "Description": level["description"],
    })
pd.DataFrame(rows)
```

**Below the ceiling** (deterministic, stochastic, chaotic): all unpredictability is — in principle — resolvable with better measurement. Hidden variables exist (Bell's theorem does not apply). Classical security tools operate here.

**Above the ceiling** (quantum uncertain): unpredictability is *ontic* — a property of reality, not of our knowledge. No amount of measurement can eliminate it. QIF's quantum terms are essential here.

## Brain Region Dependency Graph

Brain regions don't form a linear chain — they form a directed graph with parallel pathways, convergence hubs, and feedback loops.

```{python}
#| label: tbl-regions
#| tbl-cap: "Brain regions mapped to QIF bands with connections"

rows = []
for region, info in BRAIN_REGION_MAP.items():
    rows.append({
        "Region": region,
        "Band": info["band"],
        "Connections": ", ".join(info["connections"]),
    })
pd.DataFrame(rows)
```

Key structural properties:

- **Parallel pathways**: V1, A1, S1_cortex operate simultaneously (visual, auditory, somatosensory)
- **Convergence hub**: PFC receives input from nearly every region — the integration point
- **Mandatory gateway**: Thalamus gates almost all sensory input to cortex
- **Feedback**: PFC sends signals back to sensory and subcortical regions (attention, modulation)
- **Salience network**: Insula and ACC detect behaviorally relevant stimuli, bridging bodily sensation to conscious awareness
- **Amygdala split**: BLA (basolateral, N3) handles associative learning; CeA (central, N1) drives autonomic output
- **Cerebellar spanning**: Cerebellum bridges N1 relay and N2 sensorimotor via cerebellar-cortical loops

## I0: The Most Critical Band

I0 (Neural Interface) is where silicon meets biology — the measurement bottleneck. This is:

- Where quantum neural states collapse into classical data (recording)
- Where classical commands enter the quantum neural domain (stimulation)
- The attack surface for quantum-level threats (tunneling exploits, soliton attacks)
- Where the QI equation operates most directly

No existing framework addresses this boundary at the quantum level. The hourglass geometry makes its centrality visible: all information must pass through I0.

## QI Gradient

QI increases monotonically from S3 (zero) through I0 to N3 (maximum ~0.5). This follows from physics:

1. **Lower bands involve more particles** — quantum effects average out (decoherence)
2. **Higher bands have longer integration times** — more quantum phase space is sampled
3. **The decoherence factor ΓD maps to band position** — lower bands are fully decohered, upper bands retain partial coherence

The layers where QI is highest are the layers where compromise is most catastrophic — and where classical security offers the least protection.

## v2.0 → v3.0 Migration

```{python}
#| label: tbl-migration
#| tbl-cap: "Migration from deprecated v2.0 (14-layer) to v3.0 (7-band hourglass)"

rows = []
for old, new in V2_TO_V3_MIGRATION.items():
    rows.append({"v2.0": old, "v3.0": new})
pd.DataFrame(rows)
```
