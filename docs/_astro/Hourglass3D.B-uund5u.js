import{V as ze,S as tn,Q as rn,O as mr,P as yr,M as ut,T as ct,a as Ne,R as Wn,b as zn,c as Vn,d as Hn,e as Yn,U as Xn,f as Kn,g as Ar,h as Zn,C as Dt,i as Jn,I as Qn,j as qn,B as Tn,k as $n,l as ea,L as nn,m as ta,n as an,D as Tr,o as Dr,u as Qe,p as Cr,q as Me,r as ra,s as on}from"./react-three-fiber.esm.DgA6j6Et.js";import{r as Re}from"./index.ClAeb1qX.js";const na=c=>typeof c=="object"&&typeof c.then=="function",zt=[];function aa(c,r,h=(l,t)=>l===t){if(c===r)return!0;if(!c||!r)return!1;const l=c.length;if(r.length!==l)return!1;for(let t=0;t<l;t++)if(!h(c[t],r[t]))return!1;return!0}function oa(c,r=null,h=!1,l={}){r===null&&(r=[c]);for(const e of zt)if(aa(r,e.keys,e.equal)){if(h)return;if(Object.prototype.hasOwnProperty.call(e,"error"))throw e.error;if(Object.prototype.hasOwnProperty.call(e,"response"))return l.lifespan&&l.lifespan>0&&(e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(e.remove,l.lifespan)),e.response;if(!h)throw e.promise}const t={keys:r,equal:l.equal,remove:()=>{const e=zt.indexOf(t);e!==-1&&zt.splice(e,1)},promise:(na(c)?c:c(...r)).then(e=>{t.response=e,l.lifespan&&l.lifespan>0&&(t.timeout=setTimeout(t.remove,l.lifespan))}).catch(e=>t.error=e)};if(zt.push(t),!h)throw t.promise}const ia=(c,r,h)=>oa(c,r,!1,h);function Zt(){return Zt=Object.assign?Object.assign.bind():function(c){for(var r=1;r<arguments.length;r++){var h=arguments[r];for(var l in h)({}).hasOwnProperty.call(h,l)&&(c[l]=h[l])}return c},Zt.apply(null,arguments)}var sa=Object.defineProperty,la=(c,r,h)=>r in c?sa(c,r,{enumerable:!0,configurable:!0,writable:!0,value:h}):c[r]=h,fa=(c,r,h)=>(la(c,r+"",h),h);class ua{constructor(){fa(this,"_listeners")}addEventListener(r,h){this._listeners===void 0&&(this._listeners={});const l=this._listeners;l[r]===void 0&&(l[r]=[]),l[r].indexOf(h)===-1&&l[r].push(h)}hasEventListener(r,h){if(this._listeners===void 0)return!1;const l=this._listeners;return l[r]!==void 0&&l[r].indexOf(h)!==-1}removeEventListener(r,h){if(this._listeners===void 0)return;const t=this._listeners[r];if(t!==void 0){const e=t.indexOf(h);e!==-1&&t.splice(e,1)}}dispatchEvent(r){if(this._listeners===void 0)return;const l=this._listeners[r.type];if(l!==void 0){r.target=this;const t=l.slice(0);for(let e=0,a=t.length;e<a;e++)t[e].call(this,r);r.target=null}}}var ca=Object.defineProperty,ha=(c,r,h)=>r in c?ca(c,r,{enumerable:!0,configurable:!0,writable:!0,value:h}):c[r]=h,ve=(c,r,h)=>(ha(c,typeof r!="symbol"?r+"":r,h),h);const Vt=new Wn,sn=new zn,da=Math.cos(70*(Math.PI/180)),ln=(c,r)=>(c%r+r)%r;let pa=class extends ua{constructor(r,h){super(),ve(this,"object"),ve(this,"domElement"),ve(this,"enabled",!0),ve(this,"target",new ze),ve(this,"minDistance",0),ve(this,"maxDistance",1/0),ve(this,"minZoom",0),ve(this,"maxZoom",1/0),ve(this,"minPolarAngle",0),ve(this,"maxPolarAngle",Math.PI),ve(this,"minAzimuthAngle",-1/0),ve(this,"maxAzimuthAngle",1/0),ve(this,"enableDamping",!1),ve(this,"dampingFactor",.05),ve(this,"enableZoom",!0),ve(this,"zoomSpeed",1),ve(this,"enableRotate",!0),ve(this,"rotateSpeed",1),ve(this,"enablePan",!0),ve(this,"panSpeed",1),ve(this,"screenSpacePanning",!0),ve(this,"keyPanSpeed",7),ve(this,"zoomToCursor",!1),ve(this,"autoRotate",!1),ve(this,"autoRotateSpeed",2),ve(this,"reverseOrbit",!1),ve(this,"reverseHorizontalOrbit",!1),ve(this,"reverseVerticalOrbit",!1),ve(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),ve(this,"mouseButtons",{LEFT:ut.ROTATE,MIDDLE:ut.DOLLY,RIGHT:ut.PAN}),ve(this,"touches",{ONE:ct.ROTATE,TWO:ct.DOLLY_PAN}),ve(this,"target0"),ve(this,"position0"),ve(this,"zoom0"),ve(this,"_domElementKeyEvents",null),ve(this,"getPolarAngle"),ve(this,"getAzimuthalAngle"),ve(this,"setPolarAngle"),ve(this,"setAzimuthalAngle"),ve(this,"getDistance"),ve(this,"getZoomScale"),ve(this,"listenToKeyEvents"),ve(this,"stopListenToKeyEvents"),ve(this,"saveState"),ve(this,"reset"),ve(this,"update"),ve(this,"connect"),ve(this,"dispose"),ve(this,"dollyIn"),ve(this,"dollyOut"),ve(this,"getScale"),ve(this,"setScale"),this.object=r,this.domElement=h,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>s.phi,this.getAzimuthalAngle=()=>s.theta,this.setPolarAngle=v=>{let B=ln(v,2*Math.PI),ae=s.phi;ae<0&&(ae+=2*Math.PI),B<0&&(B+=2*Math.PI);let ue=Math.abs(B-ae);2*Math.PI-ue<ue&&(B<ae?B+=2*Math.PI:ae+=2*Math.PI),f.phi=B-ae,l.update()},this.setAzimuthalAngle=v=>{let B=ln(v,2*Math.PI),ae=s.theta;ae<0&&(ae+=2*Math.PI),B<0&&(B+=2*Math.PI);let ue=Math.abs(B-ae);2*Math.PI-ue<ue&&(B<ae?B+=2*Math.PI:ae+=2*Math.PI),f.theta=B-ae,l.update()},this.getDistance=()=>l.object.position.distanceTo(l.target),this.listenToKeyEvents=v=>{v.addEventListener("keydown",fe),this._domElementKeyEvents=v},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",fe),this._domElementKeyEvents=null},this.saveState=()=>{l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=()=>{l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(t),l.update(),n=o.NONE},this.update=(()=>{const v=new ze,B=new ze(0,1,0),ae=new rn().setFromUnitVectors(r.up,B),ue=ae.clone().invert(),$=new ze,Te=new rn,Ie=2*Math.PI;return function(){const Ue=l.object.position;ae.setFromUnitVectors(r.up,B),ue.copy(ae).invert(),v.copy(Ue).sub(l.target),v.applyQuaternion(ae),s.setFromVector3(v),l.autoRotate&&n===o.NONE&&F(b()),l.enableDamping?(s.theta+=f.theta*l.dampingFactor,s.phi+=f.phi*l.dampingFactor):(s.theta+=f.theta,s.phi+=f.phi);let Ee=l.minAzimuthAngle,we=l.maxAzimuthAngle;isFinite(Ee)&&isFinite(we)&&(Ee<-Math.PI?Ee+=Ie:Ee>Math.PI&&(Ee-=Ie),we<-Math.PI?we+=Ie:we>Math.PI&&(we-=Ie),Ee<=we?s.theta=Math.max(Ee,Math.min(we,s.theta)):s.theta=s.theta>(Ee+we)/2?Math.max(Ee,s.theta):Math.min(we,s.theta)),s.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,s.phi)),s.makeSafe(),l.enableDamping===!0?l.target.addScaledVector(d,l.dampingFactor):l.target.add(d),l.zoomToCursor&&I||l.object.isOrthographicCamera?s.radius=C(s.radius):s.radius=C(s.radius*u),v.setFromSpherical(s),v.applyQuaternion(ue),Ue.copy(l.target).add(v),l.object.matrixAutoUpdate||l.object.updateMatrix(),l.object.lookAt(l.target),l.enableDamping===!0?(f.theta*=1-l.dampingFactor,f.phi*=1-l.dampingFactor,d.multiplyScalar(1-l.dampingFactor)):(f.set(0,0,0),d.set(0,0,0));let me=!1;if(l.zoomToCursor&&I){let Ae=null;if(l.object instanceof yr&&l.object.isPerspectiveCamera){const Pe=v.length();Ae=C(Pe*u);const Oe=Pe-Ae;l.object.position.addScaledVector(w,Oe),l.object.updateMatrixWorld()}else if(l.object.isOrthographicCamera){const Pe=new ze(k.x,k.y,0);Pe.unproject(l.object),l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/u)),l.object.updateProjectionMatrix(),me=!0;const Oe=new ze(k.x,k.y,0);Oe.unproject(l.object),l.object.position.sub(Oe).add(Pe),l.object.updateMatrixWorld(),Ae=v.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),l.zoomToCursor=!1;Ae!==null&&(l.screenSpacePanning?l.target.set(0,0,-1).transformDirection(l.object.matrix).multiplyScalar(Ae).add(l.object.position):(Vt.origin.copy(l.object.position),Vt.direction.set(0,0,-1).transformDirection(l.object.matrix),Math.abs(l.object.up.dot(Vt.direction))<da?r.lookAt(l.target):(sn.setFromNormalAndCoplanarPoint(l.object.up,l.target),Vt.intersectPlane(sn,l.target))))}else l.object instanceof mr&&l.object.isOrthographicCamera&&(me=u!==1,me&&(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/u)),l.object.updateProjectionMatrix()));return u=1,I=!1,me||$.distanceToSquared(l.object.position)>i||8*(1-Te.dot(l.object.quaternion))>i?(l.dispatchEvent(t),$.copy(l.object.position),Te.copy(l.object.quaternion),me=!1,!0):!1}})(),this.connect=v=>{l.domElement=v,l.domElement.style.touchAction="none",l.domElement.addEventListener("contextmenu",De),l.domElement.addEventListener("pointerdown",ye),l.domElement.addEventListener("pointercancel",ne),l.domElement.addEventListener("wheel",le)},this.dispose=()=>{var v,B,ae,ue,$,Te;l.domElement&&(l.domElement.style.touchAction="auto"),(v=l.domElement)==null||v.removeEventListener("contextmenu",De),(B=l.domElement)==null||B.removeEventListener("pointerdown",ye),(ae=l.domElement)==null||ae.removeEventListener("pointercancel",ne),(ue=l.domElement)==null||ue.removeEventListener("wheel",le),($=l.domElement)==null||$.ownerDocument.removeEventListener("pointermove",Q),(Te=l.domElement)==null||Te.ownerDocument.removeEventListener("pointerup",ne),l._domElementKeyEvents!==null&&l._domElementKeyEvents.removeEventListener("keydown",fe)};const l=this,t={type:"change"},e={type:"start"},a={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let n=o.NONE;const i=1e-6,s=new tn,f=new tn;let u=1;const d=new ze,g=new Ne,m=new Ne,y=new Ne,R=new Ne,U=new Ne,E=new Ne,x=new Ne,_=new Ne,D=new Ne,w=new ze,k=new Ne;let I=!1;const T=[],J={};function b(){return 2*Math.PI/60/60*l.autoRotateSpeed}function P(){return Math.pow(.95,l.zoomSpeed)}function F(v){l.reverseOrbit||l.reverseHorizontalOrbit?f.theta+=v:f.theta-=v}function Y(v){l.reverseOrbit||l.reverseVerticalOrbit?f.phi+=v:f.phi-=v}const V=(()=>{const v=new ze;return function(ae,ue){v.setFromMatrixColumn(ue,0),v.multiplyScalar(-ae),d.add(v)}})(),ee=(()=>{const v=new ze;return function(ae,ue){l.screenSpacePanning===!0?v.setFromMatrixColumn(ue,1):(v.setFromMatrixColumn(ue,0),v.crossVectors(l.object.up,v)),v.multiplyScalar(ae),d.add(v)}})(),te=(()=>{const v=new ze;return function(ae,ue){const $=l.domElement;if($&&l.object instanceof yr&&l.object.isPerspectiveCamera){const Te=l.object.position;v.copy(Te).sub(l.target);let Ie=v.length();Ie*=Math.tan(l.object.fov/2*Math.PI/180),V(2*ae*Ie/$.clientHeight,l.object.matrix),ee(2*ue*Ie/$.clientHeight,l.object.matrix)}else $&&l.object instanceof mr&&l.object.isOrthographicCamera?(V(ae*(l.object.right-l.object.left)/l.object.zoom/$.clientWidth,l.object.matrix),ee(ue*(l.object.top-l.object.bottom)/l.object.zoom/$.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}})();function N(v){l.object instanceof yr&&l.object.isPerspectiveCamera||l.object instanceof mr&&l.object.isOrthographicCamera?u=v:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function L(v){N(u/v)}function p(v){N(u*v)}function S(v){if(!l.zoomToCursor||!l.domElement)return;I=!0;const B=l.domElement.getBoundingClientRect(),ae=v.clientX-B.left,ue=v.clientY-B.top,$=B.width,Te=B.height;k.x=ae/$*2-1,k.y=-(ue/Te)*2+1,w.set(k.x,k.y,1).unproject(l.object).sub(l.object.position).normalize()}function C(v){return Math.max(l.minDistance,Math.min(l.maxDistance,v))}function M(v){g.set(v.clientX,v.clientY)}function A(v){S(v),x.set(v.clientX,v.clientY)}function W(v){R.set(v.clientX,v.clientY)}function O(v){m.set(v.clientX,v.clientY),y.subVectors(m,g).multiplyScalar(l.rotateSpeed);const B=l.domElement;B&&(F(2*Math.PI*y.x/B.clientHeight),Y(2*Math.PI*y.y/B.clientHeight)),g.copy(m),l.update()}function j(v){_.set(v.clientX,v.clientY),D.subVectors(_,x),D.y>0?L(P()):D.y<0&&p(P()),x.copy(_),l.update()}function K(v){U.set(v.clientX,v.clientY),E.subVectors(U,R).multiplyScalar(l.panSpeed),te(E.x,E.y),R.copy(U),l.update()}function oe(v){S(v),v.deltaY<0?p(P()):v.deltaY>0&&L(P()),l.update()}function X(v){let B=!1;switch(v.code){case l.keys.UP:te(0,l.keyPanSpeed),B=!0;break;case l.keys.BOTTOM:te(0,-l.keyPanSpeed),B=!0;break;case l.keys.LEFT:te(l.keyPanSpeed,0),B=!0;break;case l.keys.RIGHT:te(-l.keyPanSpeed,0),B=!0;break}B&&(v.preventDefault(),l.update())}function z(){if(T.length==1)g.set(T[0].pageX,T[0].pageY);else{const v=.5*(T[0].pageX+T[1].pageX),B=.5*(T[0].pageY+T[1].pageY);g.set(v,B)}}function be(){if(T.length==1)R.set(T[0].pageX,T[0].pageY);else{const v=.5*(T[0].pageX+T[1].pageX),B=.5*(T[0].pageY+T[1].pageY);R.set(v,B)}}function ge(){const v=T[0].pageX-T[1].pageX,B=T[0].pageY-T[1].pageY,ae=Math.sqrt(v*v+B*B);x.set(0,ae)}function q(){l.enableZoom&&ge(),l.enablePan&&be()}function se(){l.enableZoom&&ge(),l.enableRotate&&z()}function he(v){if(T.length==1)m.set(v.pageX,v.pageY);else{const ae=ce(v),ue=.5*(v.pageX+ae.x),$=.5*(v.pageY+ae.y);m.set(ue,$)}y.subVectors(m,g).multiplyScalar(l.rotateSpeed);const B=l.domElement;B&&(F(2*Math.PI*y.x/B.clientHeight),Y(2*Math.PI*y.y/B.clientHeight)),g.copy(m)}function H(v){if(T.length==1)U.set(v.pageX,v.pageY);else{const B=ce(v),ae=.5*(v.pageX+B.x),ue=.5*(v.pageY+B.y);U.set(ae,ue)}E.subVectors(U,R).multiplyScalar(l.panSpeed),te(E.x,E.y),R.copy(U)}function ie(v){const B=ce(v),ae=v.pageX-B.x,ue=v.pageY-B.y,$=Math.sqrt(ae*ae+ue*ue);_.set(0,$),D.set(0,Math.pow(_.y/x.y,l.zoomSpeed)),L(D.y),x.copy(_)}function re(v){l.enableZoom&&ie(v),l.enablePan&&H(v)}function G(v){l.enableZoom&&ie(v),l.enableRotate&&he(v)}function ye(v){var B,ae;l.enabled!==!1&&(T.length===0&&((B=l.domElement)==null||B.ownerDocument.addEventListener("pointermove",Q),(ae=l.domElement)==null||ae.ownerDocument.addEventListener("pointerup",ne)),Fe(v),v.pointerType==="touch"?pe(v):Z(v))}function Q(v){l.enabled!==!1&&(v.pointerType==="touch"?xe(v):ke(v))}function ne(v){var B,ae,ue;Se(v),T.length===0&&((B=l.domElement)==null||B.releasePointerCapture(v.pointerId),(ae=l.domElement)==null||ae.ownerDocument.removeEventListener("pointermove",Q),(ue=l.domElement)==null||ue.ownerDocument.removeEventListener("pointerup",ne)),l.dispatchEvent(a),n=o.NONE}function Z(v){let B;switch(v.button){case 0:B=l.mouseButtons.LEFT;break;case 1:B=l.mouseButtons.MIDDLE;break;case 2:B=l.mouseButtons.RIGHT;break;default:B=-1}switch(B){case ut.DOLLY:if(l.enableZoom===!1)return;A(v),n=o.DOLLY;break;case ut.ROTATE:if(v.ctrlKey||v.metaKey||v.shiftKey){if(l.enablePan===!1)return;W(v),n=o.PAN}else{if(l.enableRotate===!1)return;M(v),n=o.ROTATE}break;case ut.PAN:if(v.ctrlKey||v.metaKey||v.shiftKey){if(l.enableRotate===!1)return;M(v),n=o.ROTATE}else{if(l.enablePan===!1)return;W(v),n=o.PAN}break;default:n=o.NONE}n!==o.NONE&&l.dispatchEvent(e)}function ke(v){if(l.enabled!==!1)switch(n){case o.ROTATE:if(l.enableRotate===!1)return;O(v);break;case o.DOLLY:if(l.enableZoom===!1)return;j(v);break;case o.PAN:if(l.enablePan===!1)return;K(v);break}}function le(v){l.enabled===!1||l.enableZoom===!1||n!==o.NONE&&n!==o.ROTATE||(v.preventDefault(),l.dispatchEvent(e),oe(v),l.dispatchEvent(a))}function fe(v){l.enabled===!1||l.enablePan===!1||X(v)}function pe(v){switch(_e(v),T.length){case 1:switch(l.touches.ONE){case ct.ROTATE:if(l.enableRotate===!1)return;z(),n=o.TOUCH_ROTATE;break;case ct.PAN:if(l.enablePan===!1)return;be(),n=o.TOUCH_PAN;break;default:n=o.NONE}break;case 2:switch(l.touches.TWO){case ct.DOLLY_PAN:if(l.enableZoom===!1&&l.enablePan===!1)return;q(),n=o.TOUCH_DOLLY_PAN;break;case ct.DOLLY_ROTATE:if(l.enableZoom===!1&&l.enableRotate===!1)return;se(),n=o.TOUCH_DOLLY_ROTATE;break;default:n=o.NONE}break;default:n=o.NONE}n!==o.NONE&&l.dispatchEvent(e)}function xe(v){switch(_e(v),n){case o.TOUCH_ROTATE:if(l.enableRotate===!1)return;he(v),l.update();break;case o.TOUCH_PAN:if(l.enablePan===!1)return;H(v),l.update();break;case o.TOUCH_DOLLY_PAN:if(l.enableZoom===!1&&l.enablePan===!1)return;re(v),l.update();break;case o.TOUCH_DOLLY_ROTATE:if(l.enableZoom===!1&&l.enableRotate===!1)return;G(v),l.update();break;default:n=o.NONE}}function De(v){l.enabled!==!1&&v.preventDefault()}function Fe(v){T.push(v)}function Se(v){delete J[v.pointerId];for(let B=0;B<T.length;B++)if(T[B].pointerId==v.pointerId){T.splice(B,1);return}}function _e(v){let B=J[v.pointerId];B===void 0&&(B=new Ne,J[v.pointerId]=B),B.set(v.pageX,v.pageY)}function ce(v){const B=v.pointerId===T[0].pointerId?T[1]:T[0];return J[B.pointerId]}this.dollyIn=(v=P())=>{p(v),l.update()},this.dollyOut=(v=P())=>{L(v),l.update()},this.getScale=()=>u,this.setScale=v=>{N(v),l.update()},this.getZoomScale=()=>P(),h!==void 0&&this.connect(h),this.update()}};function va(){var c=Object.create(null);function r(t,e){var a=t.id,o=t.name,n=t.dependencies;n===void 0&&(n=[]);var i=t.init;i===void 0&&(i=function(){});var s=t.getTransferables;if(s===void 0&&(s=null),!c[a])try{n=n.map(function(u){return u&&u.isWorkerModule&&(r(u,function(d){if(d instanceof Error)throw d}),u=c[u.id].value),u}),i=l("<"+o+">.init",i),s&&(s=l("<"+o+">.getTransferables",s));var f=null;typeof i=="function"?f=i.apply(void 0,n):console.error("worker module init function failed to rehydrate"),c[a]={id:a,value:f,getTransferables:s},e(f)}catch(u){u&&u.noLog||console.error(u),e(u)}}function h(t,e){var a,o=t.id,n=t.args;(!c[o]||typeof c[o].value!="function")&&e(new Error("Worker module "+o+": not found or its 'init' did not return a function"));try{var i=(a=c[o]).value.apply(a,n);i&&typeof i.then=="function"?i.then(s,function(f){return e(f instanceof Error?f:new Error(""+f))}):s(i)}catch(f){e(f)}function s(f){try{var u=c[o].getTransferables&&c[o].getTransferables(f);(!u||!Array.isArray(u)||!u.length)&&(u=void 0),e(f,u)}catch(d){console.error(d),e(d)}}}function l(t,e){var a=void 0;self.troikaDefine=function(n){return a=n};var o=URL.createObjectURL(new Blob(["/** "+t.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(o)}catch(n){console.error(n)}return URL.revokeObjectURL(o),delete self.troikaDefine,a}self.addEventListener("message",function(t){var e=t.data,a=e.messageId,o=e.action,n=e.data;try{o==="registerModule"&&r(n,function(i){i instanceof Error?postMessage({messageId:a,success:!1,error:i.message}):postMessage({messageId:a,success:!0,result:{isCallable:typeof i=="function"}})}),o==="callModule"&&h(n,function(i,s){i instanceof Error?postMessage({messageId:a,success:!1,error:i.message}):postMessage({messageId:a,success:!0,result:i},s||void 0)})}catch(i){postMessage({messageId:a,success:!1,error:i.stack})}})}function ga(c){var r=function(){for(var h=[],l=arguments.length;l--;)h[l]=arguments[l];return r._getInitResult().then(function(t){if(typeof t=="function")return t.apply(void 0,h);throw new Error("Worker module function was called but `init` did not return a callable function")})};return r._getInitResult=function(){var h=c.dependencies,l=c.init;h=Array.isArray(h)?h.map(function(e){return e&&(e=e.onMainThread||e,e._getInitResult&&(e=e._getInitResult())),e}):[];var t=Promise.all(h).then(function(e){return l.apply(null,e)});return r._getInitResult=function(){return t},t},r}var Un=function(){var c=!1;if(typeof window<"u"&&typeof window.document<"u")try{var r=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));r.terminate(),c=!0}catch(h){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+h.message+"]")}return Un=function(){return c},c},ma=0,ya=0,br=!1,Et=Object.create(null),At=Object.create(null),Ur=Object.create(null);function dt(c){if((!c||typeof c.init!="function")&&!br)throw new Error("requires `options.init` function");var r=c.dependencies,h=c.init,l=c.getTransferables,t=c.workerId,e=ga(c);t==null&&(t="#default");var a="workerModule"+ ++ma,o=c.name||a,n=null;r=r&&r.map(function(s){return typeof s=="function"&&!s.workerModuleData&&(br=!0,s=dt({workerId:t,name:"<"+o+"> function dependency: "+s.name,init:`function(){return (
`+Xt(s)+`
)}`}),br=!1),s&&s.workerModuleData&&(s=s.workerModuleData),s});function i(){for(var s=[],f=arguments.length;f--;)s[f]=arguments[f];if(!Un())return e.apply(void 0,s);if(!n){n=fn(t,"registerModule",i.workerModuleData);var u=function(){n=null,At[t].delete(u)};(At[t]||(At[t]=new Set)).add(u)}return n.then(function(d){var g=d.isCallable;if(g)return fn(t,"callModule",{id:a,args:s});throw new Error("Worker module function was called but `init` did not return a callable function")})}return i.workerModuleData={isWorkerModule:!0,id:a,name:o,dependencies:r,init:Xt(h),getTransferables:l&&Xt(l)},i.onMainThread=e,i}function ba(c){At[c]&&At[c].forEach(function(r){r()}),Et[c]&&(Et[c].terminate(),delete Et[c])}function Xt(c){var r=c.toString();return!/^function/.test(r)&&/^\w+\s*\(/.test(r)&&(r="function "+r),r}function xa(c){var r=Et[c];if(!r){var h=Xt(va);r=Et[c]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+c.replace(/\*/g,"")+` **/

;(`+h+")()"],{type:"application/javascript"}))),r.onmessage=function(l){var t=l.data,e=t.messageId,a=Ur[e];if(!a)throw new Error("WorkerModule response with empty or unknown messageId");delete Ur[e],a(t)}}return r}function fn(c,r,h){return new Promise(function(l,t){var e=++ya;Ur[e]=function(a){a.success?l(a.result):t(new Error("Error in worker "+r+" call: "+a.error))},xa(c).postMessage({messageId:e,action:r,data:h})})}function wn(){var c=(function(r){function h(N,L,p,S,C,M,A,W){var O=1-A;W.x=O*O*N+2*O*A*p+A*A*C,W.y=O*O*L+2*O*A*S+A*A*M}function l(N,L,p,S,C,M,A,W,O,j){var K=1-O;j.x=K*K*K*N+3*K*K*O*p+3*K*O*O*C+O*O*O*A,j.y=K*K*K*L+3*K*K*O*S+3*K*O*O*M+O*O*O*W}function t(N,L){for(var p=/([MLQCZ])([^MLQCZ]*)/g,S,C,M,A,W;S=p.exec(N);){var O=S[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(j){return parseFloat(j)});switch(S[1]){case"M":A=C=O[0],W=M=O[1];break;case"L":(O[0]!==A||O[1]!==W)&&L("L",A,W,A=O[0],W=O[1]);break;case"Q":{L("Q",A,W,A=O[2],W=O[3],O[0],O[1]);break}case"C":{L("C",A,W,A=O[4],W=O[5],O[0],O[1],O[2],O[3]);break}case"Z":(A!==C||W!==M)&&L("L",A,W,C,M);break}}}function e(N,L,p){p===void 0&&(p=16);var S={x:0,y:0};t(N,function(C,M,A,W,O,j,K,oe,X){switch(C){case"L":L(M,A,W,O);break;case"Q":{for(var z=M,be=A,ge=1;ge<p;ge++)h(M,A,j,K,W,O,ge/(p-1),S),L(z,be,S.x,S.y),z=S.x,be=S.y;break}case"C":{for(var q=M,se=A,he=1;he<p;he++)l(M,A,j,K,oe,X,W,O,he/(p-1),S),L(q,se,S.x,S.y),q=S.x,se=S.y;break}}})}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",o="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",n=new WeakMap,i={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function s(N,L){var p=N.getContext?N.getContext("webgl",i):N,S=n.get(p);if(!S){let K=function(q){var se=M[q];if(!se&&(se=M[q]=p.getExtension(q),!se))throw new Error(q+" not supported");return se},oe=function(q,se){var he=p.createShader(se);return p.shaderSource(he,q),p.compileShader(he),he},X=function(q,se,he,H){if(!A[q]){var ie={},re={},G=p.createProgram();p.attachShader(G,oe(se,p.VERTEX_SHADER)),p.attachShader(G,oe(he,p.FRAGMENT_SHADER)),p.linkProgram(G),A[q]={program:G,transaction:function(Q){p.useProgram(G),Q({setUniform:function(Z,ke){for(var le=[],fe=arguments.length-2;fe-- >0;)le[fe]=arguments[fe+2];var pe=re[ke]||(re[ke]=p.getUniformLocation(G,ke));p["uniform"+Z].apply(p,[pe].concat(le))},setAttribute:function(Z,ke,le,fe,pe){var xe=ie[Z];xe||(xe=ie[Z]={buf:p.createBuffer(),loc:p.getAttribLocation(G,Z),data:null}),p.bindBuffer(p.ARRAY_BUFFER,xe.buf),p.vertexAttribPointer(xe.loc,ke,p.FLOAT,!1,0,0),p.enableVertexAttribArray(xe.loc),C?p.vertexAttribDivisor(xe.loc,fe):K("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(xe.loc,fe),pe!==xe.data&&(p.bufferData(p.ARRAY_BUFFER,pe,le),xe.data=pe)}})}}}A[q].transaction(H)},z=function(q,se){O++;try{p.activeTexture(p.TEXTURE0+O);var he=W[q];he||(he=W[q]=p.createTexture(),p.bindTexture(p.TEXTURE_2D,he),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST)),p.bindTexture(p.TEXTURE_2D,he),se(he,O)}finally{O--}},be=function(q,se,he){var H=p.createFramebuffer();j.push(H),p.bindFramebuffer(p.FRAMEBUFFER,H),p.activeTexture(p.TEXTURE0+se),p.bindTexture(p.TEXTURE_2D,q),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,q,0);try{he(H)}finally{p.deleteFramebuffer(H),p.bindFramebuffer(p.FRAMEBUFFER,j[--j.length-1]||null)}},ge=function(){M={},A={},W={},O=-1,j.length=0};var C=typeof WebGL2RenderingContext<"u"&&p instanceof WebGL2RenderingContext,M={},A={},W={},O=-1,j=[];p.canvas.addEventListener("webglcontextlost",function(q){ge(),q.preventDefault()},!1),n.set(p,S={gl:p,isWebGL2:C,getExtension:K,withProgram:X,withTexture:z,withTextureFramebuffer:be,handleContextLoss:ge})}L(S)}function f(N,L,p,S,C,M,A,W){A===void 0&&(A=15),W===void 0&&(W=null),s(N,function(O){var j=O.gl,K=O.withProgram,oe=O.withTexture;oe("copy",function(X,z){j.texImage2D(j.TEXTURE_2D,0,j.RGBA,C,M,0,j.RGBA,j.UNSIGNED_BYTE,L),K("copy",a,o,function(be){var ge=be.setUniform,q=be.setAttribute;q("aUV",2,j.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ge("1i","image",z),j.bindFramebuffer(j.FRAMEBUFFER,W||null),j.disable(j.BLEND),j.colorMask(A&8,A&4,A&2,A&1),j.viewport(p,S,C,M),j.scissor(p,S,C,M),j.drawArrays(j.TRIANGLES,0,3)})})})}function u(N,L,p){var S=N.width,C=N.height;s(N,function(M){var A=M.gl,W=new Uint8Array(S*C*4);A.readPixels(0,0,S,C,A.RGBA,A.UNSIGNED_BYTE,W),N.width=L,N.height=p,f(A,W,0,0,S,C)})}var d=Object.freeze({__proto__:null,withWebGLContext:s,renderImageData:f,resizeWebGLCanvasWithoutClearing:u});function g(N,L,p,S,C,M){M===void 0&&(M=1);var A=new Uint8Array(N*L),W=S[2]-S[0],O=S[3]-S[1],j=[];e(p,function(q,se,he,H){j.push({x1:q,y1:se,x2:he,y2:H,minX:Math.min(q,he),minY:Math.min(se,H),maxX:Math.max(q,he),maxY:Math.max(se,H)})}),j.sort(function(q,se){return q.maxX-se.maxX});for(var K=0;K<N;K++)for(var oe=0;oe<L;oe++){var X=be(S[0]+W*(K+.5)/N,S[1]+O*(oe+.5)/L),z=Math.pow(1-Math.abs(X)/C,M)/2;X<0&&(z=1-z),z=Math.max(0,Math.min(255,Math.round(z*255))),A[oe*N+K]=z}return A;function be(q,se){for(var he=1/0,H=1/0,ie=j.length;ie--;){var re=j[ie];if(re.maxX+H<=q)break;if(q+H>re.minX&&se-H<re.maxY&&se+H>re.minY){var G=R(q,se,re.x1,re.y1,re.x2,re.y2);G<he&&(he=G,H=Math.sqrt(he))}}return ge(q,se)&&(H=-H),H}function ge(q,se){for(var he=0,H=j.length;H--;){var ie=j[H];if(ie.maxX<=q)break;var re=ie.y1>se!=ie.y2>se&&q<(ie.x2-ie.x1)*(se-ie.y1)/(ie.y2-ie.y1)+ie.x1;re&&(he+=ie.y1<ie.y2?1:-1)}return he!==0}}function m(N,L,p,S,C,M,A,W,O,j){M===void 0&&(M=1),W===void 0&&(W=0),O===void 0&&(O=0),j===void 0&&(j=0),y(N,L,p,S,C,M,A,null,W,O,j)}function y(N,L,p,S,C,M,A,W,O,j,K){M===void 0&&(M=1),O===void 0&&(O=0),j===void 0&&(j=0),K===void 0&&(K=0);for(var oe=g(N,L,p,S,C,M),X=new Uint8Array(oe.length*4),z=0;z<oe.length;z++)X[z*4+K]=oe[z];f(A,X,O,j,N,L,1<<3-K,W)}function R(N,L,p,S,C,M){var A=C-p,W=M-S,O=A*A+W*W,j=O?Math.max(0,Math.min(1,((N-p)*A+(L-S)*W)/O)):0,K=N-(p+j*A),oe=L-(S+j*W);return K*K+oe*oe}var U=Object.freeze({__proto__:null,generate:g,generateIntoCanvas:m,generateIntoFramebuffer:y}),E="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",x="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",_="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",D=new Float32Array([0,0,2,0,0,2]),w=null,k=!1,I={},T=new WeakMap;function J(N){if(!k&&!Y(N))throw new Error("WebGL generation not supported")}function b(N,L,p,S,C,M,A){if(M===void 0&&(M=1),A===void 0&&(A=null),!A&&(A=w,!A)){var W=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!W)throw new Error("OffscreenCanvas or DOM canvas not supported");A=w=W.getContext("webgl",{depth:!1})}J(A);var O=new Uint8Array(N*L*4);s(A,function(X){var z=X.gl,be=X.withTexture,ge=X.withTextureFramebuffer;be("readable",function(q,se){z.texImage2D(z.TEXTURE_2D,0,z.RGBA,N,L,0,z.RGBA,z.UNSIGNED_BYTE,null),ge(q,se,function(he){F(N,L,p,S,C,M,z,he,0,0,0),z.readPixels(0,0,N,L,z.RGBA,z.UNSIGNED_BYTE,O)})})});for(var j=new Uint8Array(N*L),K=0,oe=0;K<O.length;K+=4)j[oe++]=O[K];return j}function P(N,L,p,S,C,M,A,W,O,j){M===void 0&&(M=1),W===void 0&&(W=0),O===void 0&&(O=0),j===void 0&&(j=0),F(N,L,p,S,C,M,A,null,W,O,j)}function F(N,L,p,S,C,M,A,W,O,j,K){M===void 0&&(M=1),O===void 0&&(O=0),j===void 0&&(j=0),K===void 0&&(K=0),J(A);var oe=[];e(p,function(X,z,be,ge){oe.push(X,z,be,ge)}),oe=new Float32Array(oe),s(A,function(X){var z=X.gl,be=X.isWebGL2,ge=X.getExtension,q=X.withProgram,se=X.withTexture,he=X.withTextureFramebuffer,H=X.handleContextLoss;if(se("rawDistances",function(ie,re){(N!==ie._lastWidth||L!==ie._lastHeight)&&z.texImage2D(z.TEXTURE_2D,0,z.RGBA,ie._lastWidth=N,ie._lastHeight=L,0,z.RGBA,z.UNSIGNED_BYTE,null),q("main",E,x,function(G){var ye=G.setAttribute,Q=G.setUniform,ne=!be&&ge("ANGLE_instanced_arrays"),Z=!be&&ge("EXT_blend_minmax");ye("aUV",2,z.STATIC_DRAW,0,D),ye("aLineSegment",4,z.DYNAMIC_DRAW,1,oe),Q.apply(void 0,["4f","uGlyphBounds"].concat(S)),Q("1f","uMaxDistance",C),Q("1f","uExponent",M),he(ie,re,function(ke){z.enable(z.BLEND),z.colorMask(!0,!0,!0,!0),z.viewport(0,0,N,L),z.scissor(0,0,N,L),z.blendFunc(z.ONE,z.ONE),z.blendEquationSeparate(z.FUNC_ADD,be?z.MAX:Z.MAX_EXT),z.clear(z.COLOR_BUFFER_BIT),be?z.drawArraysInstanced(z.TRIANGLES,0,3,oe.length/4):ne.drawArraysInstancedANGLE(z.TRIANGLES,0,3,oe.length/4)})}),q("post",a,_,function(G){G.setAttribute("aUV",2,z.STATIC_DRAW,0,D),G.setUniform("1i","tex",re),z.bindFramebuffer(z.FRAMEBUFFER,W),z.disable(z.BLEND),z.colorMask(K===0,K===1,K===2,K===3),z.viewport(O,j,N,L),z.scissor(O,j,N,L),z.drawArrays(z.TRIANGLES,0,3)})}),z.isContextLost())throw H(),new Error("webgl context lost")})}function Y(N){var L=!N||N===w?I:N.canvas||N,p=T.get(L);if(p===void 0){k=!0;var S=null;try{var C=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],M=b(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,N);p=M&&C.length===M.length&&M.every(function(A,W){return A===C[W]}),p||(S="bad trial run results",console.info(C,M))}catch(A){p=!1,S=A.message}S&&console.warn("WebGL SDF generation not supported:",S),k=!1,T.set(L,p)}return p}var V=Object.freeze({__proto__:null,generate:b,generateIntoCanvas:P,generateIntoFramebuffer:F,isSupported:Y});function ee(N,L,p,S,C,M){C===void 0&&(C=Math.max(S[2]-S[0],S[3]-S[1])/2),M===void 0&&(M=1);try{return b.apply(V,arguments)}catch(A){return console.info("WebGL SDF generation failed, falling back to JS",A),g.apply(U,arguments)}}function te(N,L,p,S,C,M,A,W,O,j){C===void 0&&(C=Math.max(S[2]-S[0],S[3]-S[1])/2),M===void 0&&(M=1),W===void 0&&(W=0),O===void 0&&(O=0),j===void 0&&(j=0);try{return P.apply(V,arguments)}catch(K){return console.info("WebGL SDF generation failed, falling back to JS",K),m.apply(U,arguments)}}return r.forEachPathCommand=t,r.generate=ee,r.generateIntoCanvas=te,r.javascript=U,r.pathToLineSegments=e,r.webgl=V,r.webglUtils=d,Object.defineProperty(r,"__esModule",{value:!0}),r})({});return c}function _a(){var c=(function(r){var h={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},l={},t={};l.L=1,t[1]="L",Object.keys(h).forEach(function(H,ie){l[H]=1<<ie+1,t[l[H]]=H}),Object.freeze(l);var e=l.LRI|l.RLI|l.FSI,a=l.L|l.R|l.AL,o=l.B|l.S|l.WS|l.ON|l.FSI|l.LRI|l.RLI|l.PDI,n=l.BN|l.RLE|l.LRE|l.RLO|l.LRO|l.PDF,i=l.S|l.WS|l.B|e|l.PDI|n,s=null;function f(){if(!s){s=new Map;var H=function(re){if(h.hasOwnProperty(re)){var G=0;h[re].split(",").forEach(function(ye){var Q=ye.split("+"),ne=Q[0],Z=Q[1];ne=parseInt(ne,36),Z=Z?parseInt(Z,36):0,s.set(G+=ne,l[re]);for(var ke=0;ke<Z;ke++)s.set(++G,l[re])})}};for(var ie in h)H(ie)}}function u(H){return f(),s.get(H.codePointAt(0))||l.L}function d(H){return t[u(H)]}var g={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(H,ie){var re=36,G=0,ye=new Map,Q=ie&&new Map,ne;return H.split(",").forEach(function Z(ke){if(ke.indexOf("+")!==-1)for(var le=+ke;le--;)Z(ne);else{ne=ke;var fe=ke.split(">"),pe=fe[0],xe=fe[1];pe=String.fromCodePoint(G+=parseInt(pe,re)),xe=String.fromCodePoint(G+=parseInt(xe,re)),ye.set(pe,xe),ie&&Q.set(xe,pe)}}),{map:ye,reverseMap:Q}}var y,R,U;function E(){if(!y){var H=m(g.pairs,!0),ie=H.map,re=H.reverseMap;y=ie,R=re,U=m(g.canonical,!1).map}}function x(H){return E(),y.get(H)||null}function _(H){return E(),R.get(H)||null}function D(H){return E(),U.get(H)||null}var w=l.L,k=l.R,I=l.EN,T=l.ES,J=l.ET,b=l.AN,P=l.CS,F=l.B,Y=l.S,V=l.ON,ee=l.BN,te=l.NSM,N=l.AL,L=l.LRO,p=l.RLO,S=l.LRE,C=l.RLE,M=l.PDF,A=l.LRI,W=l.RLI,O=l.FSI,j=l.PDI;function K(H,ie){for(var re=125,G=new Uint32Array(H.length),ye=0;ye<H.length;ye++)G[ye]=u(H[ye]);var Q=new Map;function ne(je,Xe){var We=G[je];G[je]=Xe,Q.set(We,Q.get(We)-1),We&o&&Q.set(o,Q.get(o)-1),Q.set(Xe,(Q.get(Xe)||0)+1),Xe&o&&Q.set(o,(Q.get(o)||0)+1)}for(var Z=new Uint8Array(H.length),ke=new Map,le=[],fe=null,pe=0;pe<H.length;pe++)fe||le.push(fe={start:pe,end:H.length-1,level:ie==="rtl"?1:ie==="ltr"?0:$r(pe,!1)}),G[pe]&F&&(fe.end=pe,fe=null);for(var xe=C|S|p|L|e|j|M|F,De=function(je){return je+(je&1?1:2)},Fe=function(je){return je+(je&1?2:1)},Se=0;Se<le.length;Se++){fe=le[Se];var _e=[{_level:fe.level,_override:0,_isolate:0}],ce=void 0,v=0,B=0,ae=0;Q.clear();for(var ue=fe.start;ue<=fe.end;ue++){var $=G[ue];if(ce=_e[_e.length-1],Q.set($,(Q.get($)||0)+1),$&o&&Q.set(o,(Q.get(o)||0)+1),$&xe)if($&(C|S)){Z[ue]=ce._level;var Te=($===C?Fe:De)(ce._level);Te<=re&&!v&&!B?_e.push({_level:Te,_override:0,_isolate:0}):v||B++}else if($&(p|L)){Z[ue]=ce._level;var Ie=($===p?Fe:De)(ce._level);Ie<=re&&!v&&!B?_e.push({_level:Ie,_override:$&p?k:w,_isolate:0}):v||B++}else if($&e){$&O&&($=$r(ue+1,!0)===1?W:A),Z[ue]=ce._level,ce._override&&ne(ue,ce._override);var Ce=($===W?Fe:De)(ce._level);Ce<=re&&v===0&&B===0?(ae++,_e.push({_level:Ce,_override:0,_isolate:1,_isolInitIndex:ue})):v++}else if($&j){if(v>0)v--;else if(ae>0){for(B=0;!_e[_e.length-1]._isolate;)_e.pop();var Ue=_e[_e.length-1]._isolInitIndex;Ue!=null&&(ke.set(Ue,ue),ke.set(ue,Ue)),_e.pop(),ae--}ce=_e[_e.length-1],Z[ue]=ce._level,ce._override&&ne(ue,ce._override)}else $&M?(v===0&&(B>0?B--:!ce._isolate&&_e.length>1&&(_e.pop(),ce=_e[_e.length-1])),Z[ue]=ce._level):$&F&&(Z[ue]=fe.level);else Z[ue]=ce._level,ce._override&&$!==ee&&ne(ue,ce._override)}for(var Ee=[],we=null,me=fe.start;me<=fe.end;me++){var Ae=G[me];if(!(Ae&n)){var Pe=Z[me],Oe=Ae&e,Le=Ae===j;we&&Pe===we._level?(we._end=me,we._endsWithIsolInit=Oe):Ee.push(we={_start:me,_end:me,_level:Pe,_startsWithPDI:Le,_endsWithIsolInit:Oe})}}for(var He=[],qe=0;qe<Ee.length;qe++){var Ze=Ee[qe];if(!Ze._startsWithPDI||Ze._startsWithPDI&&!ke.has(Ze._start)){for(var $e=[we=Ze],rt=void 0;we&&we._endsWithIsolInit&&(rt=ke.get(we._end))!=null;)for(var Je=qe+1;Je<Ee.length;Je++)if(Ee[Je]._start===rt){$e.push(we=Ee[Je]);break}for(var Be=[],nt=0;nt<$e.length;nt++)for(var Pr=$e[nt],Qt=Pr._start;Qt<=Pr._end;Qt++)Be.push(Qt);for(var Rn=Z[Be[0]],Or=fe.level,Ct=Be[0]-1;Ct>=0;Ct--)if(!(G[Ct]&n)){Or=Z[Ct];break}var qt=Be[Be.length-1],In=Z[qt],Lr=fe.level;if(!(G[qt]&e)){for(var Ft=qt+1;Ft<=fe.end;Ft++)if(!(G[Ft]&n)){Lr=Z[Ft];break}}He.push({_seqIndices:Be,_sosType:Math.max(Or,Rn)%2?k:w,_eosType:Math.max(Lr,In)%2?k:w})}}for(var $t=0;$t<He.length;$t++){var er=He[$t],de=er._seqIndices,pt=er._sosType,Gn=er._eosType,it=Z[de[0]]&1?k:w;if(Q.get(te))for(var Mt=0;Mt<de.length;Mt++){var Rr=de[Mt];if(G[Rr]&te){for(var tr=pt,Pt=Mt-1;Pt>=0;Pt--)if(!(G[de[Pt]]&n)){tr=G[de[Pt]];break}ne(Rr,tr&(e|j)?V:tr)}}if(Q.get(I))for(var Ot=0;Ot<de.length;Ot++){var Ir=de[Ot];if(G[Ir]&I)for(var Lt=Ot-1;Lt>=-1;Lt--){var Gr=Lt===-1?pt:G[de[Lt]];if(Gr&a){Gr===N&&ne(Ir,b);break}}}if(Q.get(N))for(var rr=0;rr<de.length;rr++){var Br=de[rr];G[Br]&N&&ne(Br,k)}if(Q.get(T)||Q.get(P))for(var vt=1;vt<de.length-1;vt++){var nr=de[vt];if(G[nr]&(T|P)){for(var st=0,ar=0,or=vt-1;or>=0&&(st=G[de[or]],!!(st&n));or--);for(var ir=vt+1;ir<de.length&&(ar=G[de[ir]],!!(ar&n));ir++);st===ar&&(G[nr]===T?st===I:st&(I|b))&&ne(nr,st)}}if(Q.get(I))for(var Ke=0;Ke<de.length;Ke++){var Bn=de[Ke];if(G[Bn]&I){for(var Rt=Ke-1;Rt>=0&&G[de[Rt]]&(J|n);Rt--)ne(de[Rt],I);for(Ke++;Ke<de.length&&G[de[Ke]]&(J|n|I);Ke++)G[de[Ke]]!==I&&ne(de[Ke],I)}}if(Q.get(J)||Q.get(T)||Q.get(P))for(var gt=0;gt<de.length;gt++){var Nr=de[gt];if(G[Nr]&(J|T|P)){ne(Nr,V);for(var It=gt-1;It>=0&&G[de[It]]&n;It--)ne(de[It],V);for(var Gt=gt+1;Gt<de.length&&G[de[Gt]]&n;Gt++)ne(de[Gt],V)}}if(Q.get(I))for(var sr=0,jr=pt;sr<de.length;sr++){var Wr=de[sr],lr=G[Wr];lr&I?jr===w&&ne(Wr,w):lr&a&&(jr=lr)}if(Q.get(o)){var mt=k|I|b,zr=mt|w,Bt=[];{for(var lt=[],ft=0;ft<de.length;ft++)if(G[de[ft]]&o){var yt=H[de[ft]],Vr=void 0;if(x(yt)!==null)if(lt.length<63)lt.push({char:yt,seqIndex:ft});else break;else if((Vr=_(yt))!==null)for(var bt=lt.length-1;bt>=0;bt--){var fr=lt[bt].char;if(fr===Vr||fr===_(D(yt))||x(D(fr))===yt){Bt.push([lt[bt].seqIndex,ft]),lt.length=bt;break}}}Bt.sort(function(je,Xe){return je[0]-Xe[0]})}for(var ur=0;ur<Bt.length;ur++){for(var Hr=Bt[ur],Nt=Hr[0],cr=Hr[1],Yr=!1,Ye=0,hr=Nt+1;hr<cr;hr++){var Xr=de[hr];if(G[Xr]&zr){Yr=!0;var Kr=G[Xr]&mt?k:w;if(Kr===it){Ye=Kr;break}}}if(Yr&&!Ye){Ye=pt;for(var dr=Nt-1;dr>=0;dr--){var Zr=de[dr];if(G[Zr]&zr){var Jr=G[Zr]&mt?k:w;Jr!==it?Ye=Jr:Ye=it;break}}}if(Ye){if(G[de[Nt]]=G[de[cr]]=Ye,Ye!==it){for(var xt=Nt+1;xt<de.length;xt++)if(!(G[de[xt]]&n)){u(H[de[xt]])&te&&(G[de[xt]]=Ye);break}}if(Ye!==it){for(var _t=cr+1;_t<de.length;_t++)if(!(G[de[_t]]&n)){u(H[de[_t]])&te&&(G[de[_t]]=Ye);break}}}}for(var et=0;et<de.length;et++)if(G[de[et]]&o){for(var Qr=et,pr=et,vr=pt,St=et-1;St>=0;St--)if(G[de[St]]&n)Qr=St;else{vr=G[de[St]]&mt?k:w;break}for(var qr=Gn,Tt=et+1;Tt<de.length;Tt++)if(G[de[Tt]]&(o|n))pr=Tt;else{qr=G[de[Tt]]&mt?k:w;break}for(var gr=Qr;gr<=pr;gr++)G[de[gr]]=vr===qr?vr:it;et=pr}}}for(var Ve=fe.start;Ve<=fe.end;Ve++){var Nn=Z[Ve],jt=G[Ve];if(Nn&1?jt&(w|I|b)&&Z[Ve]++:jt&k?Z[Ve]++:jt&(b|I)&&(Z[Ve]+=2),jt&n&&(Z[Ve]=Ve===0?fe.level:Z[Ve-1]),Ve===fe.end||u(H[Ve])&(Y|F))for(var Wt=Ve;Wt>=0&&u(H[Wt])&i;Wt--)Z[Wt]=fe.level}}return{levels:Z,paragraphs:le};function $r(je,Xe){for(var We=je;We<H.length;We++){var tt=G[We];if(tt&(k|N))return 1;if(tt&(F|w)||Xe&&tt===j)return 0;if(tt&e){var en=jn(We);We=en===-1?H.length:en}}return 0}function jn(je){for(var Xe=1,We=je+1;We<H.length;We++){var tt=G[We];if(tt&F)break;if(tt&j){if(--Xe===0)return We}else tt&e&&Xe++}return-1}}var oe="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",X;function z(){if(!X){var H=m(oe,!0),ie=H.map,re=H.reverseMap;re.forEach(function(G,ye){ie.set(ye,G)}),X=ie}}function be(H){return z(),X.get(H)||null}function ge(H,ie,re,G){var ye=H.length;re=Math.max(0,re==null?0:+re),G=Math.min(ye-1,G==null?ye-1:+G);for(var Q=new Map,ne=re;ne<=G;ne++)if(ie[ne]&1){var Z=be(H[ne]);Z!==null&&Q.set(ne,Z)}return Q}function q(H,ie,re,G){var ye=H.length;re=Math.max(0,re==null?0:+re),G=Math.min(ye-1,G==null?ye-1:+G);var Q=[];return ie.paragraphs.forEach(function(ne){var Z=Math.max(re,ne.start),ke=Math.min(G,ne.end);if(Z<ke){for(var le=ie.levels.slice(Z,ke+1),fe=ke;fe>=Z&&u(H[fe])&i;fe--)le[fe]=ne.level;for(var pe=ne.level,xe=1/0,De=0;De<le.length;De++){var Fe=le[De];Fe>pe&&(pe=Fe),Fe<xe&&(xe=Fe|1)}for(var Se=pe;Se>=xe;Se--)for(var _e=0;_e<le.length;_e++)if(le[_e]>=Se){for(var ce=_e;_e+1<le.length&&le[_e+1]>=Se;)_e++;_e>ce&&Q.push([ce+Z,_e+Z])}}}),Q}function se(H,ie,re,G){var ye=he(H,ie,re,G),Q=[].concat(H);return ye.forEach(function(ne,Z){Q[Z]=(ie.levels[ne]&1?be(H[ne]):null)||H[ne]}),Q.join("")}function he(H,ie,re,G){for(var ye=q(H,ie,re,G),Q=[],ne=0;ne<H.length;ne++)Q[ne]=ne;return ye.forEach(function(Z){for(var ke=Z[0],le=Z[1],fe=Q.slice(ke,le+1),pe=fe.length;pe--;)Q[le-pe]=fe[pe]}),Q}return r.closingToOpeningBracket=_,r.getBidiCharType=u,r.getBidiCharTypeName=d,r.getCanonicalBracket=D,r.getEmbeddingLevels=K,r.getMirroredCharacter=be,r.getMirroredCharactersMap=ge,r.getReorderSegments=q,r.getReorderedIndices=he,r.getReorderedString=se,r.openingToClosingBracket=x,Object.defineProperty(r,"__esModule",{value:!0}),r})({});return c}const kn=/\bvoid\s+main\s*\(\s*\)\s*{/g;function wr(c){const r=/^[ \t]*#include +<([\w\d./]+)>/gm;function h(l,t){let e=Kn[t];return e?wr(e):l}return c.replace(r,h)}const Ge=[];for(let c=0;c<256;c++)Ge[c]=(c<16?"0":"")+c.toString(16);function Sa(){const c=Math.random()*4294967295|0,r=Math.random()*4294967295|0,h=Math.random()*4294967295|0,l=Math.random()*4294967295|0;return(Ge[c&255]+Ge[c>>8&255]+Ge[c>>16&255]+Ge[c>>24&255]+"-"+Ge[r&255]+Ge[r>>8&255]+"-"+Ge[r>>16&15|64]+Ge[r>>24&255]+"-"+Ge[h&63|128]+Ge[h>>8&255]+"-"+Ge[h>>16&255]+Ge[h>>24&255]+Ge[l&255]+Ge[l>>8&255]+Ge[l>>16&255]+Ge[l>>24&255]).toUpperCase()}const at=Object.assign||function(){let c=arguments[0];for(let r=1,h=arguments.length;r<h;r++){let l=arguments[r];if(l)for(let t in l)Object.prototype.hasOwnProperty.call(l,t)&&(c[t]=l[t])}return c},Ta=Date.now(),un=new WeakMap,cn=new Map;let Ua=1e10;function kr(c,r){const h=Aa(r);let l=un.get(c);if(l||un.set(c,l=Object.create(null)),l[h])return new l[h];const t=`_onBeforeCompile${h}`,e=function(i,s){c.onBeforeCompile.call(this,i,s);const f=this.customProgramCacheKey()+"|"+i.vertexShader+"|"+i.fragmentShader;let u=cn[f];if(!u){const d=wa(this,i,r,h);u=cn[f]=d}i.vertexShader=u.vertexShader,i.fragmentShader=u.fragmentShader,at(i.uniforms,this.uniforms),r.timeUniform&&(i.uniforms[r.timeUniform]={get value(){return Date.now()-Ta}}),this[t]&&this[t](i)},a=function(){return o(r.chained?c:c.clone())},o=function(i){const s=Object.create(i,n);return Object.defineProperty(s,"baseMaterial",{value:c}),Object.defineProperty(s,"id",{value:Ua++}),s.uuid=Sa(),s.uniforms=at({},i.uniforms,r.uniforms),s.defines=at({},i.defines,r.defines),s.defines[`TROIKA_DERIVED_MATERIAL_${h}`]="",s.extensions=at({},i.extensions,r.extensions),s._listeners=void 0,s},n={constructor:{value:a},isDerivedMaterial:{value:!0},type:{get:()=>c.type,set:i=>{c.type=i}},isDerivedFrom:{writable:!0,configurable:!0,value:function(i){const s=this.baseMaterial;return i===s||s.isDerivedMaterial&&s.isDerivedFrom(i)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return c.customProgramCacheKey()+"|"+h}},onBeforeCompile:{get(){return e},set(i){this[t]=i}},copy:{writable:!0,configurable:!0,value:function(i){return c.copy.call(this,i),!c.isShaderMaterial&&!c.isDerivedMaterial&&(at(this.extensions,i.extensions),at(this.defines,i.defines),at(this.uniforms,Xn.clone(i.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const i=new c.constructor;return o(i).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let i=this._depthMaterial;return i||(i=this._depthMaterial=kr(c.isDerivedMaterial?c.getDepthMaterial():new Hn({depthPacking:Yn}),r),i.defines.IS_DEPTH_MATERIAL="",i.uniforms=this.uniforms),i}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let i=this._distanceMaterial;return i||(i=this._distanceMaterial=kr(c.isDerivedMaterial?c.getDistanceMaterial():new Vn,r),i.defines.IS_DISTANCE_MATERIAL="",i.uniforms=this.uniforms),i}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:i,_distanceMaterial:s}=this;i&&i.dispose(),s&&s.dispose(),c.dispose.call(this)}}};return l[h]=a,new a}function wa(c,{vertexShader:r,fragmentShader:h},l,t){let{vertexDefs:e,vertexMainIntro:a,vertexMainOutro:o,vertexTransform:n,fragmentDefs:i,fragmentMainIntro:s,fragmentMainOutro:f,fragmentColorTransform:u,customRewriter:d,timeUniform:g}=l;if(e=e||"",a=a||"",o=o||"",i=i||"",s=s||"",f=f||"",(n||d)&&(r=wr(r)),(u||d)&&(h=h.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),h=wr(h)),d){let m=d({vertexShader:r,fragmentShader:h});r=m.vertexShader,h=m.fragmentShader}if(u){let m=[];h=h.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,y=>(m.push(y),"")),f=`${u}
${m.join(`
`)}
${f}`}if(g){const m=`
uniform float ${g};
`;e=m+e,i=m+i}return n&&(r=`vec3 troika_position_${t};
vec3 troika_normal_${t};
vec2 troika_uv_${t};
${r}
`,e=`${e}
void troikaVertexTransform${t}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${n}
}
`,a=`
troika_position_${t} = vec3(position);
troika_normal_${t} = vec3(normal);
troika_uv_${t} = vec2(uv);
troikaVertexTransform${t}(troika_position_${t}, troika_normal_${t}, troika_uv_${t});
${a}
`,r=r.replace(/\b(position|normal|uv)\b/g,(m,y,R,U)=>/\battribute\s+vec[23]\s+$/.test(U.substr(0,R))?y:`troika_${y}_${t}`),c.map&&c.map.channel>0||(r=r.replace(/\bMAP_UV\b/g,`troika_uv_${t}`))),r=hn(r,t,e,a,o),h=hn(h,t,i,s,f),{vertexShader:r,fragmentShader:h}}function hn(c,r,h,l,t){return(l||t||h)&&(c=c.replace(kn,`
${h}
void troikaOrigMain${r}() {`),c+=`
void main() {
  ${l}
  troikaOrigMain${r}();
  ${t}
}`),c}function ka(c,r){return c==="uniforms"?void 0:typeof r=="function"?r.toString():r}let Ea=0;const dn=new Map;function Aa(c){const r=JSON.stringify(c,ka);let h=dn.get(r);return h==null&&dn.set(r,h=++Ea),h}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function Da(){return typeof window>"u"&&(self.window=self),(function(c){var r={parse:function(t){var e=r._bin,a=new Uint8Array(t);if(e.readASCII(a,0,4)=="ttcf"){var o=4;e.readUshort(a,o),o+=2,e.readUshort(a,o),o+=2;var n=e.readUint(a,o);o+=4;for(var i=[],s=0;s<n;s++){var f=e.readUint(a,o);o+=4,i.push(r._readFont(a,f))}return i}return[r._readFont(a,0)]},_readFont:function(t,e){var a=r._bin,o=e;a.readFixed(t,e),e+=4;var n=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2;for(var i=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],s={_data:t,_offset:o},f={},u=0;u<n;u++){var d=a.readASCII(t,e,4);e+=4,a.readUint(t,e),e+=4;var g=a.readUint(t,e);e+=4;var m=a.readUint(t,e);e+=4,f[d]={offset:g,length:m}}for(u=0;u<i.length;u++){var y=i[u];f[y]&&(s[y.trim()]=r[y.trim()].parse(t,f[y].offset,f[y].length,s))}return s},_tabOffset:function(t,e,a){for(var o=r._bin,n=o.readUshort(t,a+4),i=a+12,s=0;s<n;s++){var f=o.readASCII(t,i,4);i+=4,o.readUint(t,i),i+=4;var u=o.readUint(t,i);if(i+=4,o.readUint(t,i),i+=4,f==e)return u}return 0}};r._bin={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,e){return r._bin.readShort(t,e)/16384},readInt:function(t,e){return r._bin._view(t).getInt32(e)},readInt8:function(t,e){return r._bin._view(t).getInt8(e)},readShort:function(t,e){return r._bin._view(t).getInt16(e)},readUshort:function(t,e){return r._bin._view(t).getUint16(e)},readUshorts:function(t,e,a){for(var o=[],n=0;n<a;n++)o.push(r._bin.readUshort(t,e+2*n));return o},readUint:function(t,e){return r._bin._view(t).getUint32(e)},readUint64:function(t,e){return 4294967296*r._bin.readUint(t,e)+r._bin.readUint(t,e+4)},readASCII:function(t,e,a){for(var o="",n=0;n<a;n++)o+=String.fromCharCode(t[e+n]);return o},readUnicode:function(t,e,a){for(var o="",n=0;n<a;n++){var i=t[e++]<<8|t[e++];o+=String.fromCharCode(i)}return o},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(t,e,a){var o=r._bin._tdec;return o&&e==0&&a==t.length?o.decode(t):r._bin.readASCII(t,e,a)},readBytes:function(t,e,a){for(var o=[],n=0;n<a;n++)o.push(t[e+n]);return o},readASCIIArray:function(t,e,a){for(var o=[],n=0;n<a;n++)o.push(String.fromCharCode(t[e+n]));return o},_view:function(t){return t._dataView||(t._dataView=t.buffer?new DataView(t.buffer,t.byteOffset,t.byteLength):new DataView(new Uint8Array(t).buffer))}},r._lctf={},r._lctf.parse=function(t,e,a,o,n){var i=r._bin,s={},f=e;i.readFixed(t,e),e+=4;var u=i.readUshort(t,e);e+=2;var d=i.readUshort(t,e);e+=2;var g=i.readUshort(t,e);return e+=2,s.scriptList=r._lctf.readScriptList(t,f+u),s.featureList=r._lctf.readFeatureList(t,f+d),s.lookupList=r._lctf.readLookupList(t,f+g,n),s},r._lctf.readLookupList=function(t,e,a){var o=r._bin,n=e,i=[],s=o.readUshort(t,e);e+=2;for(var f=0;f<s;f++){var u=o.readUshort(t,e);e+=2;var d=r._lctf.readLookupTable(t,n+u,a);i.push(d)}return i},r._lctf.readLookupTable=function(t,e,a){var o=r._bin,n=e,i={tabs:[]};i.ltype=o.readUshort(t,e),e+=2,i.flag=o.readUshort(t,e),e+=2;var s=o.readUshort(t,e);e+=2;for(var f=i.ltype,u=0;u<s;u++){var d=o.readUshort(t,e);e+=2;var g=a(t,f,n+d,i);i.tabs.push(g)}return i},r._lctf.numOfOnes=function(t){for(var e=0,a=0;a<32;a++)(t>>>a&1)!=0&&e++;return e},r._lctf.readClassDef=function(t,e){var a=r._bin,o=[],n=a.readUshort(t,e);if(e+=2,n==1){var i=a.readUshort(t,e);e+=2;var s=a.readUshort(t,e);e+=2;for(var f=0;f<s;f++)o.push(i+f),o.push(i+f),o.push(a.readUshort(t,e)),e+=2}if(n==2){var u=a.readUshort(t,e);for(e+=2,f=0;f<u;f++)o.push(a.readUshort(t,e)),e+=2,o.push(a.readUshort(t,e)),e+=2,o.push(a.readUshort(t,e)),e+=2}return o},r._lctf.getInterval=function(t,e){for(var a=0;a<t.length;a+=3){var o=t[a],n=t[a+1];if(t[a+2],o<=e&&e<=n)return a}return-1},r._lctf.readCoverage=function(t,e){var a=r._bin,o={};o.fmt=a.readUshort(t,e),e+=2;var n=a.readUshort(t,e);return e+=2,o.fmt==1&&(o.tab=a.readUshorts(t,e,n)),o.fmt==2&&(o.tab=a.readUshorts(t,e,3*n)),o},r._lctf.coverageIndex=function(t,e){var a=t.tab;if(t.fmt==1)return a.indexOf(e);if(t.fmt==2){var o=r._lctf.getInterval(a,e);if(o!=-1)return a[o+2]+(e-a[o])}return-1},r._lctf.readFeatureList=function(t,e){var a=r._bin,o=e,n=[],i=a.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var f=a.readASCII(t,e,4);e+=4;var u=a.readUshort(t,e);e+=2;var d=r._lctf.readFeatureTable(t,o+u);d.tag=f.trim(),n.push(d)}return n},r._lctf.readFeatureTable=function(t,e){var a=r._bin,o=e,n={},i=a.readUshort(t,e);e+=2,i>0&&(n.featureParams=o+i);var s=a.readUshort(t,e);e+=2,n.tab=[];for(var f=0;f<s;f++)n.tab.push(a.readUshort(t,e+2*f));return n},r._lctf.readScriptList=function(t,e){var a=r._bin,o=e,n={},i=a.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var f=a.readASCII(t,e,4);e+=4;var u=a.readUshort(t,e);e+=2,n[f.trim()]=r._lctf.readScriptTable(t,o+u)}return n},r._lctf.readScriptTable=function(t,e){var a=r._bin,o=e,n={},i=a.readUshort(t,e);e+=2,i>0&&(n.default=r._lctf.readLangSysTable(t,o+i));var s=a.readUshort(t,e);e+=2;for(var f=0;f<s;f++){var u=a.readASCII(t,e,4);e+=4;var d=a.readUshort(t,e);e+=2,n[u.trim()]=r._lctf.readLangSysTable(t,o+d)}return n},r._lctf.readLangSysTable=function(t,e){var a=r._bin,o={};a.readUshort(t,e),e+=2,o.reqFeature=a.readUshort(t,e),e+=2;var n=a.readUshort(t,e);return e+=2,o.features=a.readUshorts(t,e,n),o},r.CFF={},r.CFF.parse=function(t,e,a){var o=r._bin;(t=new Uint8Array(t.buffer,e,a))[e=0],t[++e],t[++e],t[++e],e++;var n=[];e=r.CFF.readIndex(t,e,n);for(var i=[],s=0;s<n.length-1;s++)i.push(o.readASCII(t,e+n[s],n[s+1]-n[s]));e+=n[n.length-1];var f=[];e=r.CFF.readIndex(t,e,f);var u=[];for(s=0;s<f.length-1;s++)u.push(r.CFF.readDict(t,e+f[s],e+f[s+1]));e+=f[f.length-1];var d=u[0],g=[];e=r.CFF.readIndex(t,e,g);var m=[];for(s=0;s<g.length-1;s++)m.push(o.readASCII(t,e+g[s],g[s+1]-g[s]));if(e+=g[g.length-1],r.CFF.readSubrs(t,e,d),d.CharStrings){e=d.CharStrings,g=[],e=r.CFF.readIndex(t,e,g);var y=[];for(s=0;s<g.length-1;s++)y.push(o.readBytes(t,e+g[s],g[s+1]-g[s]));d.CharStrings=y}if(d.ROS){e=d.FDArray;var R=[];for(e=r.CFF.readIndex(t,e,R),d.FDArray=[],s=0;s<R.length-1;s++){var U=r.CFF.readDict(t,e+R[s],e+R[s+1]);r.CFF._readFDict(t,U,m),d.FDArray.push(U)}e+=R[R.length-1],e=d.FDSelect,d.FDSelect=[];var E=t[e];if(e++,E!=3)throw E;var x=o.readUshort(t,e);for(e+=2,s=0;s<x+1;s++)d.FDSelect.push(o.readUshort(t,e),t[e+2]),e+=3}return d.Encoding&&(d.Encoding=r.CFF.readEncoding(t,d.Encoding,d.CharStrings.length)),d.charset&&(d.charset=r.CFF.readCharset(t,d.charset,d.CharStrings.length)),r.CFF._readFDict(t,d,m),d},r.CFF._readFDict=function(t,e,a){var o;for(var n in e.Private&&(o=e.Private[1],e.Private=r.CFF.readDict(t,o,o+e.Private[0]),e.Private.Subrs&&r.CFF.readSubrs(t,o+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(n)!=-1&&(e[n]=a[e[n]-426+35])},r.CFF.readSubrs=function(t,e,a){var o=r._bin,n=[];e=r.CFF.readIndex(t,e,n);var i,s=n.length;i=s<1240?107:s<33900?1131:32768,a.Bias=i,a.Subrs=[];for(var f=0;f<n.length-1;f++)a.Subrs.push(o.readBytes(t,e+n[f],n[f+1]-n[f]))},r.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],r.CFF.glyphByUnicode=function(t,e){for(var a=0;a<t.charset.length;a++)if(t.charset[a]==e)return a;return-1},r.CFF.glyphBySE=function(t,e){return e<0||e>255?-1:r.CFF.glyphByUnicode(t,r.CFF.tableSE[e])},r.CFF.readEncoding=function(t,e,a){r._bin;var o=[".notdef"],n=t[e];if(e++,n!=0)throw"error: unknown encoding format: "+n;var i=t[e];e++;for(var s=0;s<i;s++)o.push(t[e+s]);return o},r.CFF.readCharset=function(t,e,a){var o=r._bin,n=[".notdef"],i=t[e];if(e++,i==0)for(var s=0;s<a;s++){var f=o.readUshort(t,e);e+=2,n.push(f)}else{if(i!=1&&i!=2)throw"error: format: "+i;for(;n.length<a;){f=o.readUshort(t,e),e+=2;var u=0;for(i==1?(u=t[e],e++):(u=o.readUshort(t,e),e+=2),s=0;s<=u;s++)n.push(f),f++}}return n},r.CFF.readIndex=function(t,e,a){var o=r._bin,n=o.readUshort(t,e)+1,i=t[e+=2];if(e++,i==1)for(var s=0;s<n;s++)a.push(t[e+s]);else if(i==2)for(s=0;s<n;s++)a.push(o.readUshort(t,e+2*s));else if(i==3)for(s=0;s<n;s++)a.push(16777215&o.readUint(t,e+3*s-1));else if(n!=1)throw"unsupported offset size: "+i+", count: "+n;return(e+=n*i)-1},r.CFF.getCharString=function(t,e,a){var o=r._bin,n=t[e],i=t[e+1];t[e+2],t[e+3],t[e+4];var s=1,f=null,u=null;n<=20&&(f=n,s=1),n==12&&(f=100*n+i,s=2),21<=n&&n<=27&&(f=n,s=1),n==28&&(u=o.readShort(t,e+1),s=3),29<=n&&n<=31&&(f=n,s=1),32<=n&&n<=246&&(u=n-139,s=1),247<=n&&n<=250&&(u=256*(n-247)+i+108,s=2),251<=n&&n<=254&&(u=256*-(n-251)-i-108,s=2),n==255&&(u=o.readInt(t,e+1)/65535,s=5),a.val=u??"o"+f,a.size=s},r.CFF.readCharString=function(t,e,a){for(var o=e+a,n=r._bin,i=[];e<o;){var s=t[e],f=t[e+1];t[e+2],t[e+3],t[e+4];var u=1,d=null,g=null;s<=20&&(d=s,u=1),s==12&&(d=100*s+f,u=2),s!=19&&s!=20||(d=s,u=2),21<=s&&s<=27&&(d=s,u=1),s==28&&(g=n.readShort(t,e+1),u=3),29<=s&&s<=31&&(d=s,u=1),32<=s&&s<=246&&(g=s-139,u=1),247<=s&&s<=250&&(g=256*(s-247)+f+108,u=2),251<=s&&s<=254&&(g=256*-(s-251)-f-108,u=2),s==255&&(g=n.readInt(t,e+1)/65535,u=5),i.push(g??"o"+d),e+=u}return i},r.CFF.readDict=function(t,e,a){for(var o=r._bin,n={},i=[];e<a;){var s=t[e],f=t[e+1];t[e+2],t[e+3],t[e+4];var u=1,d=null,g=null;if(s==28&&(g=o.readShort(t,e+1),u=3),s==29&&(g=o.readInt(t,e+1),u=5),32<=s&&s<=246&&(g=s-139,u=1),247<=s&&s<=250&&(g=256*(s-247)+f+108,u=2),251<=s&&s<=254&&(g=256*-(s-251)-f-108,u=2),s==255)throw g=o.readInt(t,e+1)/65535,u=5,"unknown number";if(s==30){var m=[];for(u=1;;){var y=t[e+u];u++;var R=y>>4,U=15&y;if(R!=15&&m.push(R),U!=15&&m.push(U),U==15)break}for(var E="",x=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],_=0;_<m.length;_++)E+=x[m[_]];g=parseFloat(E)}s<=21&&(d=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],u=1,s==12&&(d=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][f],u=2)),d!=null?(n[d]=i.length==1?i[0]:i,i=[]):i.push(g),e+=u}return n},r.cmap={},r.cmap.parse=function(t,e,a){t=new Uint8Array(t.buffer,e,a),e=0;var o=r._bin,n={};o.readUshort(t,e),e+=2;var i=o.readUshort(t,e);e+=2;var s=[];n.tables=[];for(var f=0;f<i;f++){var u=o.readUshort(t,e);e+=2;var d=o.readUshort(t,e);e+=2;var g=o.readUint(t,e);e+=4;var m="p"+u+"e"+d,y=s.indexOf(g);if(y==-1){var R;y=n.tables.length,s.push(g);var U=o.readUshort(t,g);U==0?R=r.cmap.parse0(t,g):U==4?R=r.cmap.parse4(t,g):U==6?R=r.cmap.parse6(t,g):U==12?R=r.cmap.parse12(t,g):console.debug("unknown format: "+U,u,d,g),n.tables.push(R)}if(n[m]!=null)throw"multiple tables for one platform+encoding";n[m]=y}return n},r.cmap.parse0=function(t,e){var a=r._bin,o={};o.format=a.readUshort(t,e),e+=2;var n=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2,o.map=[];for(var i=0;i<n-6;i++)o.map.push(t[e+i]);return o},r.cmap.parse4=function(t,e){var a=r._bin,o=e,n={};n.format=a.readUshort(t,e),e+=2;var i=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2;var s=a.readUshort(t,e);e+=2;var f=s/2;n.searchRange=a.readUshort(t,e),e+=2,n.entrySelector=a.readUshort(t,e),e+=2,n.rangeShift=a.readUshort(t,e),e+=2,n.endCount=a.readUshorts(t,e,f),e+=2*f,e+=2,n.startCount=a.readUshorts(t,e,f),e+=2*f,n.idDelta=[];for(var u=0;u<f;u++)n.idDelta.push(a.readShort(t,e)),e+=2;for(n.idRangeOffset=a.readUshorts(t,e,f),e+=2*f,n.glyphIdArray=[];e<o+i;)n.glyphIdArray.push(a.readUshort(t,e)),e+=2;return n},r.cmap.parse6=function(t,e){var a=r._bin,o={};o.format=a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,o.firstCode=a.readUshort(t,e),e+=2;var n=a.readUshort(t,e);e+=2,o.glyphIdArray=[];for(var i=0;i<n;i++)o.glyphIdArray.push(a.readUshort(t,e)),e+=2;return o},r.cmap.parse12=function(t,e){var a=r._bin,o={};o.format=a.readUshort(t,e),e+=2,e+=2,a.readUint(t,e),e+=4,a.readUint(t,e),e+=4;var n=a.readUint(t,e);e+=4,o.groups=[];for(var i=0;i<n;i++){var s=e+12*i,f=a.readUint(t,s+0),u=a.readUint(t,s+4),d=a.readUint(t,s+8);o.groups.push([f,u,d])}return o},r.glyf={},r.glyf.parse=function(t,e,a,o){for(var n=[],i=0;i<o.maxp.numGlyphs;i++)n.push(null);return n},r.glyf._parseGlyf=function(t,e){var a=r._bin,o=t._data,n=r._tabOffset(o,"glyf",t._offset)+t.loca[e];if(t.loca[e]==t.loca[e+1])return null;var i={};if(i.noc=a.readShort(o,n),n+=2,i.xMin=a.readShort(o,n),n+=2,i.yMin=a.readShort(o,n),n+=2,i.xMax=a.readShort(o,n),n+=2,i.yMax=a.readShort(o,n),n+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var s=0;s<i.noc;s++)i.endPts.push(a.readUshort(o,n)),n+=2;var f=a.readUshort(o,n);if(n+=2,o.length-n<f)return null;i.instructions=a.readBytes(o,n,f),n+=f;var u=i.endPts[i.noc-1]+1;for(i.flags=[],s=0;s<u;s++){var d=o[n];if(n++,i.flags.push(d),(8&d)!=0){var g=o[n];n++;for(var m=0;m<g;m++)i.flags.push(d),s++}}for(i.xs=[],s=0;s<u;s++){var y=(2&i.flags[s])!=0,R=(16&i.flags[s])!=0;y?(i.xs.push(R?o[n]:-o[n]),n++):R?i.xs.push(0):(i.xs.push(a.readShort(o,n)),n+=2)}for(i.ys=[],s=0;s<u;s++)y=(4&i.flags[s])!=0,R=(32&i.flags[s])!=0,y?(i.ys.push(R?o[n]:-o[n]),n++):R?i.ys.push(0):(i.ys.push(a.readShort(o,n)),n+=2);var U=0,E=0;for(s=0;s<u;s++)U+=i.xs[s],E+=i.ys[s],i.xs[s]=U,i.ys[s]=E}else{var x;i.parts=[];do{x=a.readUshort(o,n),n+=2;var _={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(_),_.glyphIndex=a.readUshort(o,n),n+=2,1&x){var D=a.readShort(o,n);n+=2;var w=a.readShort(o,n);n+=2}else D=a.readInt8(o,n),n++,w=a.readInt8(o,n),n++;2&x?(_.m.tx=D,_.m.ty=w):(_.p1=D,_.p2=w),8&x?(_.m.a=_.m.d=a.readF2dot14(o,n),n+=2):64&x?(_.m.a=a.readF2dot14(o,n),n+=2,_.m.d=a.readF2dot14(o,n),n+=2):128&x&&(_.m.a=a.readF2dot14(o,n),n+=2,_.m.b=a.readF2dot14(o,n),n+=2,_.m.c=a.readF2dot14(o,n),n+=2,_.m.d=a.readF2dot14(o,n),n+=2)}while(32&x);if(256&x){var k=a.readUshort(o,n);for(n+=2,i.instr=[],s=0;s<k;s++)i.instr.push(o[n]),n++}}return i},r.GDEF={},r.GDEF.parse=function(t,e,a,o){var n=e;e+=4;var i=r._bin.readUshort(t,e);return{glyphClassDef:i===0?null:r._lctf.readClassDef(t,n+i)}},r.GPOS={},r.GPOS.parse=function(t,e,a,o){return r._lctf.parse(t,e,a,o,r.GPOS.subt)},r.GPOS.subt=function(t,e,a,o){var n=r._bin,i=a,s={};if(s.fmt=n.readUshort(t,a),a+=2,e==1||e==2||e==3||e==7||e==8&&s.fmt<=2){var f=n.readUshort(t,a);a+=2,s.coverage=r._lctf.readCoverage(t,f+i)}if(e==1&&s.fmt==1){var u=n.readUshort(t,a);a+=2,u!=0&&(s.pos=r.GPOS.readValueRecord(t,a,u))}else if(e==2&&s.fmt>=1&&s.fmt<=2){u=n.readUshort(t,a),a+=2;var d=n.readUshort(t,a);a+=2;var g=r._lctf.numOfOnes(u),m=r._lctf.numOfOnes(d);if(s.fmt==1){s.pairsets=[];var y=n.readUshort(t,a);a+=2;for(var R=0;R<y;R++){var U=i+n.readUshort(t,a);a+=2;var E=n.readUshort(t,U);U+=2;for(var x=[],_=0;_<E;_++){var D=n.readUshort(t,U);U+=2,u!=0&&(b=r.GPOS.readValueRecord(t,U,u),U+=2*g),d!=0&&(P=r.GPOS.readValueRecord(t,U,d),U+=2*m),x.push({gid2:D,val1:b,val2:P})}s.pairsets.push(x)}}if(s.fmt==2){var w=n.readUshort(t,a);a+=2;var k=n.readUshort(t,a);a+=2;var I=n.readUshort(t,a);a+=2;var T=n.readUshort(t,a);for(a+=2,s.classDef1=r._lctf.readClassDef(t,i+w),s.classDef2=r._lctf.readClassDef(t,i+k),s.matrix=[],R=0;R<I;R++){var J=[];for(_=0;_<T;_++){var b=null,P=null;u!=0&&(b=r.GPOS.readValueRecord(t,a,u),a+=2*g),d!=0&&(P=r.GPOS.readValueRecord(t,a,d),a+=2*m),J.push({val1:b,val2:P})}s.matrix.push(J)}}}else if(e==4&&s.fmt==1)s.markCoverage=r._lctf.readCoverage(t,n.readUshort(t,a)+i),s.baseCoverage=r._lctf.readCoverage(t,n.readUshort(t,a+2)+i),s.markClassCount=n.readUshort(t,a+4),s.markArray=r.GPOS.readMarkArray(t,n.readUshort(t,a+6)+i),s.baseArray=r.GPOS.readBaseArray(t,n.readUshort(t,a+8)+i,s.markClassCount);else if(e==6&&s.fmt==1)s.mark1Coverage=r._lctf.readCoverage(t,n.readUshort(t,a)+i),s.mark2Coverage=r._lctf.readCoverage(t,n.readUshort(t,a+2)+i),s.markClassCount=n.readUshort(t,a+4),s.mark1Array=r.GPOS.readMarkArray(t,n.readUshort(t,a+6)+i),s.mark2Array=r.GPOS.readBaseArray(t,n.readUshort(t,a+8)+i,s.markClassCount);else{if(e==9&&s.fmt==1){var F=n.readUshort(t,a);a+=2;var Y=n.readUint(t,a);if(a+=4,o.ltype==9)o.ltype=F;else if(o.ltype!=F)throw"invalid extension substitution";return r.GPOS.subt(t,o.ltype,i+Y)}console.debug("unsupported GPOS table LookupType",e,"format",s.fmt)}return s},r.GPOS.readValueRecord=function(t,e,a){var o=r._bin,n=[];return n.push(1&a?o.readShort(t,e):0),e+=1&a?2:0,n.push(2&a?o.readShort(t,e):0),e+=2&a?2:0,n.push(4&a?o.readShort(t,e):0),e+=4&a?2:0,n.push(8&a?o.readShort(t,e):0),e+=8&a?2:0,n},r.GPOS.readBaseArray=function(t,e,a){var o=r._bin,n=[],i=e,s=o.readUshort(t,e);e+=2;for(var f=0;f<s;f++){for(var u=[],d=0;d<a;d++)u.push(r.GPOS.readAnchorRecord(t,i+o.readUshort(t,e))),e+=2;n.push(u)}return n},r.GPOS.readMarkArray=function(t,e){var a=r._bin,o=[],n=e,i=a.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var f=r.GPOS.readAnchorRecord(t,a.readUshort(t,e+2)+n);f.markClass=a.readUshort(t,e),o.push(f),e+=4}return o},r.GPOS.readAnchorRecord=function(t,e){var a=r._bin,o={};return o.fmt=a.readUshort(t,e),o.x=a.readShort(t,e+2),o.y=a.readShort(t,e+4),o},r.GSUB={},r.GSUB.parse=function(t,e,a,o){return r._lctf.parse(t,e,a,o,r.GSUB.subt)},r.GSUB.subt=function(t,e,a,o){var n=r._bin,i=a,s={};if(s.fmt=n.readUshort(t,a),a+=2,e!=1&&e!=2&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==2||e==4||e==5&&s.fmt<=2||e==6&&s.fmt<=2){var f=n.readUshort(t,a);a+=2,s.coverage=r._lctf.readCoverage(t,i+f)}if(e==1&&s.fmt>=1&&s.fmt<=2){if(s.fmt==1)s.delta=n.readShort(t,a),a+=2;else if(s.fmt==2){var u=n.readUshort(t,a);a+=2,s.newg=n.readUshorts(t,a,u),a+=2*s.newg.length}}else if(e==2&&s.fmt==1){u=n.readUshort(t,a),a+=2,s.seqs=[];for(var d=0;d<u;d++){var g=n.readUshort(t,a)+i;a+=2;var m=n.readUshort(t,g);s.seqs.push(n.readUshorts(t,g+2,m))}}else if(e==4)for(s.vals=[],u=n.readUshort(t,a),a+=2,d=0;d<u;d++){var y=n.readUshort(t,a);a+=2,s.vals.push(r.GSUB.readLigatureSet(t,i+y))}else if(e==5&&s.fmt==2){if(s.fmt==2){var R=n.readUshort(t,a);a+=2,s.cDef=r._lctf.readClassDef(t,i+R),s.scset=[];var U=n.readUshort(t,a);for(a+=2,d=0;d<U;d++){var E=n.readUshort(t,a);a+=2,s.scset.push(E==0?null:r.GSUB.readSubClassSet(t,i+E))}}}else if(e==6&&s.fmt==3){if(s.fmt==3){for(d=0;d<3;d++){u=n.readUshort(t,a),a+=2;for(var x=[],_=0;_<u;_++)x.push(r._lctf.readCoverage(t,i+n.readUshort(t,a+2*_)));a+=2*u,d==0&&(s.backCvg=x),d==1&&(s.inptCvg=x),d==2&&(s.ahedCvg=x)}u=n.readUshort(t,a),a+=2,s.lookupRec=r.GSUB.readSubstLookupRecords(t,a,u)}}else{if(e==7&&s.fmt==1){var D=n.readUshort(t,a);a+=2;var w=n.readUint(t,a);if(a+=4,o.ltype==9)o.ltype=D;else if(o.ltype!=D)throw"invalid extension substitution";return r.GSUB.subt(t,o.ltype,i+w)}console.debug("unsupported GSUB table LookupType",e,"format",s.fmt)}return s},r.GSUB.readSubClassSet=function(t,e){var a=r._bin.readUshort,o=e,n=[],i=a(t,e);e+=2;for(var s=0;s<i;s++){var f=a(t,e);e+=2,n.push(r.GSUB.readSubClassRule(t,o+f))}return n},r.GSUB.readSubClassRule=function(t,e){var a=r._bin.readUshort,o={},n=a(t,e),i=a(t,e+=2);e+=2,o.input=[];for(var s=0;s<n-1;s++)o.input.push(a(t,e)),e+=2;return o.substLookupRecords=r.GSUB.readSubstLookupRecords(t,e,i),o},r.GSUB.readSubstLookupRecords=function(t,e,a){for(var o=r._bin.readUshort,n=[],i=0;i<a;i++)n.push(o(t,e),o(t,e+2)),e+=4;return n},r.GSUB.readChainSubClassSet=function(t,e){var a=r._bin,o=e,n=[],i=a.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var f=a.readUshort(t,e);e+=2,n.push(r.GSUB.readChainSubClassRule(t,o+f))}return n},r.GSUB.readChainSubClassRule=function(t,e){for(var a=r._bin,o={},n=["backtrack","input","lookahead"],i=0;i<n.length;i++){var s=a.readUshort(t,e);e+=2,i==1&&s--,o[n[i]]=a.readUshorts(t,e,s),e+=2*o[n[i]].length}return s=a.readUshort(t,e),e+=2,o.subst=a.readUshorts(t,e,2*s),e+=2*o.subst.length,o},r.GSUB.readLigatureSet=function(t,e){var a=r._bin,o=e,n=[],i=a.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var f=a.readUshort(t,e);e+=2,n.push(r.GSUB.readLigature(t,o+f))}return n},r.GSUB.readLigature=function(t,e){var a=r._bin,o={chain:[]};o.nglyph=a.readUshort(t,e),e+=2;var n=a.readUshort(t,e);e+=2;for(var i=0;i<n-1;i++)o.chain.push(a.readUshort(t,e)),e+=2;return o},r.head={},r.head.parse=function(t,e,a){var o=r._bin,n={};return o.readFixed(t,e),e+=4,n.fontRevision=o.readFixed(t,e),e+=4,o.readUint(t,e),e+=4,o.readUint(t,e),e+=4,n.flags=o.readUshort(t,e),e+=2,n.unitsPerEm=o.readUshort(t,e),e+=2,n.created=o.readUint64(t,e),e+=8,n.modified=o.readUint64(t,e),e+=8,n.xMin=o.readShort(t,e),e+=2,n.yMin=o.readShort(t,e),e+=2,n.xMax=o.readShort(t,e),e+=2,n.yMax=o.readShort(t,e),e+=2,n.macStyle=o.readUshort(t,e),e+=2,n.lowestRecPPEM=o.readUshort(t,e),e+=2,n.fontDirectionHint=o.readShort(t,e),e+=2,n.indexToLocFormat=o.readShort(t,e),e+=2,n.glyphDataFormat=o.readShort(t,e),e+=2,n},r.hhea={},r.hhea.parse=function(t,e,a){var o=r._bin,n={};return o.readFixed(t,e),e+=4,n.ascender=o.readShort(t,e),e+=2,n.descender=o.readShort(t,e),e+=2,n.lineGap=o.readShort(t,e),e+=2,n.advanceWidthMax=o.readUshort(t,e),e+=2,n.minLeftSideBearing=o.readShort(t,e),e+=2,n.minRightSideBearing=o.readShort(t,e),e+=2,n.xMaxExtent=o.readShort(t,e),e+=2,n.caretSlopeRise=o.readShort(t,e),e+=2,n.caretSlopeRun=o.readShort(t,e),e+=2,n.caretOffset=o.readShort(t,e),e+=2,e+=8,n.metricDataFormat=o.readShort(t,e),e+=2,n.numberOfHMetrics=o.readUshort(t,e),e+=2,n},r.hmtx={},r.hmtx.parse=function(t,e,a,o){for(var n=r._bin,i={aWidth:[],lsBearing:[]},s=0,f=0,u=0;u<o.maxp.numGlyphs;u++)u<o.hhea.numberOfHMetrics&&(s=n.readUshort(t,e),e+=2,f=n.readShort(t,e),e+=2),i.aWidth.push(s),i.lsBearing.push(f);return i},r.kern={},r.kern.parse=function(t,e,a,o){var n=r._bin,i=n.readUshort(t,e);if(e+=2,i==1)return r.kern.parseV1(t,e-2,a,o);var s=n.readUshort(t,e);e+=2;for(var f={glyph1:[],rval:[]},u=0;u<s;u++){e+=2,a=n.readUshort(t,e),e+=2;var d=n.readUshort(t,e);e+=2;var g=d>>>8;if((g&=15)!=0)throw"unknown kern table format: "+g;e=r.kern.readFormat0(t,e,f)}return f},r.kern.parseV1=function(t,e,a,o){var n=r._bin;n.readFixed(t,e),e+=4;var i=n.readUint(t,e);e+=4;for(var s={glyph1:[],rval:[]},f=0;f<i;f++){n.readUint(t,e),e+=4;var u=n.readUshort(t,e);e+=2,n.readUshort(t,e),e+=2;var d=u>>>8;if((d&=15)!=0)throw"unknown kern table format: "+d;e=r.kern.readFormat0(t,e,s)}return s},r.kern.readFormat0=function(t,e,a){var o=r._bin,n=-1,i=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2;for(var s=0;s<i;s++){var f=o.readUshort(t,e);e+=2;var u=o.readUshort(t,e);e+=2;var d=o.readShort(t,e);e+=2,f!=n&&(a.glyph1.push(f),a.rval.push({glyph2:[],vals:[]}));var g=a.rval[a.rval.length-1];g.glyph2.push(u),g.vals.push(d),n=f}return e},r.loca={},r.loca.parse=function(t,e,a,o){var n=r._bin,i=[],s=o.head.indexToLocFormat,f=o.maxp.numGlyphs+1;if(s==0)for(var u=0;u<f;u++)i.push(n.readUshort(t,e+(u<<1))<<1);if(s==1)for(u=0;u<f;u++)i.push(n.readUint(t,e+(u<<2)));return i},r.maxp={},r.maxp.parse=function(t,e,a){var o=r._bin,n={},i=o.readUint(t,e);return e+=4,n.numGlyphs=o.readUshort(t,e),e+=2,i==65536&&(n.maxPoints=o.readUshort(t,e),e+=2,n.maxContours=o.readUshort(t,e),e+=2,n.maxCompositePoints=o.readUshort(t,e),e+=2,n.maxCompositeContours=o.readUshort(t,e),e+=2,n.maxZones=o.readUshort(t,e),e+=2,n.maxTwilightPoints=o.readUshort(t,e),e+=2,n.maxStorage=o.readUshort(t,e),e+=2,n.maxFunctionDefs=o.readUshort(t,e),e+=2,n.maxInstructionDefs=o.readUshort(t,e),e+=2,n.maxStackElements=o.readUshort(t,e),e+=2,n.maxSizeOfInstructions=o.readUshort(t,e),e+=2,n.maxComponentElements=o.readUshort(t,e),e+=2,n.maxComponentDepth=o.readUshort(t,e),e+=2),n},r.name={},r.name.parse=function(t,e,a){var o=r._bin,n={};o.readUshort(t,e),e+=2;var i=o.readUshort(t,e);e+=2,o.readUshort(t,e);for(var s,f=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],u=e+=2,d=0;d<i;d++){var g=o.readUshort(t,e);e+=2;var m=o.readUshort(t,e);e+=2;var y=o.readUshort(t,e);e+=2;var R=o.readUshort(t,e);e+=2;var U=o.readUshort(t,e);e+=2;var E=o.readUshort(t,e);e+=2;var x,_=f[R],D=u+12*i+E;if(g==0)x=o.readUnicode(t,D,U/2);else if(g==3&&m==0)x=o.readUnicode(t,D,U/2);else if(m==0)x=o.readASCII(t,D,U);else if(m==1)x=o.readUnicode(t,D,U/2);else if(m==3)x=o.readUnicode(t,D,U/2);else{if(g!=1)throw"unknown encoding "+m+", platformID: "+g;x=o.readASCII(t,D,U),console.debug("reading unknown MAC encoding "+m+" as ASCII")}var w="p"+g+","+y.toString(16);n[w]==null&&(n[w]={}),n[w][_!==void 0?_:R]=x,n[w]._lang=y}for(var k in n)if(n[k].postScriptName!=null&&n[k]._lang==1033)return n[k];for(var k in n)if(n[k].postScriptName!=null&&n[k]._lang==0)return n[k];for(var k in n)if(n[k].postScriptName!=null&&n[k]._lang==3084)return n[k];for(var k in n)if(n[k].postScriptName!=null)return n[k];for(var k in n){s=k;break}return console.debug("returning name table with languageID "+n[s]._lang),n[s]},r["OS/2"]={},r["OS/2"].parse=function(t,e,a){var o=r._bin.readUshort(t,e);e+=2;var n={};if(o==0)r["OS/2"].version0(t,e,n);else if(o==1)r["OS/2"].version1(t,e,n);else if(o==2||o==3||o==4)r["OS/2"].version2(t,e,n);else{if(o!=5)throw"unknown OS/2 table version: "+o;r["OS/2"].version5(t,e,n)}return n},r["OS/2"].version0=function(t,e,a){var o=r._bin;return a.xAvgCharWidth=o.readShort(t,e),e+=2,a.usWeightClass=o.readUshort(t,e),e+=2,a.usWidthClass=o.readUshort(t,e),e+=2,a.fsType=o.readUshort(t,e),e+=2,a.ySubscriptXSize=o.readShort(t,e),e+=2,a.ySubscriptYSize=o.readShort(t,e),e+=2,a.ySubscriptXOffset=o.readShort(t,e),e+=2,a.ySubscriptYOffset=o.readShort(t,e),e+=2,a.ySuperscriptXSize=o.readShort(t,e),e+=2,a.ySuperscriptYSize=o.readShort(t,e),e+=2,a.ySuperscriptXOffset=o.readShort(t,e),e+=2,a.ySuperscriptYOffset=o.readShort(t,e),e+=2,a.yStrikeoutSize=o.readShort(t,e),e+=2,a.yStrikeoutPosition=o.readShort(t,e),e+=2,a.sFamilyClass=o.readShort(t,e),e+=2,a.panose=o.readBytes(t,e,10),e+=10,a.ulUnicodeRange1=o.readUint(t,e),e+=4,a.ulUnicodeRange2=o.readUint(t,e),e+=4,a.ulUnicodeRange3=o.readUint(t,e),e+=4,a.ulUnicodeRange4=o.readUint(t,e),e+=4,a.achVendID=[o.readInt8(t,e),o.readInt8(t,e+1),o.readInt8(t,e+2),o.readInt8(t,e+3)],e+=4,a.fsSelection=o.readUshort(t,e),e+=2,a.usFirstCharIndex=o.readUshort(t,e),e+=2,a.usLastCharIndex=o.readUshort(t,e),e+=2,a.sTypoAscender=o.readShort(t,e),e+=2,a.sTypoDescender=o.readShort(t,e),e+=2,a.sTypoLineGap=o.readShort(t,e),e+=2,a.usWinAscent=o.readUshort(t,e),e+=2,a.usWinDescent=o.readUshort(t,e),e+=2},r["OS/2"].version1=function(t,e,a){var o=r._bin;return e=r["OS/2"].version0(t,e,a),a.ulCodePageRange1=o.readUint(t,e),e+=4,a.ulCodePageRange2=o.readUint(t,e),e+=4},r["OS/2"].version2=function(t,e,a){var o=r._bin;return e=r["OS/2"].version1(t,e,a),a.sxHeight=o.readShort(t,e),e+=2,a.sCapHeight=o.readShort(t,e),e+=2,a.usDefault=o.readUshort(t,e),e+=2,a.usBreak=o.readUshort(t,e),e+=2,a.usMaxContext=o.readUshort(t,e),e+=2},r["OS/2"].version5=function(t,e,a){var o=r._bin;return e=r["OS/2"].version2(t,e,a),a.usLowerOpticalPointSize=o.readUshort(t,e),e+=2,a.usUpperOpticalPointSize=o.readUshort(t,e),e+=2},r.post={},r.post.parse=function(t,e,a){var o=r._bin,n={};return n.version=o.readFixed(t,e),e+=4,n.italicAngle=o.readFixed(t,e),e+=4,n.underlinePosition=o.readShort(t,e),e+=2,n.underlineThickness=o.readShort(t,e),e+=2,n},r==null&&(r={}),r.U==null&&(r.U={}),r.U.codeToGlyph=function(t,e){var a=t.cmap,o=-1;if(a.p0e4!=null?o=a.p0e4:a.p3e1!=null?o=a.p3e1:a.p1e0!=null?o=a.p1e0:a.p0e3!=null&&(o=a.p0e3),o==-1)throw"no familiar platform and encoding!";var n=a.tables[o];if(n.format==0)return e>=n.map.length?0:n.map[e];if(n.format==4){for(var i=-1,s=0;s<n.endCount.length;s++)if(e<=n.endCount[s]){i=s;break}return i==-1||n.startCount[i]>e?0:65535&(n.idRangeOffset[i]!=0?n.glyphIdArray[e-n.startCount[i]+(n.idRangeOffset[i]>>1)-(n.idRangeOffset.length-i)]:e+n.idDelta[i])}if(n.format==12){if(e>n.groups[n.groups.length-1][1])return 0;for(s=0;s<n.groups.length;s++){var f=n.groups[s];if(f[0]<=e&&e<=f[1])return f[2]+(e-f[0])}return 0}throw"unknown cmap table format "+n.format},r.U.glyphToPath=function(t,e){var a={cmds:[],crds:[]};if(t.SVG&&t.SVG.entries[e]){var o=t.SVG.entries[e];return o==null?a:(typeof o=="string"&&(o=r.SVG.toPath(o),t.SVG.entries[e]=o),o)}if(t.CFF){var n={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:t.CFF.Private?t.CFF.Private.defaultWidthX:0,open:!1},i=t.CFF,s=t.CFF.Private;if(i.ROS){for(var f=0;i.FDSelect[f+2]<=e;)f+=2;s=i.FDArray[i.FDSelect[f+1]].Private}r.U._drawCFF(t.CFF.CharStrings[e],n,i,s,a)}else t.glyf&&r.U._drawGlyf(e,t,a);return a},r.U._drawGlyf=function(t,e,a){var o=e.glyf[t];o==null&&(o=e.glyf[t]=r.glyf._parseGlyf(e,t)),o!=null&&(o.noc>-1?r.U._simpleGlyph(o,a):r.U._compoGlyph(o,e,a))},r.U._simpleGlyph=function(t,e){for(var a=0;a<t.noc;a++){for(var o=a==0?0:t.endPts[a-1]+1,n=t.endPts[a],i=o;i<=n;i++){var s=i==o?n:i-1,f=i==n?o:i+1,u=1&t.flags[i],d=1&t.flags[s],g=1&t.flags[f],m=t.xs[i],y=t.ys[i];if(i==o)if(u){if(!d){r.U.P.moveTo(e,m,y);continue}r.U.P.moveTo(e,t.xs[s],t.ys[s])}else d?r.U.P.moveTo(e,t.xs[s],t.ys[s]):r.U.P.moveTo(e,(t.xs[s]+m)/2,(t.ys[s]+y)/2);u?d&&r.U.P.lineTo(e,m,y):g?r.U.P.qcurveTo(e,m,y,t.xs[f],t.ys[f]):r.U.P.qcurveTo(e,m,y,(m+t.xs[f])/2,(y+t.ys[f])/2)}r.U.P.closePath(e)}},r.U._compoGlyph=function(t,e,a){for(var o=0;o<t.parts.length;o++){var n={cmds:[],crds:[]},i=t.parts[o];r.U._drawGlyf(i.glyphIndex,e,n);for(var s=i.m,f=0;f<n.crds.length;f+=2){var u=n.crds[f],d=n.crds[f+1];a.crds.push(u*s.a+d*s.b+s.tx),a.crds.push(u*s.c+d*s.d+s.ty)}for(f=0;f<n.cmds.length;f++)a.cmds.push(n.cmds[f])}},r.U._getGlyphClass=function(t,e){var a=r._lctf.getInterval(e,t);return a==-1?0:e[a+2]},r.U._applySubs=function(t,e,a,o){for(var n=t.length-e-1,i=0;i<a.tabs.length;i++)if(a.tabs[i]!=null){var s,f=a.tabs[i];if(!f.coverage||(s=r._lctf.coverageIndex(f.coverage,t[e]))!=-1){if(a.ltype==1)t[e],f.fmt==1?t[e]=t[e]+f.delta:t[e]=f.newg[s];else if(a.ltype==4)for(var u=f.vals[s],d=0;d<u.length;d++){var g=u[d],m=g.chain.length;if(!(m>n)){for(var y=!0,R=0,U=0;U<m;U++){for(;t[e+R+(1+U)]==-1;)R++;g.chain[U]!=t[e+R+(1+U)]&&(y=!1)}if(y){for(t[e]=g.nglyph,U=0;U<m+R;U++)t[e+U+1]=-1;break}}}else if(a.ltype==5&&f.fmt==2)for(var E=r._lctf.getInterval(f.cDef,t[e]),x=f.cDef[E+2],_=f.scset[x],D=0;D<_.length;D++){var w=_[D],k=w.input;if(!(k.length>n)){for(y=!0,U=0;U<k.length;U++){var I=r._lctf.getInterval(f.cDef,t[e+1+U]);if(E==-1&&f.cDef[I+2]!=k[U]){y=!1;break}}if(y){var T=w.substLookupRecords;for(d=0;d<T.length;d+=2)T[d],T[d+1]}}}else if(a.ltype==6&&f.fmt==3){if(!r.U._glsCovered(t,f.backCvg,e-f.backCvg.length)||!r.U._glsCovered(t,f.inptCvg,e)||!r.U._glsCovered(t,f.ahedCvg,e+f.inptCvg.length))continue;var J=f.lookupRec;for(D=0;D<J.length;D+=2){E=J[D];var b=o[J[D+1]];r.U._applySubs(t,e+E,b,o)}}}}},r.U._glsCovered=function(t,e,a){for(var o=0;o<e.length;o++)if(r._lctf.coverageIndex(e[o],t[a+o])==-1)return!1;return!0},r.U.glyphsToPath=function(t,e,a){for(var o={cmds:[],crds:[]},n=0,i=0;i<e.length;i++){var s=e[i];if(s!=-1){for(var f=i<e.length-1&&e[i+1]!=-1?e[i+1]:0,u=r.U.glyphToPath(t,s),d=0;d<u.crds.length;d+=2)o.crds.push(u.crds[d]+n),o.crds.push(u.crds[d+1]);for(a&&o.cmds.push(a),d=0;d<u.cmds.length;d++)o.cmds.push(u.cmds[d]);a&&o.cmds.push("X"),n+=t.hmtx.aWidth[s],i<e.length-1&&(n+=r.U.getPairAdjustment(t,s,f))}}return o},r.U.P={},r.U.P.moveTo=function(t,e,a){t.cmds.push("M"),t.crds.push(e,a)},r.U.P.lineTo=function(t,e,a){t.cmds.push("L"),t.crds.push(e,a)},r.U.P.curveTo=function(t,e,a,o,n,i,s){t.cmds.push("C"),t.crds.push(e,a,o,n,i,s)},r.U.P.qcurveTo=function(t,e,a,o,n){t.cmds.push("Q"),t.crds.push(e,a,o,n)},r.U.P.closePath=function(t){t.cmds.push("Z")},r.U._drawCFF=function(t,e,a,o,n){for(var i=e.stack,s=e.nStems,f=e.haveWidth,u=e.width,d=e.open,g=0,m=e.x,y=e.y,R=0,U=0,E=0,x=0,_=0,D=0,w=0,k=0,I=0,T=0,J={val:0,size:0};g<t.length;){r.CFF.getCharString(t,g,J);var b=J.val;if(g+=J.size,b=="o1"||b=="o18")i.length%2!=0&&!f&&(u=i.shift()+o.nominalWidthX),s+=i.length>>1,i.length=0,f=!0;else if(b=="o3"||b=="o23")i.length%2!=0&&!f&&(u=i.shift()+o.nominalWidthX),s+=i.length>>1,i.length=0,f=!0;else if(b=="o4")i.length>1&&!f&&(u=i.shift()+o.nominalWidthX,f=!0),d&&r.U.P.closePath(n),y+=i.pop(),r.U.P.moveTo(n,m,y),d=!0;else if(b=="o5")for(;i.length>0;)m+=i.shift(),y+=i.shift(),r.U.P.lineTo(n,m,y);else if(b=="o6"||b=="o7")for(var P=i.length,F=b=="o6",Y=0;Y<P;Y++){var V=i.shift();F?m+=V:y+=V,F=!F,r.U.P.lineTo(n,m,y)}else if(b=="o8"||b=="o24"){P=i.length;for(var ee=0;ee+6<=P;)R=m+i.shift(),U=y+i.shift(),E=R+i.shift(),x=U+i.shift(),m=E+i.shift(),y=x+i.shift(),r.U.P.curveTo(n,R,U,E,x,m,y),ee+=6;b=="o24"&&(m+=i.shift(),y+=i.shift(),r.U.P.lineTo(n,m,y))}else{if(b=="o11")break;if(b=="o1234"||b=="o1235"||b=="o1236"||b=="o1237")b=="o1234"&&(U=y,E=(R=m+i.shift())+i.shift(),T=x=U+i.shift(),D=x,k=y,m=(w=(_=(I=E+i.shift())+i.shift())+i.shift())+i.shift(),r.U.P.curveTo(n,R,U,E,x,I,T),r.U.P.curveTo(n,_,D,w,k,m,y)),b=="o1235"&&(R=m+i.shift(),U=y+i.shift(),E=R+i.shift(),x=U+i.shift(),I=E+i.shift(),T=x+i.shift(),_=I+i.shift(),D=T+i.shift(),w=_+i.shift(),k=D+i.shift(),m=w+i.shift(),y=k+i.shift(),i.shift(),r.U.P.curveTo(n,R,U,E,x,I,T),r.U.P.curveTo(n,_,D,w,k,m,y)),b=="o1236"&&(R=m+i.shift(),U=y+i.shift(),E=R+i.shift(),T=x=U+i.shift(),D=x,w=(_=(I=E+i.shift())+i.shift())+i.shift(),k=D+i.shift(),m=w+i.shift(),r.U.P.curveTo(n,R,U,E,x,I,T),r.U.P.curveTo(n,_,D,w,k,m,y)),b=="o1237"&&(R=m+i.shift(),U=y+i.shift(),E=R+i.shift(),x=U+i.shift(),I=E+i.shift(),T=x+i.shift(),_=I+i.shift(),D=T+i.shift(),w=_+i.shift(),k=D+i.shift(),Math.abs(w-m)>Math.abs(k-y)?m=w+i.shift():y=k+i.shift(),r.U.P.curveTo(n,R,U,E,x,I,T),r.U.P.curveTo(n,_,D,w,k,m,y));else if(b=="o14"){if(i.length>0&&!f&&(u=i.shift()+a.nominalWidthX,f=!0),i.length==4){var te=i.shift(),N=i.shift(),L=i.shift(),p=i.shift(),S=r.CFF.glyphBySE(a,L),C=r.CFF.glyphBySE(a,p);r.U._drawCFF(a.CharStrings[S],e,a,o,n),e.x=te,e.y=N,r.U._drawCFF(a.CharStrings[C],e,a,o,n)}d&&(r.U.P.closePath(n),d=!1)}else if(b=="o19"||b=="o20")i.length%2!=0&&!f&&(u=i.shift()+o.nominalWidthX),s+=i.length>>1,i.length=0,f=!0,g+=s+7>>3;else if(b=="o21")i.length>2&&!f&&(u=i.shift()+o.nominalWidthX,f=!0),y+=i.pop(),m+=i.pop(),d&&r.U.P.closePath(n),r.U.P.moveTo(n,m,y),d=!0;else if(b=="o22")i.length>1&&!f&&(u=i.shift()+o.nominalWidthX,f=!0),m+=i.pop(),d&&r.U.P.closePath(n),r.U.P.moveTo(n,m,y),d=!0;else if(b=="o25"){for(;i.length>6;)m+=i.shift(),y+=i.shift(),r.U.P.lineTo(n,m,y);R=m+i.shift(),U=y+i.shift(),E=R+i.shift(),x=U+i.shift(),m=E+i.shift(),y=x+i.shift(),r.U.P.curveTo(n,R,U,E,x,m,y)}else if(b=="o26")for(i.length%2&&(m+=i.shift());i.length>0;)R=m,U=y+i.shift(),m=E=R+i.shift(),y=(x=U+i.shift())+i.shift(),r.U.P.curveTo(n,R,U,E,x,m,y);else if(b=="o27")for(i.length%2&&(y+=i.shift());i.length>0;)U=y,E=(R=m+i.shift())+i.shift(),x=U+i.shift(),m=E+i.shift(),y=x,r.U.P.curveTo(n,R,U,E,x,m,y);else if(b=="o10"||b=="o29"){var M=b=="o10"?o:a;if(i.length==0)console.debug("error: empty stack");else{var A=i.pop(),W=M.Subrs[A+M.Bias];e.x=m,e.y=y,e.nStems=s,e.haveWidth=f,e.width=u,e.open=d,r.U._drawCFF(W,e,a,o,n),m=e.x,y=e.y,s=e.nStems,f=e.haveWidth,u=e.width,d=e.open}}else if(b=="o30"||b=="o31"){var O=i.length,j=(ee=0,b=="o31");for(ee+=O-(P=-3&O);ee<P;)j?(U=y,E=(R=m+i.shift())+i.shift(),y=(x=U+i.shift())+i.shift(),P-ee==5?(m=E+i.shift(),ee++):m=E,j=!1):(R=m,U=y+i.shift(),E=R+i.shift(),x=U+i.shift(),m=E+i.shift(),P-ee==5?(y=x+i.shift(),ee++):y=x,j=!0),r.U.P.curveTo(n,R,U,E,x,m,y),ee+=4}else{if((b+"").charAt(0)=="o")throw console.debug("Unknown operation: "+b,t),b;i.push(b)}}}e.x=m,e.y=y,e.nStems=s,e.haveWidth=f,e.width=u,e.open=d};var h=r,l={Typr:h};return c.Typr=h,c.default=l,Object.defineProperty(c,"__esModule",{value:!0}),c})({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Ca(){return(function(c){var r=Uint8Array,h=Uint16Array,l=Uint32Array,t=new r([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new r([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new r([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=function(b,P){for(var F=new h(31),Y=0;Y<31;++Y)F[Y]=P+=1<<b[Y-1];var V=new l(F[30]);for(Y=1;Y<30;++Y)for(var ee=F[Y];ee<F[Y+1];++ee)V[ee]=ee-F[Y]<<5|Y;return[F,V]},n=o(t,2),i=n[0],s=n[1];i[28]=258,s[258]=28;for(var f=o(e,0)[0],u=new h(32768),d=0;d<32768;++d){var g=(43690&d)>>>1|(21845&d)<<1;g=(61680&(g=(52428&g)>>>2|(13107&g)<<2))>>>4|(3855&g)<<4,u[d]=((65280&g)>>>8|(255&g)<<8)>>>1}var m=function(b,P,F){for(var Y=b.length,V=0,ee=new h(P);V<Y;++V)++ee[b[V]-1];var te,N=new h(P);for(V=0;V<P;++V)N[V]=N[V-1]+ee[V-1]<<1;{te=new h(1<<P);var L=15-P;for(V=0;V<Y;++V)if(b[V])for(var p=V<<4|b[V],S=P-b[V],C=N[b[V]-1]++<<S,M=C|(1<<S)-1;C<=M;++C)te[u[C]>>>L]=p}return te},y=new r(288);for(d=0;d<144;++d)y[d]=8;for(d=144;d<256;++d)y[d]=9;for(d=256;d<280;++d)y[d]=7;for(d=280;d<288;++d)y[d]=8;var R=new r(32);for(d=0;d<32;++d)R[d]=5;var U=m(y,9),E=m(R,5),x=function(b){for(var P=b[0],F=1;F<b.length;++F)b[F]>P&&(P=b[F]);return P},_=function(b,P,F){var Y=P/8|0;return(b[Y]|b[Y+1]<<8)>>(7&P)&F},D=function(b,P){var F=P/8|0;return(b[F]|b[F+1]<<8|b[F+2]<<16)>>(7&P)},w=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],k=function(b,P,F){var Y=new Error(P||w[b]);if(Y.code=b,Error.captureStackTrace&&Error.captureStackTrace(Y,k),!F)throw Y;return Y},I=function(b,P,F){var Y=b.length;if(!Y||F&&!F.l&&Y<5)return P||new r(0);var V=!P||F,ee=!F||F.i;F||(F={}),P||(P=new r(3*Y));var te,N=function(ce){var v=P.length;if(ce>v){var B=new r(Math.max(2*v,ce));B.set(P),P=B}},L=F.f||0,p=F.p||0,S=F.b||0,C=F.l,M=F.d,A=F.m,W=F.n,O=8*Y;do{if(!C){F.f=L=_(b,p,1);var j=_(b,p+1,3);if(p+=3,!j){var K=b[(re=((te=p)/8|0)+(7&te&&1)+4)-4]|b[re-3]<<8,oe=re+K;if(oe>Y){ee&&k(0);break}V&&N(S+K),P.set(b.subarray(re,oe),S),F.b=S+=K,F.p=p=8*oe;continue}if(j==1)C=U,M=E,A=9,W=5;else if(j==2){var X=_(b,p,31)+257,z=_(b,p+10,15)+4,be=X+_(b,p+5,31)+1;p+=14;for(var ge=new r(be),q=new r(19),se=0;se<z;++se)q[a[se]]=_(b,p+3*se,7);p+=3*z;var he=x(q),H=(1<<he)-1,ie=m(q,he);for(se=0;se<be;){var re,G=ie[_(b,p,H)];if(p+=15&G,(re=G>>>4)<16)ge[se++]=re;else{var ye=0,Q=0;for(re==16?(Q=3+_(b,p,3),p+=2,ye=ge[se-1]):re==17?(Q=3+_(b,p,7),p+=3):re==18&&(Q=11+_(b,p,127),p+=7);Q--;)ge[se++]=ye}}var ne=ge.subarray(0,X),Z=ge.subarray(X);A=x(ne),W=x(Z),C=m(ne,A),M=m(Z,W)}else k(1);if(p>O){ee&&k(0);break}}V&&N(S+131072);for(var ke=(1<<A)-1,le=(1<<W)-1,fe=p;;fe=p){var pe=(ye=C[D(b,p)&ke])>>>4;if((p+=15&ye)>O){ee&&k(0);break}if(ye||k(2),pe<256)P[S++]=pe;else{if(pe==256){fe=p,C=null;break}var xe=pe-254;if(pe>264){var De=t[se=pe-257];xe=_(b,p,(1<<De)-1)+i[se],p+=De}var Fe=M[D(b,p)&le],Se=Fe>>>4;if(Fe||k(3),p+=15&Fe,Z=f[Se],Se>3&&(De=e[Se],Z+=D(b,p)&(1<<De)-1,p+=De),p>O){ee&&k(0);break}V&&N(S+131072);for(var _e=S+xe;S<_e;S+=4)P[S]=P[S-Z],P[S+1]=P[S+1-Z],P[S+2]=P[S+2-Z],P[S+3]=P[S+3-Z];S=_e}}F.l=C,F.p=fe,F.b=S,C&&(L=1,F.m=A,F.d=M,F.n=W)}while(!L);return S==P.length?P:(function(ce,v,B){(B==null||B>ce.length)&&(B=ce.length);var ae=new(ce instanceof h?h:ce instanceof l?l:r)(B-v);return ae.set(ce.subarray(v,B)),ae})(P,0,S)},T=new r(0),J=typeof TextDecoder<"u"&&new TextDecoder;try{J.decode(T,{stream:!0})}catch{}return c.convert_streams=function(b){var P=new DataView(b),F=0;function Y(){var X=P.getUint16(F);return F+=2,X}function V(){var X=P.getUint32(F);return F+=4,X}function ee(X){K.setUint16(oe,X),oe+=2}function te(X){K.setUint32(oe,X),oe+=4}for(var N={signature:V(),flavor:V(),length:V(),numTables:Y(),reserved:Y(),totalSfntSize:V(),majorVersion:Y(),minorVersion:Y(),metaOffset:V(),metaLength:V(),metaOrigLength:V(),privOffset:V(),privLength:V()},L=0;Math.pow(2,L)<=N.numTables;)L++;L--;for(var p=16*Math.pow(2,L),S=16*N.numTables-p,C=12,M=[],A=0;A<N.numTables;A++)M.push({tag:V(),offset:V(),compLength:V(),origLength:V(),origChecksum:V()}),C+=16;var W,O=new Uint8Array(12+16*M.length+M.reduce((function(X,z){return X+z.origLength+4}),0)),j=O.buffer,K=new DataView(j),oe=0;return te(N.flavor),ee(N.numTables),ee(p),ee(L),ee(S),M.forEach((function(X){te(X.tag),te(X.origChecksum),te(C),te(X.origLength),X.outOffset=C,(C+=X.origLength)%4!=0&&(C+=4-C%4)})),M.forEach((function(X){var z,be=b.slice(X.offset,X.offset+X.compLength);if(X.compLength!=X.origLength){var ge=new Uint8Array(X.origLength);z=new Uint8Array(be,2),I(z,ge)}else ge=new Uint8Array(be);O.set(ge,X.outOffset);var q=0;(C=X.outOffset+X.origLength)%4!=0&&(q=4-C%4),O.set(new Uint8Array(q).buffer,X.outOffset+X.origLength),W=C+q})),j.slice(0,W)},Object.defineProperty(c,"__esModule",{value:!0}),c})({}).convert_streams}function Fa(c,r){const h={M:2,L:2,Q:4,C:6,Z:0},l={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},t=1,e=2,a=4,o=8,n=16,i=32;let s;function f(w){if(!s){const k={R:e,L:t,D:a,C:n,U:i,T:o};s=new Map;for(let I in l){let T=0;l[I].split(",").forEach(J=>{let[b,P]=J.split("+");b=parseInt(b,36),P=P?parseInt(P,36):0,s.set(T+=b,k[I]);for(let F=P;F--;)s.set(++T,k[I])})}}return s.get(w)||i}const u=1,d=2,g=3,m=4,y=[null,"isol","init","fina","medi"];function R(w){const k=new Uint8Array(w.length);let I=i,T=u,J=-1;for(let b=0;b<w.length;b++){const P=w.codePointAt(b);let F=f(P)|0,Y=u;F&o||(I&(t|a|n)?F&(e|a|n)?(Y=g,(T===u||T===g)&&k[J]++):F&(t|i)&&(T===d||T===m)&&k[J]--:I&(e|i)&&(T===d||T===m)&&k[J]--,T=k[b]=Y,I=F,J=b,P>65535&&b++)}return k}function U(w,k){const I=[];for(let J=0;J<k.length;J++){const b=k.codePointAt(J);b>65535&&J++,I.push(c.U.codeToGlyph(w,b))}const T=w.GSUB;if(T){const{lookupList:J,featureList:b}=T;let P;const F=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,Y=[];b.forEach(V=>{if(F.test(V.tag))for(let ee=0;ee<V.tab.length;ee++){if(Y[V.tab[ee]])continue;Y[V.tab[ee]]=!0;const te=J[V.tab[ee]],N=/^(isol|init|fina|medi)$/.test(V.tag);N&&!P&&(P=R(k));for(let L=0;L<I.length;L++)(!P||!N||y[P[L]]===V.tag)&&c.U._applySubs(I,L,te,J)}})}return I}function E(w,k){const I=new Int16Array(k.length*3);let T=0;for(;T<k.length;T++){const F=k[T];if(F===-1)continue;I[T*3+2]=w.hmtx.aWidth[F];const Y=w.GPOS;if(Y){const V=Y.lookupList;for(let ee=0;ee<V.length;ee++){const te=V[ee];for(let N=0;N<te.tabs.length;N++){const L=te.tabs[N];if(te.ltype===1){if(c._lctf.coverageIndex(L.coverage,F)!==-1&&L.pos){P(L.pos,T);break}}else if(te.ltype===2){let p=null,S=J();if(S!==-1){const C=c._lctf.coverageIndex(L.coverage,k[S]);if(C!==-1){if(L.fmt===1){const M=L.pairsets[C];for(let A=0;A<M.length;A++)M[A].gid2===F&&(p=M[A])}else if(L.fmt===2){const M=c.U._getGlyphClass(k[S],L.classDef1),A=c.U._getGlyphClass(F,L.classDef2);p=L.matrix[M][A]}if(p){p.val1&&P(p.val1,S),p.val2&&P(p.val2,T);break}}}}else if(te.ltype===4){const p=c._lctf.coverageIndex(L.markCoverage,F);if(p!==-1){const S=J(b),C=S===-1?-1:c._lctf.coverageIndex(L.baseCoverage,k[S]);if(C!==-1){const M=L.markArray[p],A=L.baseArray[C][M.markClass];I[T*3]=A.x-M.x+I[S*3]-I[S*3+2],I[T*3+1]=A.y-M.y+I[S*3+1];break}}}else if(te.ltype===6){const p=c._lctf.coverageIndex(L.mark1Coverage,F);if(p!==-1){const S=J();if(S!==-1){const C=k[S];if(x(w,C)===3){const M=c._lctf.coverageIndex(L.mark2Coverage,C);if(M!==-1){const A=L.mark1Array[p],W=L.mark2Array[M][A.markClass];I[T*3]=W.x-A.x+I[S*3]-I[S*3+2],I[T*3+1]=W.y-A.y+I[S*3+1];break}}}}}}}}else if(w.kern&&!w.cff){const V=J();if(V!==-1){const ee=w.kern.glyph1.indexOf(k[V]);if(ee!==-1){const te=w.kern.rval[ee].glyph2.indexOf(F);te!==-1&&(I[V*3+2]+=w.kern.rval[ee].vals[te])}}}}return I;function J(F){for(let Y=T-1;Y>=0;Y--)if(k[Y]!==-1&&(!F||F(k[Y])))return Y;return-1}function b(F){return x(w,F)===1}function P(F,Y){for(let V=0;V<3;V++)I[Y*3+V]+=F[V]||0}}function x(w,k){const I=w.GDEF&&w.GDEF.glyphClassDef;return I?c.U._getGlyphClass(k,I):0}function _(...w){for(let k=0;k<w.length;k++)if(typeof w[k]=="number")return w[k]}function D(w){const k=Object.create(null),I=w["OS/2"],T=w.hhea,J=w.head.unitsPerEm,b=_(I&&I.sTypoAscender,T&&T.ascender,J),P={unitsPerEm:J,ascender:b,descender:_(I&&I.sTypoDescender,T&&T.descender,0),capHeight:_(I&&I.sCapHeight,b),xHeight:_(I&&I.sxHeight,b),lineGap:_(I&&I.sTypoLineGap,T&&T.lineGap),supportsCodePoint(F){return c.U.codeToGlyph(w,F)>0},forEachGlyph(F,Y,V,ee){let te=0;const N=1/P.unitsPerEm*Y,L=U(w,F);let p=0;const S=E(w,L);return L.forEach((C,M)=>{if(C!==-1){let A=k[C];if(!A){const{cmds:W,crds:O}=c.U.glyphToPath(w,C);let j="",K=0;for(let ge=0,q=W.length;ge<q;ge++){const se=h[W[ge]];j+=W[ge];for(let he=1;he<=se;he++)j+=(he>1?",":"")+O[K++]}let oe,X,z,be;if(O.length){oe=X=1/0,z=be=-1/0;for(let ge=0,q=O.length;ge<q;ge+=2){let se=O[ge],he=O[ge+1];se<oe&&(oe=se),he<X&&(X=he),se>z&&(z=se),he>be&&(be=he)}}else oe=z=X=be=0;A=k[C]={index:C,advanceWidth:w.hmtx.aWidth[C],xMin:oe,yMin:X,xMax:z,yMax:be,path:j}}ee.call(null,A,te+S[M*3]*N,S[M*3+1]*N,p),te+=S[M*3+2]*N,V&&(te+=V*Y)}p+=F.codePointAt(p)>65535?2:1}),te}};return P}return function(k){const I=new Uint8Array(k,0,4),T=c._bin.readASCII(I,0,4);if(T==="wOFF")k=r(k);else if(T==="wOF2")throw new Error("woff2 fonts not supported");return D(c.parse(k)[0])}}const Ma=dt({name:"Typr Font Parser",dependencies:[Da,Ca,Fa],init(c,r,h){const l=c(),t=r();return h(l,t)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function Pa(){return(function(c){var r=function(){this.buckets=new Map};r.prototype.add=function(E){var x=E>>5;this.buckets.set(x,(this.buckets.get(x)||0)|1<<(31&E))},r.prototype.has=function(E){var x=this.buckets.get(E>>5);return x!==void 0&&(x&1<<(31&E))!=0},r.prototype.serialize=function(){var E=[];return this.buckets.forEach((function(x,_){E.push((+_).toString(36)+":"+x.toString(36))})),E.join(",")},r.prototype.deserialize=function(E){var x=this;this.buckets.clear(),E.split(",").forEach((function(_){var D=_.split(":");x.buckets.set(parseInt(D[0],36),parseInt(D[1],36))}))};var h=Math.pow(2,8),l=h-1,t=~l;function e(E){var x=(function(D){return D&t})(E).toString(16),_=(function(D){return(D&t)+h-1})(E).toString(16);return"codepoint-index/plane"+(E>>16)+"/"+x+"-"+_+".json"}function a(E,x){var _=E&l,D=x.codePointAt(_/6|0);return((D=(D||48)-48)&1<<_%6)!=0}function o(E,x){var _;(_=E,_.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(D){return D.split("-").map((function(w){return parseInt(w.trim(),16)}))}))).forEach((function(D){var w=D[0],k=D[1];k===void 0&&(k=w),x(w,k)}))}function n(E,x){o(E,(function(_,D){for(var w=_;w<=D;w++)x(w)}))}var i={},s={},f=new WeakMap,u="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function d(E){var x=f.get(E);return x||(x=new r,n(E.ranges,(function(_){return x.add(_)})),f.set(E,x)),x}var g,m=new Map;function y(E,x,_){return E[x]?x:E[_]?_:(function(D){for(var w in D)return w})(E)}function R(E,x){var _=x;if(!E.includes(_)){_=1/0;for(var D=0;D<E.length;D++)Math.abs(E[D]-x)<Math.abs(_-x)&&(_=E[D])}return _}function U(E){return g||(g=new Set,n("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(x){g.add(x)}))),g.has(E)}return c.CodePointSet=r,c.clearCache=function(){i={},s={}},c.getFontsForString=function(E,x){x===void 0&&(x={});var _,D=x.lang;D===void 0&&(D=/\p{Script=Hangul}/u.test(_=E)?"ko":/\p{Script=Hiragana}|\p{Script=Katakana}/u.test(_)?"ja":"en");var w=x.category;w===void 0&&(w="sans-serif");var k=x.style;k===void 0&&(k="normal");var I=x.weight;I===void 0&&(I=400);var T=(x.dataUrl||u).replace(/\/$/g,""),J=new Map,b=new Uint8Array(E.length),P={},F={},Y=new Array(E.length),V=new Map,ee=!1;function te(p){var S=m.get(p);return S||(S=fetch(T+"/"+p).then((function(C){if(!C.ok)throw new Error(C.statusText);return C.json().then((function(M){if(!Array.isArray(M)||M[0]!==1)throw new Error("Incorrect schema version; need 1, got "+M[0]);return M[1]}))})).catch((function(C){if(T!==u)return ee||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+T+'", trying default CDN. '+C.message),ee=!0),T=u,m.delete(p),te(p);throw C})),m.set(p,S)),S}for(var N=function(p){var S=E.codePointAt(p),C=e(S);Y[p]=C,i[C]||V.has(C)||V.set(C,te(C).then((function(M){i[C]=M}))),S>65535&&(p++,L=p)},L=0;L<E.length;L++)N(L);return Promise.all(V.values()).then((function(){V.clear();for(var p=function(C){var M=E.codePointAt(C),A=null,W=i[Y[C]],O=void 0;for(var j in W){var K=F[j];if(K===void 0&&(K=F[j]=new RegExp(j).test(D||"en")),K){for(var oe in O=j,W[j])if(a(M,W[j][oe])){A=oe;break}break}}if(!A){e:for(var X in W)if(X!==O){for(var z in W[X])if(a(M,W[X][z])){A=z;break e}}}A||(console.debug("No font coverage for U+"+M.toString(16)),A="latin"),Y[C]=A,s[A]||V.has(A)||V.set(A,te("font-meta/"+A+".json").then((function(be){s[A]=be}))),M>65535&&(C++,S=C)},S=0;S<E.length;S++)p(S);return Promise.all(V.values())})).then((function(){for(var p,S=null,C=0;C<E.length;C++){var M=E.codePointAt(C);if(S&&(U(M)||d(S).has(M)))b[C]=b[C-1];else{S=s[Y[C]];var A=P[S.id];if(!A){var W=S.typeforms,O=y(W,w,"sans-serif"),j=y(W[O],k,"normal"),K=R((p=W[O])===null||p===void 0?void 0:p[j],I);A=P[S.id]=T+"/font-files/"+S.id+"/"+O+"."+j+"."+K+".woff"}var oe=J.get(A);oe==null&&(oe=J.size,J.set(A,oe)),b[C]=oe}M>65535&&(C++,b[C]=b[C-1])}return{fontUrls:Array.from(J.keys()),chars:b}}))},Object.defineProperty(c,"__esModule",{value:!0}),c})({})}function Oa(c,r){const h=Object.create(null),l=Object.create(null);function t(a,o){const n=i=>{console.error(`Failure loading font ${a}`,i)};try{const i=new XMLHttpRequest;i.open("get",a,!0),i.responseType="arraybuffer",i.onload=function(){if(i.status>=400)n(new Error(i.statusText));else if(i.status>0)try{const s=c(i.response);s.src=a,o(s)}catch(s){n(s)}},i.onerror=n,i.send()}catch(i){n(i)}}function e(a,o){let n=h[a];n?o(n):l[a]?l[a].push(o):(l[a]=[o],t(a,i=>{i.src=a,h[a]=i,l[a].forEach(s=>s(i)),delete l[a]}))}return function(a,o,{lang:n,fonts:i=[],style:s="normal",weight:f="normal",unicodeFontsURL:u}={}){const d=new Uint8Array(a.length),g=[];a.length||U();const m=new Map,y=[];if(s!=="italic"&&(s="normal"),typeof f!="number"&&(f=f==="bold"?700:400),i&&!Array.isArray(i)&&(i=[i]),i=i.slice().filter(x=>!x.lang||x.lang.test(n)).reverse(),i.length){let w=0;(function k(I=0){for(let T=I,J=a.length;T<J;T++){const b=a.codePointAt(T);if(w===1&&g[d[T-1]].supportsCodePoint(b)||T>0&&/\s/.test(a[T]))d[T]=d[T-1],w===2&&(y[y.length-1][1]=T);else for(let P=d[T],F=i.length;P<=F;P++)if(P===F){const Y=w===2?y[y.length-1]:y[y.length]=[T,T];Y[1]=T,w=2}else{d[T]=P;const{src:Y,unicodeRange:V}=i[P];if(!V||E(b,V)){const ee=h[Y];if(!ee){e(Y,()=>{k(T)});return}if(ee.supportsCodePoint(b)){let te=m.get(ee);typeof te!="number"&&(te=g.length,g.push(ee),m.set(ee,te)),d[T]=te,w=1;break}}}b>65535&&T+1<J&&(d[T+1]=d[T],T++,w===2&&(y[y.length-1][1]=T))}R()})()}else y.push([0,a.length-1]),R();function R(){if(y.length){const x=y.map(_=>a.substring(_[0],_[1]+1)).join(`
`);r.getFontsForString(x,{lang:n||void 0,style:s,weight:f,dataUrl:u}).then(({fontUrls:_,chars:D})=>{const w=g.length;let k=0;y.forEach(T=>{for(let J=0,b=T[1]-T[0];J<=b;J++)d[T[0]+J]=D[k++]+w;k++});let I=0;_.forEach((T,J)=>{e(T,b=>{g[J+w]=b,++I===_.length&&U()})})})}else U()}function U(){o({chars:d,fonts:g})}function E(x,_){for(let D=0;D<_.length;D++){const[w,k=w]=_[D];if(w<=x&&x<=k)return!0}return!1}}}const La=dt({name:"FontResolver",dependencies:[Oa,Ma,Pa],init(c,r,h){return c(r,h())}});function Ra(c,r){const l=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,t="[^\\S\\u00A0]",e=new RegExp(`${t}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function a({text:g,lang:m,fonts:y,style:R,weight:U,preResolvedFonts:E,unicodeFontsURL:x},_){const D=({chars:w,fonts:k})=>{let I,T;const J=[];for(let b=0;b<w.length;b++)w[b]!==T?(T=w[b],J.push(I={start:b,end:b,fontObj:k[w[b]]})):I.end=b;_(J)};E?D(E):c(g,D,{lang:m,fonts:y,style:R,weight:U,unicodeFontsURL:x})}function o({text:g="",font:m,lang:y,sdfGlyphSize:R=64,fontSize:U=400,fontWeight:E=1,fontStyle:x="normal",letterSpacing:_=0,lineHeight:D="normal",maxWidth:w=1/0,direction:k,textAlign:I="left",textIndent:T=0,whiteSpace:J="normal",overflowWrap:b="normal",anchorX:P=0,anchorY:F=0,metricsOnly:Y=!1,unicodeFontsURL:V,preResolvedFonts:ee=null,includeCaretPositions:te=!1,chunkedBoundsSize:N=8192,colorRanges:L=null},p){const S=f(),C={fontLoad:0,typesetting:0};g.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),g=g.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),U=+U,_=+_,w=+w,D=D||"normal",T=+T,a({text:g,lang:y,style:x,weight:E,fonts:typeof m=="string"?[{src:m}]:m,unicodeFontsURL:V,preResolvedFonts:ee},M=>{C.fontLoad=f()-S;const A=isFinite(w);let W=null,O=null,j=null,K=null,oe=null,X=null,z=null,be=null,ge=0,q=0,se=J!=="nowrap";const he=new Map,H=f();let ie=T,re=0,G=new u;const ye=[G];M.forEach(le=>{const{fontObj:fe}=le,{ascender:pe,descender:xe,unitsPerEm:De,lineGap:Fe,capHeight:Se,xHeight:_e}=fe;let ce=he.get(fe);if(!ce){const $=U/De,Te=D==="normal"?(pe-xe+Fe)*$:D*U,Ie=(Te-(pe-xe)*$)/2,Ce=Math.min(Te,(pe-xe)*$),Ue=(pe+xe)/2*$+Ce/2;ce={index:he.size,src:fe.src,fontObj:fe,fontSizeMult:$,unitsPerEm:De,ascender:pe*$,descender:xe*$,capHeight:Se*$,xHeight:_e*$,lineHeight:Te,baseline:-Ie-pe*$,caretTop:Ue,caretBottom:Ue-Ce},he.set(fe,ce)}const{fontSizeMult:v}=ce,B=g.slice(le.start,le.end+1);let ae,ue;fe.forEachGlyph(B,U,_,($,Te,Ie,Ce)=>{Te+=re,Ce+=le.start,ae=Te,ue=$;const Ue=g.charAt(Ce),Ee=$.advanceWidth*v,we=G.count;let me;if("isEmpty"in $||($.isWhitespace=!!Ue&&new RegExp(t).test(Ue),$.canBreakAfter=!!Ue&&e.test(Ue),$.isEmpty=$.xMin===$.xMax||$.yMin===$.yMax||l.test(Ue)),!$.isWhitespace&&!$.isEmpty&&q++,se&&A&&!$.isWhitespace&&Te+Ee+ie>w&&we){if(G.glyphAt(we-1).glyphObj.canBreakAfter)me=new u,ie=-Te;else for(let Pe=we;Pe--;)if(Pe===0&&b==="break-word"){me=new u,ie=-Te;break}else if(G.glyphAt(Pe).glyphObj.canBreakAfter){me=G.splitAt(Pe+1);const Oe=me.glyphAt(0).x;ie-=Oe;for(let Le=me.count;Le--;)me.glyphAt(Le).x-=Oe;break}me&&(G.isSoftWrapped=!0,G=me,ye.push(G),ge=w)}let Ae=G.glyphAt(G.count);Ae.glyphObj=$,Ae.x=Te+ie,Ae.y=Ie,Ae.width=Ee,Ae.charIndex=Ce,Ae.fontData=ce,Ue===`
`&&(G=new u,ye.push(G),ie=-(Te+Ee+_*U)+T)}),re=ae+ue.advanceWidth*v+_*U});let Q=0;ye.forEach(le=>{let fe=!0;for(let pe=le.count;pe--;){const xe=le.glyphAt(pe);fe&&!xe.glyphObj.isWhitespace&&(le.width=xe.x+xe.width,le.width>ge&&(ge=le.width),fe=!1);let{lineHeight:De,capHeight:Fe,xHeight:Se,baseline:_e}=xe.fontData;De>le.lineHeight&&(le.lineHeight=De);const ce=_e-le.baseline;ce<0&&(le.baseline+=ce,le.cap+=ce,le.ex+=ce),le.cap=Math.max(le.cap,le.baseline+Fe),le.ex=Math.max(le.ex,le.baseline+Se)}le.baseline-=Q,le.cap-=Q,le.ex-=Q,Q+=le.lineHeight});let ne=0,Z=0;if(P&&(typeof P=="number"?ne=-P:typeof P=="string"&&(ne=-ge*(P==="left"?0:P==="center"?.5:P==="right"?1:i(P)))),F&&(typeof F=="number"?Z=-F:typeof F=="string"&&(Z=F==="top"?0:F==="top-baseline"?-ye[0].baseline:F==="top-cap"?-ye[0].cap:F==="top-ex"?-ye[0].ex:F==="middle"?Q/2:F==="bottom"?Q:F==="bottom-baseline"?-ye[ye.length-1].baseline:i(F)*Q)),!Y){const le=r.getEmbeddingLevels(g,k);W=new Uint16Array(q),O=new Uint8Array(q),j=new Float32Array(q*2),K={},z=[1/0,1/0,-1/0,-1/0],be=[],te&&(X=new Float32Array(g.length*4)),L&&(oe=new Uint8Array(q*3));let fe=0,pe=-1,xe=-1,De,Fe;if(ye.forEach((Se,_e)=>{let{count:ce,width:v}=Se;if(ce>0){let B=0;for(let Ce=ce;Ce--&&Se.glyphAt(Ce).glyphObj.isWhitespace;)B++;let ae=0,ue=0;if(I==="center")ae=(ge-v)/2;else if(I==="right")ae=ge-v;else if(I==="justify"&&Se.isSoftWrapped){let Ce=0;for(let Ue=ce-B;Ue--;)Se.glyphAt(Ue).glyphObj.isWhitespace&&Ce++;ue=(ge-v)/Ce}if(ue||ae){let Ce=0;for(let Ue=0;Ue<ce;Ue++){let Ee=Se.glyphAt(Ue);const we=Ee.glyphObj;Ee.x+=ae+Ce,ue!==0&&we.isWhitespace&&Ue<ce-B&&(Ce+=ue,Ee.width+=ue)}}const $=r.getReorderSegments(g,le,Se.glyphAt(0).charIndex,Se.glyphAt(Se.count-1).charIndex);for(let Ce=0;Ce<$.length;Ce++){const[Ue,Ee]=$[Ce];let we=1/0,me=-1/0;for(let Ae=0;Ae<ce;Ae++)if(Se.glyphAt(Ae).charIndex>=Ue){let Pe=Ae,Oe=Ae;for(;Oe<ce;Oe++){let Le=Se.glyphAt(Oe);if(Le.charIndex>Ee)break;Oe<ce-B&&(we=Math.min(we,Le.x),me=Math.max(me,Le.x+Le.width))}for(let Le=Pe;Le<Oe;Le++){const He=Se.glyphAt(Le);He.x=me-(He.x+He.width-we)}break}}let Te;const Ie=Ce=>Te=Ce;for(let Ce=0;Ce<ce;Ce++){const Ue=Se.glyphAt(Ce);Te=Ue.glyphObj;const Ee=Te.index,we=le.levels[Ue.charIndex]&1;if(we){const me=r.getMirroredCharacter(g[Ue.charIndex]);me&&Ue.fontData.fontObj.forEachGlyph(me,0,0,Ie)}if(te){const{charIndex:me,fontData:Ae}=Ue,Pe=Ue.x+ne,Oe=Ue.x+Ue.width+ne;X[me*4]=we?Oe:Pe,X[me*4+1]=we?Pe:Oe,X[me*4+2]=Se.baseline+Ae.caretBottom+Z,X[me*4+3]=Se.baseline+Ae.caretTop+Z;const Le=me-pe;Le>1&&s(X,pe,Le),pe=me}if(L){const{charIndex:me}=Ue;for(;me>xe;)xe++,L.hasOwnProperty(xe)&&(Fe=L[xe])}if(!Te.isWhitespace&&!Te.isEmpty){const me=fe++,{fontSizeMult:Ae,src:Pe,index:Oe}=Ue.fontData,Le=K[Pe]||(K[Pe]={});Le[Ee]||(Le[Ee]={path:Te.path,pathBounds:[Te.xMin,Te.yMin,Te.xMax,Te.yMax]});const He=Ue.x+ne,qe=Ue.y+Se.baseline+Z;j[me*2]=He,j[me*2+1]=qe;const Ze=He+Te.xMin*Ae,$e=qe+Te.yMin*Ae,rt=He+Te.xMax*Ae,Je=qe+Te.yMax*Ae;Ze<z[0]&&(z[0]=Ze),$e<z[1]&&(z[1]=$e),rt>z[2]&&(z[2]=rt),Je>z[3]&&(z[3]=Je),me%N===0&&(De={start:me,end:me,rect:[1/0,1/0,-1/0,-1/0]},be.push(De)),De.end++;const Be=De.rect;if(Ze<Be[0]&&(Be[0]=Ze),$e<Be[1]&&(Be[1]=$e),rt>Be[2]&&(Be[2]=rt),Je>Be[3]&&(Be[3]=Je),W[me]=Ee,O[me]=Oe,L){const nt=me*3;oe[nt]=Fe>>16&255,oe[nt+1]=Fe>>8&255,oe[nt+2]=Fe&255}}}}}),X){const Se=g.length-pe;Se>1&&s(X,pe,Se)}}const ke=[];he.forEach(({index:le,src:fe,unitsPerEm:pe,ascender:xe,descender:De,lineHeight:Fe,capHeight:Se,xHeight:_e})=>{ke[le]={src:fe,unitsPerEm:pe,ascender:xe,descender:De,lineHeight:Fe,capHeight:Se,xHeight:_e}}),C.typesetting=f()-H,p({glyphIds:W,glyphFontIndices:O,glyphPositions:j,glyphData:K,fontData:ke,caretPositions:X,glyphColors:oe,chunkedBounds:be,fontSize:U,topBaseline:Z+ye[0].baseline,blockBounds:[ne,Z-Q,ne+ge,Z],visibleBounds:z,timings:C})})}function n(g,m){o({...g,metricsOnly:!0},y=>{const[R,U,E,x]=y.blockBounds;m({width:E-R,height:x-U})})}function i(g){let m=g.match(/^([\d.]+)%$/),y=m?parseFloat(m[1]):NaN;return isNaN(y)?0:y/100}function s(g,m,y){const R=g[m*4],U=g[m*4+1],E=g[m*4+2],x=g[m*4+3],_=(U-R)/y;for(let D=0;D<y;D++){const w=(m+D)*4;g[w]=R+_*D,g[w+1]=R+_*(D+1),g[w+2]=E,g[w+3]=x}}function f(){return(self.performance||Date).now()}function u(){this.data=[]}const d=["glyphObj","x","y","width","charIndex","fontData"];return u.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/d.length)},glyphAt(g){let m=u.flyweight;return m.data=this.data,m.index=g,m},splitAt(g){let m=new u;return m.data=this.data.splice(g*d.length),m}},u.flyweight=d.reduce((g,m,y,R)=>(Object.defineProperty(g,m,{get(){return this.data[this.index*d.length+y]},set(U){this.data[this.index*d.length+y]=U}}),g),{data:null,index:0}),{typeset:o,measure:n}}const ot=()=>(self.performance||Date).now(),Jt=wn();let pn;function Ia(c,r,h,l,t,e,a,o,n,i,s=!0){return s?Ba(c,r,h,l,t,e,a,o,n,i).then(null,f=>(pn||(console.warn("WebGL SDF generation failed, falling back to JS",f),pn=!0),gn(c,r,h,l,t,e,a,o,n,i))):gn(c,r,h,l,t,e,a,o,n,i)}const Kt=[],Ga=5;let Er=0;function En(){const c=ot();for(;Kt.length&&ot()-c<Ga;)Kt.shift()();Er=Kt.length?setTimeout(En,0):0}const Ba=(...c)=>new Promise((r,h)=>{Kt.push(()=>{const l=ot();try{Jt.webgl.generateIntoCanvas(...c),r({timing:ot()-l})}catch(t){h(t)}}),Er||(Er=setTimeout(En,0))}),Na=4,ja=2e3,vn={};let Wa=0;function gn(c,r,h,l,t,e,a,o,n,i){const s="TroikaTextSDFGenerator_JS_"+Wa++%Na;let f=vn[s];return f||(f=vn[s]={workerModule:dt({name:s,workerId:s,dependencies:[wn,ot],init(u,d){const g=u().javascript.generate;return function(...m){const y=d();return{textureData:g(...m),timing:d()-y}}},getTransferables(u){return[u.textureData.buffer]}}),requests:0,idleTimer:null}),f.requests++,clearTimeout(f.idleTimer),f.workerModule(c,r,h,l,t,e).then(({textureData:u,timing:d})=>{const g=ot(),m=new Uint8Array(u.length*4);for(let y=0;y<u.length;y++)m[y*4+i]=u[y];return Jt.webglUtils.renderImageData(a,m,o,n,c,r,1<<3-i),d+=ot()-g,--f.requests===0&&(f.idleTimer=setTimeout(()=>{ba(s)},ja)),{timing:d}})}function za(c){c._warm||(Jt.webgl.isSupported(c),c._warm=!0)}const Va=Jt.webglUtils.resizeWebGLCanvasWithoutClearing,kt={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},Ha=new Dt;function ht(){return(self.performance||Date).now()}const mn=Object.create(null);function An(c,r){c=Ka({},c);const h=ht(),l=[];if(c.font&&l.push({label:"user",src:Za(c.font)}),c.font=l,c.text=""+c.text,c.sdfGlyphSize=c.sdfGlyphSize||kt.sdfGlyphSize,c.unicodeFontsURL=c.unicodeFontsURL||kt.unicodeFontsURL,c.colorRanges!=null){let u={};for(let d in c.colorRanges)if(c.colorRanges.hasOwnProperty(d)){let g=c.colorRanges[d];typeof g!="number"&&(g=Ha.set(g).getHex()),u[d]=g}c.colorRanges=u}Object.freeze(c);const{textureWidth:t,sdfExponent:e}=kt,{sdfGlyphSize:a}=c,o=t/a*4;let n=mn[a];if(!n){const u=document.createElement("canvas");u.width=t,u.height=a*256/o,n=mn[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:u,sdfTexture:new ea(u,void 0,void 0,void 0,nn,nn),contextLost:!1,glyphsByFont:new Map},n.sdfTexture.generateMipmaps=!1,Ya(n)}const{sdfTexture:i,sdfCanvas:s}=n;Fn(c).then(u=>{const{glyphIds:d,glyphFontIndices:g,fontData:m,glyphPositions:y,fontSize:R,timings:U}=u,E=[],x=new Float32Array(d.length*4);let _=0,D=0;const w=ht(),k=m.map(P=>{let F=n.glyphsByFont.get(P.src);return F||n.glyphsByFont.set(P.src,F=new Map),F});d.forEach((P,F)=>{const Y=g[F],{src:V,unitsPerEm:ee}=m[Y];let te=k[Y].get(P);if(!te){const{path:C,pathBounds:M}=u.glyphData[V][P],A=Math.max(M[2]-M[0],M[3]-M[1])/a*(kt.sdfMargin*a+.5),W=n.glyphCount++,O=[M[0]-A,M[1]-A,M[2]+A,M[3]+A];k[Y].set(P,te={path:C,atlasIndex:W,sdfViewBox:O}),E.push(te)}const{sdfViewBox:N}=te,L=y[D++],p=y[D++],S=R/ee;x[_++]=L+N[0]*S,x[_++]=p+N[1]*S,x[_++]=L+N[2]*S,x[_++]=p+N[3]*S,d[F]=te.atlasIndex}),U.quads=(U.quads||0)+(ht()-w);const I=ht();U.sdf={};const T=s.height,J=Math.ceil(n.glyphCount/o),b=Math.pow(2,Math.ceil(Math.log2(J*a)));b>T&&(console.info(`Increasing SDF texture size ${T}->${b}`),Va(s,t,b),i.dispose()),Promise.all(E.map(P=>Dn(P,n,c.gpuAccelerateSDF).then(({timing:F})=>{U.sdf[P.atlasIndex]=F}))).then(()=>{E.length&&!n.contextLost&&(Cn(n),i.needsUpdate=!0),U.sdfTotal=ht()-I,U.total=ht()-h,r(Object.freeze({parameters:c,sdfTexture:i,sdfGlyphSize:a,sdfExponent:e,glyphBounds:x,glyphAtlasIndices:d,glyphColors:u.glyphColors,caretPositions:u.caretPositions,chunkedBounds:u.chunkedBounds,ascender:u.ascender,descender:u.descender,lineHeight:u.lineHeight,capHeight:u.capHeight,xHeight:u.xHeight,topBaseline:u.topBaseline,blockBounds:u.blockBounds,visibleBounds:u.visibleBounds,timings:u.timings}))})}),Promise.resolve().then(()=>{n.contextLost||za(s)})}function Dn({path:c,atlasIndex:r,sdfViewBox:h},{sdfGlyphSize:l,sdfCanvas:t,contextLost:e},a){if(e)return Promise.resolve({timing:-1});const{textureWidth:o,sdfExponent:n}=kt,i=Math.max(h[2]-h[0],h[3]-h[1]),s=Math.floor(r/4),f=s%(o/l)*l,u=Math.floor(s/(o/l))*l,d=r%4;return Ia(l,l,c,h,i,n,t,f,u,d,a)}function Ya(c){const r=c.sdfCanvas;r.addEventListener("webglcontextlost",h=>{console.log("Context Lost",h),h.preventDefault(),c.contextLost=!0}),r.addEventListener("webglcontextrestored",h=>{console.log("Context Restored",h),c.contextLost=!1;const l=[];c.glyphsByFont.forEach(t=>{t.forEach(e=>{l.push(Dn(e,c,!0))})}),Promise.all(l).then(()=>{Cn(c),c.sdfTexture.needsUpdate=!0})})}function Xa({font:c,characters:r,sdfGlyphSize:h},l){let t=Array.isArray(r)?r.join(`
`):""+r;An({font:c,sdfGlyphSize:h,text:t},l)}function Ka(c,r){for(let h in r)r.hasOwnProperty(h)&&(c[h]=r[h]);return c}let Ht;function Za(c){return Ht||(Ht=typeof document>"u"?{}:document.createElement("a")),Ht.href=c,Ht.href}function Cn(c){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:r,sdfTexture:h}=c,{width:l,height:t}=r,e=c.sdfCanvas.getContext("webgl");let a=h.image.data;(!a||a.length!==l*t*4)&&(a=new Uint8Array(l*t*4),h.image={width:l,height:t,data:a},h.flipY=!1,h.isDataTexture=!0),e.readPixels(0,0,l,t,e.RGBA,e.UNSIGNED_BYTE,a)}}const Ja=dt({name:"Typesetter",dependencies:[Ra,La,_a],init(c,r,h){return c(r,h())}}),Fn=dt({name:"Typesetter",dependencies:[Ja],init(c){return function(r){return new Promise(h=>{c.typeset(r,h)})}},getTransferables(c){const r=[];for(let h in c)c[h]&&c[h].buffer&&r.push(c[h].buffer);return r}});Fn.onMainThread;const yn={};function Qa(c){let r=yn[c];return r||(r=yn[c]=new Dr(1,1,c,c).translate(.5,.5,0)),r}const qa="aTroikaGlyphBounds",bn="aTroikaGlyphIndex",$a="aTroikaGlyphColor";class eo extends Qn{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new qn,this.boundingBox=new Tn}computeBoundingSphere(){}computeBoundingBox(){}set detail(r){if(r!==this._detail){this._detail=r,(typeof r!="number"||r<1)&&(r=1);let h=Qa(r);["position","normal","uv"].forEach(l=>{this.attributes[l]=h.attributes[l].clone()}),this.setIndex(h.getIndex().clone())}}get detail(){return this._detail}set curveRadius(r){r!==this._curveRadius&&(this._curveRadius=r,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(r,h,l,t,e){this.updateAttributeData(qa,r,4),this.updateAttributeData(bn,h,1),this.updateAttributeData($a,e,3),this._blockBounds=l,this._chunkedBounds=t,this.instanceCount=h.length,this._updateBounds()}_updateBounds(){const r=this._blockBounds;if(r){const{curveRadius:h,boundingBox:l}=this;if(h){const{PI:t,floor:e,min:a,max:o,sin:n,cos:i}=Math,s=t/2,f=t*2,u=Math.abs(h),d=r[0]/u,g=r[2]/u,m=e((d+s)/f)!==e((g+s)/f)?-u:a(n(d)*u,n(g)*u),y=e((d-s)/f)!==e((g-s)/f)?u:o(n(d)*u,n(g)*u),R=e((d+t)/f)!==e((g+t)/f)?u*2:o(u-i(d)*u,u-i(g)*u);l.min.set(m,r[1],h<0?-R:0),l.max.set(y,r[3],h<0?0:R)}else l.min.set(r[0],r[1],0),l.max.set(r[2],r[3],0);l.getBoundingSphere(this.boundingSphere)}}applyClipRect(r){let h=this.getAttribute(bn).count,l=this._chunkedBounds;if(l)for(let t=l.length;t--;){h=l[t].end;let e=l[t].rect;if(e[1]<r.w&&e[3]>r.y&&e[0]<r.z&&e[2]>r.x)break}this.instanceCount=h}updateAttributeData(r,h,l){const t=this.getAttribute(r);h?t&&t.array.length===h.length?(t.array.set(h),t.needsUpdate=!0):(this.setAttribute(r,new $n(h,l)),delete this._maxInstanceCount,this.dispose()):t&&this.deleteAttribute(r)}}const to=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,ro=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,no=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,ao=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function oo(c){const r=kr(c,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Ne},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new an(0,0,0,0)},uTroikaClipRect:{value:new an(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Ne},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Dt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new ta},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:to,vertexTransform:ro,fragmentDefs:no,fragmentColorTransform:ao,customRewriter({vertexShader:h,fragmentShader:l}){let t=/\buniform\s+vec3\s+diffuse\b/;return t.test(l)&&(l=l.replace(t,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),t.test(h)||(h=h.replace(kn,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:h,fragmentShader:l}}});return r.transparent=!0,r.forceSinglePass=!0,Object.defineProperties(r,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),r}const Fr=new Zn({color:16777215,side:Tr,transparent:!0}),xn=8421504,_n=new Jn,Yt=new ze,xr=new ze,Ut=[],io=new ze,_r="+x+y";function Sn(c){return Array.isArray(c)?c[0]:c}let Mn=()=>{const c=new Ar(new Dr(1,1),Fr);return Mn=()=>c,c},Pn=()=>{const c=new Ar(new Dr(1,1,32,1),Fr);return Pn=()=>c,c};const so={type:"syncstart"},lo={type:"synccomplete"},On=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],fo=On.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Ln=class extends Ar{constructor(){const r=new eo;super(r,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=xn,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=_r,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(r){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(r):(this._isSyncing=!0,this.dispatchEvent(so),An({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},h=>{this._isSyncing=!1,this._textRenderInfo=h,this.geometry.updateGlyphs(h.glyphBounds,h.glyphAtlasIndices,h.blockBounds,h.chunkedBounds,h.glyphColors);const l=this._queuedSyncs;l&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{l.forEach(t=>t&&t())})),this.dispatchEvent(lo),r&&r()})))}onBeforeRender(r,h,l,t,e,a){this.sync(),e.isTroikaTextMaterial&&this._prepareForRender(e)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(r){return oo(r)}get material(){let r=this._derivedMaterial;const h=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Fr.clone());if((!r||!r.isDerivedFrom(h))&&(r=this._derivedMaterial=this.createDerivedMaterial(h),h.addEventListener("dispose",function l(){h.removeEventListener("dispose",l),r.dispose()})),this.hasOutline()){let l=r._outlineMtl;return l||(l=r._outlineMtl=Object.create(r,{id:{value:r.id+.1}}),l.isTextOutlineMaterial=!0,l.depthWrite=!1,l.map=null,r.addEventListener("dispose",function t(){r.removeEventListener("dispose",t),l.dispose()})),[l,r]}else return r}set material(r){r&&r.isTroikaTextMaterial?(this._derivedMaterial=r,this._baseMaterial=r.baseMaterial):this._baseMaterial=r}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(r){this.geometry.detail=r}get curveRadius(){return this.geometry.curveRadius}set curveRadius(r){this.geometry.curveRadius=r}get customDepthMaterial(){return Sn(this.material).getDepthMaterial()}set customDepthMaterial(r){}get customDistanceMaterial(){return Sn(this.material).getDistanceMaterial()}set customDistanceMaterial(r){}_prepareForRender(r){const h=r.isTextOutlineMaterial,l=r.uniforms,t=this.textRenderInfo;if(t){const{sdfTexture:o,blockBounds:n}=t;l.uTroikaSDFTexture.value=o,l.uTroikaSDFTextureSize.value.set(o.image.width,o.image.height),l.uTroikaSDFGlyphSize.value=t.sdfGlyphSize,l.uTroikaSDFExponent.value=t.sdfExponent,l.uTroikaTotalBounds.value.fromArray(n),l.uTroikaUseGlyphColors.value=!h&&!!t.glyphColors;let i=0,s=0,f=0,u,d,g,m=0,y=0;if(h){let{outlineWidth:U,outlineOffsetX:E,outlineOffsetY:x,outlineBlur:_,outlineOpacity:D}=this;i=this._parsePercent(U)||0,s=Math.max(0,this._parsePercent(_)||0),u=D,m=this._parsePercent(E)||0,y=this._parsePercent(x)||0}else f=Math.max(0,this._parsePercent(this.strokeWidth)||0),f&&(g=this.strokeColor,l.uTroikaStrokeColor.value.set(g??xn),d=this.strokeOpacity,d==null&&(d=1)),u=this.fillOpacity;l.uTroikaEdgeOffset.value=i,l.uTroikaPositionOffset.value.set(m,y),l.uTroikaBlurRadius.value=s,l.uTroikaStrokeWidth.value=f,l.uTroikaStrokeOpacity.value=d,l.uTroikaFillOpacity.value=u??1,l.uTroikaCurveRadius.value=this.curveRadius||0;let R=this.clipRect;if(R&&Array.isArray(R)&&R.length===4)l.uTroikaClipRect.value.fromArray(R);else{const U=(this.fontSize||.1)*100;l.uTroikaClipRect.value.set(n[0]-U,n[1]-U,n[2]+U,n[3]+U)}this.geometry.applyClipRect(l.uTroikaClipRect.value)}l.uTroikaSDFDebug.value=!!this.debugSDF,r.polygonOffset=!!this.depthOffset,r.polygonOffsetFactor=r.polygonOffsetUnits=this.depthOffset||0;const e=h?this.outlineColor||0:this.color;if(e==null)delete r.color;else{const o=r.hasOwnProperty("color")?r.color:r.color=new Dt;(e!==o._input||typeof e=="object")&&o.set(o._input=e)}let a=this.orientation||_r;if(a!==r._orientation){let o=l.uTroikaOrient.value;a=a.replace(/[^-+xyz]/g,"");let n=a!==_r&&a.match(/^([-+])([xyz])([-+])([xyz])$/);if(n){let[,i,s,f,u]=n;Yt.set(0,0,0)[s]=i==="-"?1:-1,xr.set(0,0,0)[u]=f==="-"?-1:1,_n.lookAt(io,Yt.cross(xr),xr),o.setFromMatrix4(_n)}else o.identity();r._orientation=a}}_parsePercent(r){if(typeof r=="string"){let h=r.match(/^(-?[\d.]+)%$/),l=h?parseFloat(h[1]):NaN;r=(isNaN(l)?0:l/100)*this.fontSize}return r}localPositionToTextCoords(r,h=new Ne){h.copy(r);const l=this.curveRadius;return l&&(h.x=Math.atan2(r.x,Math.abs(l)-Math.abs(r.z))*Math.abs(l)),h}worldPositionToTextCoords(r,h=new Ne){return Yt.copy(r),this.localPositionToTextCoords(this.worldToLocal(Yt),h)}raycast(r,h){const{textRenderInfo:l,curveRadius:t}=this;if(l){const e=l.blockBounds,a=t?Pn():Mn(),o=a.geometry,{position:n,uv:i}=o.attributes;for(let s=0;s<i.count;s++){let f=e[0]+i.getX(s)*(e[2]-e[0]);const u=e[1]+i.getY(s)*(e[3]-e[1]);let d=0;t&&(d=t-Math.cos(f/t)*t,f=Math.sin(f/t)*t),n.setXYZ(s,f,u,d)}o.boundingSphere=this.geometry.boundingSphere,o.boundingBox=this.geometry.boundingBox,a.matrixWorld=this.matrixWorld,a.material.side=this.material.side,Ut.length=0,a.raycast(r,Ut);for(let s=0;s<Ut.length;s++)Ut[s].object=this,h.push(Ut[s])}}copy(r){const h=this.geometry;return super.copy(r),this.geometry=h,fo.forEach(l=>{this[l]=r[l]}),this}clone(){return new this.constructor().copy(this)}};On.forEach(c=>{const r="_private_"+c;Object.defineProperty(Ln.prototype,c,{get(){return this[r]},set(h){h!==this[r]&&(this[r]=h,this._needsSync=!0)}})});new Tn;new Dt;const uo=Re.forwardRef(({sdfGlyphSize:c=64,anchorX:r="center",anchorY:h="middle",font:l,fontSize:t=1,children:e,characters:a,onSync:o,...n},i)=>{const s=Qe(({invalidate:g})=>g),[f]=Re.useState(()=>new Ln),[u,d]=Re.useMemo(()=>{const g=[];let m="";return Re.Children.forEach(e,y=>{typeof y=="string"||typeof y=="number"?m+=y:g.push(y)}),[g,m]},[e]);return ia(()=>new Promise(g=>Xa({font:l,characters:a},g)),["troika-text",l,a]),Re.useLayoutEffect(()=>void f.sync(()=>{s(),o&&o(f)})),Re.useEffect(()=>()=>f.dispose(),[f]),Re.createElement("primitive",Zt({object:f,ref:i,font:l,text:d,anchorX:r,anchorY:h,fontSize:t,sdfGlyphSize:c},n),u)}),co=Re.forwardRef(({makeDefault:c,camera:r,regress:h,domElement:l,enableDamping:t=!0,keyEvents:e=!1,onChange:a,onStart:o,onEnd:n,...i},s)=>{const f=Qe(D=>D.invalidate),u=Qe(D=>D.camera),d=Qe(D=>D.gl),g=Qe(D=>D.events),m=Qe(D=>D.setEvents),y=Qe(D=>D.set),R=Qe(D=>D.get),U=Qe(D=>D.performance),E=r||u,x=l||g.connected||d.domElement,_=Re.useMemo(()=>new pa(E),[E]);return Cr(()=>{_.enabled&&_.update()},-1),Re.useEffect(()=>(e&&_.connect(e===!0?x:e),_.connect(x),()=>void _.dispose()),[e,x,h,_,f]),Re.useEffect(()=>{const D=I=>{f(),h&&U.regress(),a&&a(I)},w=I=>{o&&o(I)},k=I=>{n&&n(I)};return _.addEventListener("change",D),_.addEventListener("start",w),_.addEventListener("end",k),()=>{_.removeEventListener("start",w),_.removeEventListener("end",k),_.removeEventListener("change",D)}},[a,o,n,_,f,m]),Re.useEffect(()=>{if(c){const D=R().controls;return y({controls:_}),()=>y({controls:D})}},[c,_]),Re.createElement("primitive",Zt({ref:s,object:_,enableDamping:t},i))}),Mr=[{id:"B7",name:"Cognitive Sovereignty",domain:"Biology",color:"#8b5cf6",description:"Identity, agency, and cognitive liberty"},{id:"B6",name:"Neural Semantics",domain:"Biology",color:"#10b981",description:"Meaning extraction, pattern interpretation"},{id:"B5",name:"Signal Processing",domain:"Biology",color:"#06b6d4",description:"Neural signal acquisition and preprocessing"},{id:"I0",name:"Neural Gateway",domain:"Interface",color:"#f59e0b",description:"Physical interface  BCI device at tissue boundary"},{id:"B3",name:"Protocol Security",domain:"Silicon",color:"#3b82f6",description:"Communication protocols, encryption, authentication"},{id:"B2",name:"Network Transport",domain:"Silicon",color:"#3b82f6",description:"Data transport, routing, network security"},{id:"B1",name:"Physical Layer",domain:"Silicon",color:"#3b82f6",description:"Hardware, firmware, physical security"}],ho=[1.4,1.2,1,.7,1,1.2,1.4],wt=.35,Sr=.08;function po({band:c,index:r,radius:h,isHovered:l,onHover:t}){const e=Re.useRef(null),o=(Mr.length*(wt+Sr)-Sr)/2-r*(wt+Sr)-wt/2,n=Re.useMemo(()=>new Dt(c.color),[c.color]);return Cr(()=>{if(!e.current)return;const i=l?1.05:1;e.current.scale.x=on.lerp(e.current.scale.x,i,.1),e.current.scale.z=on.lerp(e.current.scale.z,i,.1)}),Me.jsxs("group",{position:[0,o,0],children:[Me.jsxs("mesh",{ref:e,onPointerEnter:()=>t(r),onPointerLeave:()=>t(null),children:[Me.jsx("cylinderGeometry",{args:[h,h,wt,32]}),Me.jsx("meshStandardMaterial",{color:n,transparent:!0,opacity:l?.5:.25,roughness:.3,metalness:.1,side:Tr})]}),Me.jsxs("mesh",{rotation:[Math.PI/2,0,0],position:[0,wt/2,0],children:[Me.jsx("ringGeometry",{args:[h-.02,h,64]}),Me.jsx("meshBasicMaterial",{color:n,transparent:!0,opacity:l?.8:.3,side:Tr})]}),Me.jsxs(uo,{position:[h+.3,0,0],fontSize:.12,color:l?"#e2e8f0":"#94a3b8",anchorX:"left",anchorY:"middle",font:"/fonts/Inter-Variable.woff2",children:[c.id,"  ",c.name]})]})}function vo({onBandHover:c}){const[r,h]=Re.useState(null),l=Re.useRef(null);Cr((e,a)=>{l.current&&r===null&&(l.current.rotation.y+=a*.15)});const t=e=>{h(e),c(e)};return Me.jsxs(Me.Fragment,{children:[Me.jsx("ambientLight",{intensity:.4}),Me.jsx("pointLight",{position:[5,5,5],intensity:.6}),Me.jsx("pointLight",{position:[-5,-5,-5],intensity:.3,color:"#8b5cf6"}),Me.jsx("group",{ref:l,children:Mr.map((e,a)=>Me.jsx(po,{band:e,index:a,radius:ho[a],isHovered:r===a,onHover:t},e.id))}),Me.jsx(co,{enableZoom:!1,enablePan:!1,minPolarAngle:Math.PI/4,maxPolarAngle:Math.PI*3/4,autoRotate:!1})]})}function xo(){const[c,r]=Re.useState(null),h=c!==null?Mr[c]:null;return Me.jsxs("div",{style:{position:"relative",width:"100%",height:"500px"},children:[Me.jsx(ra,{camera:{position:[0,.5,4],fov:45},dpr:[1,2],gl:{antialias:!0,alpha:!0},style:{background:"transparent"},children:Me.jsx(vo,{onBandHover:r})}),h&&Me.jsxs("div",{style:{position:"absolute",bottom:"16px",left:"50%",transform:"translateX(-50%)",background:"rgba(15, 20, 32, 0.85)",backdropFilter:"blur(12px)",border:`1px solid ${h.color}40`,borderRadius:"12px",padding:"12px 20px",maxWidth:"400px",textAlign:"center",pointerEvents:"none"},children:[Me.jsxs("div",{style:{fontSize:"12px",fontFamily:"monospace",color:h.color,marginBottom:"4px"},children:[h.id,"  ",h.domain]}),Me.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#e2e8f0",marginBottom:"4px"},children:h.name}),Me.jsx("div",{style:{fontSize:"13px",color:"#94a3b8"},children:h.description})]})]})}export{xo as default};
