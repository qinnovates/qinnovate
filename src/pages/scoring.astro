---
import PageLayout from '../layouts/PageLayout.astro';
import { NISS_SPEC, THREAT_VECTORS, getNissStats } from '../lib/threat-data';

const spec = NISS_SPEC as any;
const nissStats = getNissStats();
const totalTechniques = THREAT_VECTORS.length;

// NISS v1.0 Extension Metrics (5 metrics that extend CVSS v4.0)
const extensionMetrics = [
  {
    id: 'BI', name: 'Biological Impact', weight: 3.0,
    description: 'Direct harm to neural tissue, organs, or physiological function. This dimension has no equivalent in CVSS. It captures seizure induction, tissue damage, involuntary motor activation, and other physical consequences unique to devices that interface with biology.',
    values: [
      { code: 'N', label: 'None', description: 'No tissue interaction or physical harm.' },
      { code: 'L', label: 'Low', description: 'Temporary discomfort, minor sensory disruption, reversible tissue stress.' },
      { code: 'M', label: 'Medium', description: 'Moderate physiological disruption requiring monitoring or intervention.' },
      { code: 'H', label: 'High', description: 'Significant tissue damage, seizure induction, involuntary motor activation. Triggers PINS flag.' },
      { code: 'C', label: 'Critical', description: 'Life-threatening or permanently disabling neural harm. Triggers PINS flag.' },
    ],
  },
  {
    id: 'CG', name: 'Cognitive Integrity', weight: 2.5,
    description: 'Impact on thought processes, perception, memory, identity, or decision-making. CVSS has no concept of thought privacy or cognitive autonomy. CG captures everything from partial intent decoding to full perception manipulation.',
    values: [
      { code: 'N', label: 'None', description: 'No cognitive impact.' },
      { code: 'L', label: 'Low', description: 'Decoded intent partially exposed, minor perceptual distortion.' },
      { code: 'M', label: 'Medium', description: 'Significant cognitive state inference or moderate perception manipulation.' },
      { code: 'H', label: 'High', description: 'Full thought decoding, identity inference, or perception manipulation.' },
      { code: 'C', label: 'Critical', description: 'Cognitive coercion, identity modification, or complete loss of cognitive autonomy.' },
    ],
  },
  {
    id: 'CV', name: 'Consent Violation', weight: 2.0,
    description: 'Degree of violation of informed consent or cognitive autonomy. CVSS does not model consent boundaries. CV captures the difference between operating within assumed consent and covert neural manipulation.',
    values: [
      { code: 'N', label: 'None', description: 'Operating within explicitly consented boundaries.' },
      { code: 'P', label: 'Partial', description: 'Action exceeds scope of original consent but remains within reasonable expectations.' },
      { code: 'E', label: 'Explicit', description: 'Clear violation of explicitly stated consent boundaries.' },
      { code: 'I', label: 'Implicit (covert)', description: 'Covert manipulation the patient cannot detect or know to refuse.' },
    ],
  },
  {
    id: 'RV', name: 'Reversibility', weight: 1.5,
    description: 'Whether the damage caused by the attack can be undone. IT assets can be restored from backup. Neural tissue cannot be rebooted. RV captures the permanence gradient from fully reversible to irreversible neural harm.',
    values: [
      { code: 'F', label: 'Full', description: 'Effects fully reverse when attack stops (e.g., jamming, temporary interference).' },
      { code: 'T', label: 'Temporary', description: 'Effects reverse over hours to days (e.g., neuroplastic adaptation after prolonged stimulation).' },
      { code: 'P', label: 'Partial', description: 'Some effects permanent, some reversible (e.g., partial tissue scarring with functional recovery).' },
      { code: 'I', label: 'Irreversible', description: 'Permanent damage — neural tissue destruction, irreversible cognitive change. Triggers PINS flag.' },
    ],
  },
  {
    id: 'NP', name: 'Neuroplasticity', weight: 1.0,
    description: 'Whether the attack exploits or induces neuroplastic changes — the brain\'s ability to rewire itself. Prolonged exposure to adversarial stimulation can cause lasting structural changes. This has no digital equivalent.',
    values: [
      { code: 'N', label: 'None', description: 'No neuroplastic effect.' },
      { code: 'L', label: 'Low', description: 'Minor or transient plasticity effects.' },
      { code: 'M', label: 'Medium', description: 'Moderate neuroplastic reorganization requiring monitoring.' },
      { code: 'H', label: 'High', description: 'Significant neuroplastic reorganization — altered neural pathways, changed sensory processing.' },
      { code: 'T', label: 'Therapeutic', description: 'Neuroplastic effect consistent with therapeutic intent (relevant for TARA dual-use mapping).' },
    ],
  },
];

const severityLevels = [
  { range: '9.0 – 10.0', label: 'Critical', color: '#ef4444', description: 'Immediate risk of irreversible neural harm, full cognitive compromise, or life-threatening physical safety failure.' },
  { range: '7.0 – 8.9', label: 'High', color: '#f97316', description: 'Significant biological impact, serious cognitive integrity violation, or widespread data exfiltration with lasting consequences.' },
  { range: '4.0 – 6.9', label: 'Medium', color: '#f59e0b', description: 'Moderate impact — reversible biological effects, partial data exposure, or attacks requiring specialized conditions.' },
  { range: '0.1 – 3.9', label: 'Low', color: '#10b981', description: 'Minor impact — temporary disruption, limited data exposure, or attacks requiring high privilege and physical access.' },
  { range: '0.0', label: 'None', color: '#94a3b8', description: 'Informational. No measurable impact on biological, cognitive, or information security.' },
];

// PINS-flagged count
const pinsFlagged = THREAT_VECTORS.filter(t => t.niss?.pins).length;
---

<PageLayout
  title="NISS Scoring"
  description="Neural Impact Scoring System — the first CVSS v4.0 extension for brain-computer interface security."
  breadcrumbs={[{ label: 'NISS Scoring' }]}
  maxWidth="wide"
>
  <div class="lg:grid lg:grid-cols-[240px_1fr] lg:gap-12">
    <!-- Sidebar (sticky TOC) -->
    <aside class="hidden lg:block">
      <nav class="sticky top-24 space-y-1" aria-label="Table of contents">
        <p class="text-xs font-semibold tracking-wider uppercase text-[var(--color-text-faint)] mb-3">On this page</p>
        {[
          { href: '#overview', label: 'Overview' },
          { href: '#architecture', label: 'Architecture' },
          { href: '#gap-analysis', label: 'Gap Analysis' },
          { href: '#metrics', label: 'Extension Metrics' },
          { href: '#pins', label: 'PINS Flag' },
          { href: '#formula', label: 'Formula' },
          { href: '#severity', label: 'Severity Levels' },
          { href: '#vector', label: 'Vector Format' },
          { href: '#examples', label: 'Examples' },
        ].map((item) => (
          <a href={item.href} class="block text-sm py-1.5 text-[var(--color-text-muted)] hover:text-[var(--color-accent-primary)] transition-colors border-l-2 border-transparent hover:border-[var(--color-accent-primary)] pl-3">
            {item.label}
          </a>
        ))}
      </nav>
    </aside>

    <!-- Main content -->
    <div class="max-w-3xl">

      <!-- Overview -->
      <section id="overview" class="mb-20">
        <h1 class="text-3xl sm:text-4xl font-bold font-[family-name:var(--font-heading)] mb-4">
          Neural Impact Scoring System <span class="text-[var(--color-accent-primary)]">v1.0</span>
        </h1>
        <div class="flex flex-wrap items-center gap-3 mb-6">
          <span class="text-xs font-semibold px-3 py-1 rounded-full border border-[var(--color-accent-secondary)] text-[var(--color-accent-secondary)]">
            CVSS v4.0 Extension
          </span>
          <span class="text-xs font-semibold px-3 py-1 rounded-full border border-[var(--color-accent-tertiary)] text-[var(--color-accent-tertiary)]">
            FIRST.org §3.11
          </span>
          <span class="text-xs font-semibold px-3 py-1 rounded-full border border-[var(--color-text-faint)]/30 text-[var(--color-text-faint)]">
            5 Extension Metrics · {totalTechniques} Techniques Scored
          </span>
        </div>
        <div class="prose">
          <p class="text-lg text-[var(--color-text-muted)]">
            NISS is the first CVSS v4.0 extension designed for brain-computer interface security. Following FIRST.org's extension framework (CVSS v4.0 User Guide §3.11), NISS adds five neural-specific metrics that ride <strong>alongside</strong> CVSS v4.0 base vectors — not replace them.
          </p>
          <p>
            Every technique in the <a href="/TARA/">TARA registry</a> carries both a CVSS v4.0 base vector (exploitability and system impact) and a NISS extension vector (biological, cognitive, and consent impact). The two together give the complete picture: how the attack works <em>and</em> what it does to the patient.
          </p>
        </div>

        <!-- Stats row -->
        <div class="grid grid-cols-2 sm:grid-cols-5 gap-4 mt-8">
          <div class="glass rounded-xl p-4 text-center">
            <div class="text-2xl font-bold font-[family-name:var(--font-heading)] text-[var(--color-accent-primary)]">{totalTechniques}</div>
            <div class="text-xs text-[var(--color-text-faint)] mt-1">Techniques</div>
          </div>
          <div class="glass rounded-xl p-4 text-center">
            <div class="text-2xl font-bold font-[family-name:var(--font-heading)]" style="color: #f97316;">{nissStats.high}</div>
            <div class="text-xs text-[var(--color-text-faint)] mt-1">High</div>
          </div>
          <div class="glass rounded-xl p-4 text-center">
            <div class="text-2xl font-bold font-[family-name:var(--font-heading)]" style="color: #f59e0b;">{nissStats.medium}</div>
            <div class="text-xs text-[var(--color-text-faint)] mt-1">Medium</div>
          </div>
          <div class="glass rounded-xl p-4 text-center">
            <div class="text-2xl font-bold font-[family-name:var(--font-heading)]" style="color: #10b981;">{nissStats.low}</div>
            <div class="text-xs text-[var(--color-text-faint)] mt-1">Low</div>
          </div>
          <div class="glass rounded-xl p-4 text-center">
            <div class="text-2xl font-bold font-[family-name:var(--font-heading)]" style="color: #ef4444;">{pinsFlagged}</div>
            <div class="text-xs text-[var(--color-text-faint)] mt-1">PINS Flagged</div>
          </div>
        </div>
      </section>

      <!-- Architecture -->
      <section id="architecture" class="mb-20">
        <h2 class="text-2xl font-bold font-[family-name:var(--font-heading)] mb-6">Architecture: Extending CVSS, Not Replacing It</h2>
        <div class="prose mb-8">
          <p>
            CVSS v4.0 provides a robust framework for scoring exploitability and system impact. NISS does not duplicate that work. Instead, it follows FIRST.org's official extension mechanism (§3.11) to add five metrics that capture dimensions CVSS was never designed to express.
          </p>
          <p>
            Every scored technique carries <strong>two vectors</strong> side by side:
          </p>
        </div>

        <div class="space-y-3 mb-6">
          <div class="glass rounded-xl p-5 border-l-4 border-[var(--color-accent-primary)]">
            <p class="text-sm font-semibold text-[var(--color-text-primary)] mb-1">CVSS v4.0 Base Vector</p>
            <p class="font-[family-name:var(--font-mono)] text-xs text-[var(--color-accent-primary)] break-all">CVSS:4.0/AV:&lt;V&gt;/AC:&lt;V&gt;/AT:&lt;V&gt;/PR:&lt;V&gt;/UI:&lt;V&gt;/VC:&lt;V&gt;/VI:&lt;V&gt;/VA:&lt;V&gt;/SC:&lt;V&gt;/SI:&lt;V&gt;/SA:&lt;V&gt;</p>
            <p class="text-xs text-[var(--color-text-faint)] mt-2">How the attack works: vector, complexity, privileges, user interaction, system impact</p>
          </div>
          <div class="glass rounded-xl p-5 border-l-4 border-[var(--color-accent-tertiary)]">
            <p class="text-sm font-semibold text-[var(--color-text-primary)] mb-1">NISS v1.0 Extension Vector</p>
            <p class="font-[family-name:var(--font-mono)] text-xs text-[var(--color-accent-tertiary)] break-all">NISS:1.0/BI:&lt;V&gt;/CG:&lt;V&gt;/CV:&lt;V&gt;/RV:&lt;V&gt;/NP:&lt;V&gt;</p>
            <p class="text-xs text-[var(--color-text-faint)] mt-2">What it does to the patient: biological harm, cognitive impact, consent violation, reversibility, neuroplasticity</p>
          </div>
        </div>

        <div class="prose">
          <p>
            This dual-vector architecture means security teams can triage using familiar CVSS scores, while BCI-specific teams see the neural dimensions that determine whether a vulnerability is a software bug or a patient safety emergency.
          </p>
        </div>
      </section>

      <!-- Gap Analysis -->
      <section id="gap-analysis" class="mb-20">
        <h2 class="text-2xl font-bold font-[family-name:var(--font-heading)] mb-6">Gap Analysis: Why CVSS Alone Is Insufficient</h2>
        <div class="prose mb-8">
          <p>
            Qinnovate mapped all {totalTechniques} TARA techniques to CVSS v4.0 base vectors. The result: <strong>94.4% cannot be fully scored by CVSS alone</strong>. Each technique falls into one of three gap groups:
          </p>
        </div>

        <div class="grid gap-4 sm:grid-cols-3 mb-8">
          <div class="glass rounded-xl p-5 border-t-4 border-[var(--color-accent-secondary)]">
            <div class="text-3xl font-bold font-[family-name:var(--font-heading)] text-[var(--color-accent-secondary)]">4</div>
            <div class="text-sm font-semibold mb-2">Gap Group 1</div>
            <p class="text-xs text-[var(--color-text-muted)]">CVSS v4.0 sufficient. Base metrics fully capture the vulnerability. Pure-silicon attacks (firmware, supply chain) with no biological component.</p>
          </div>
          <div class="glass rounded-xl p-5 border-t-4" style="border-color: #f59e0b;">
            <div class="text-3xl font-bold font-[family-name:var(--font-heading)]" style="color: #f59e0b;">17</div>
            <div class="text-sm font-semibold mb-2">Gap Group 2</div>
            <p class="text-xs text-[var(--color-text-muted)]">CVSS + Safety partial. Base metrics capture exploitability but miss biological or cognitive impact. Supplemental Safety metric helps but is insufficient.</p>
          </div>
          <div class="glass rounded-xl p-5 border-t-4 border-[var(--color-accent-primary)]">
            <div class="text-3xl font-bold font-[family-name:var(--font-heading)] text-[var(--color-accent-primary)]">50</div>
            <div class="text-sm font-semibold mb-2">Gap Group 3</div>
            <p class="text-xs text-[var(--color-text-muted)]">NISS required. Vulnerability cannot be meaningfully scored without extension metrics. Tissue interaction, cognitive manipulation, consent violation, or neuroplastic effects.</p>
          </div>
        </div>

        <div class="grid gap-4 sm:grid-cols-2">
          {[
            { gap: 'No biological impact metric', detail: 'CVSS cannot distinguish between a server crash and a seizure. NISS adds Biological Impact (BI) — weight 3.0, the highest.' },
            { gap: 'No cognitive integrity metric', detail: 'CVSS has no concept of thought privacy or perception manipulation. NISS adds Cognitive Integrity (CG) — weight 2.5.' },
            { gap: 'No consent model', detail: 'CVSS does not model informed consent or cognitive liberty. NISS adds Consent Violation (CV) — weight 2.0.' },
            { gap: 'No reversibility dimension', detail: 'IT assets restore from backup. Neural tissue cannot. NISS adds Reversibility (RV) — weight 1.5.' },
            { gap: 'No neuroplasticity tracking', detail: 'Prolonged adversarial stimulation physically rewires the brain. NISS adds Neuroplasticity (NP) — weight 1.0.' },
            { gap: 'Wrong priority weighting', detail: 'CVSS weights system metrics equally. NISS weights BI highest (3.0) because the endpoint is a person, not a server.' },
          ].map(item => (
            <div class="glass rounded-xl p-5">
              <h3 class="text-sm font-semibold font-[family-name:var(--font-heading)] text-[var(--color-accent-primary)] mb-2">{item.gap}</h3>
              <p class="text-sm text-[var(--color-text-muted)]">{item.detail}</p>
            </div>
          ))}
        </div>
      </section>

      <!-- Extension Metrics -->
      <section id="metrics" class="mb-20">
        <h2 class="text-2xl font-bold font-[family-name:var(--font-heading)] mb-2">Extension Metrics</h2>
        <p class="text-sm text-[var(--color-text-faint)] mb-6">5 dimensions &ensp;|&ensp; All unique to NISS &ensp;|&ensp; No CVSS equivalent</p>
        {extensionMetrics.map(metric => (
          <div class="mb-10">
            <h3 class="text-lg font-semibold font-[family-name:var(--font-heading)] mb-1">
              <span class="font-[family-name:var(--font-mono)] text-[var(--color-accent-primary)]">{metric.id}</span> — {metric.name}
              <span class="ml-2 text-xs font-semibold px-2 py-0.5 rounded-full bg-[var(--color-accent-primary)]/10 text-[var(--color-accent-primary)]">Weight: {metric.weight}</span>
            </h3>
            <p class="text-sm text-[var(--color-text-muted)] mb-3">{metric.description}</p>
            <div class="overflow-x-auto">
              <table class="w-full text-sm">
                <thead>
                  <tr class="border-b border-[var(--color-border)]">
                    <th class="py-2 px-3 text-left font-semibold text-xs text-[var(--color-text-faint)]">Code</th>
                    <th class="py-2 px-3 text-left font-semibold text-xs text-[var(--color-text-faint)]">Value</th>
                    <th class="py-2 px-3 text-left font-semibold text-xs text-[var(--color-text-faint)]">Description</th>
                  </tr>
                </thead>
                <tbody>
                  {metric.values.map(v => (
                    <tr class="border-b border-[var(--color-border)]/50">
                      <td class="py-2 px-3 font-[family-name:var(--font-mono)] text-[var(--color-accent-tertiary)] font-semibold">{v.code}</td>
                      <td class="py-2 px-3 font-semibold">{v.label}</td>
                      <td class="py-2 px-3 text-[var(--color-text-muted)]">{v.description}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        ))}
      </section>

      <!-- PINS Flag -->
      <section id="pins" class="mb-20">
        <h2 class="text-2xl font-bold font-[family-name:var(--font-heading)] mb-6">PINS Flag</h2>
        <div class="glass rounded-xl p-6 border-l-4 border-[#ef4444] mb-6">
          <p class="text-sm font-semibold text-[var(--color-text-primary)] mb-2">
            Potential Impact to Neural Safety (PINS)
          </p>
          <p class="font-[family-name:var(--font-mono)] text-sm text-[#ef4444] mb-3">
            PINS = true &ensp;when&ensp; BI &ge; High &ensp;OR&ensp; RV = Irreversible
          </p>
          <p class="text-sm text-[var(--color-text-muted)]">
            A boolean flag indicating the vulnerability may cause irreversible neural harm. When PINS is true, the technique triggers mandatory safety review regardless of the overall NISS score. {pinsFlagged} of {totalTechniques} techniques ({((pinsFlagged / totalTechniques) * 100).toFixed(0)}%) are PINS-flagged.
          </p>
        </div>
        <div class="prose">
          <p>
            PINS exists because a NISS score of 4.0 (medium) could still involve irreversible neural damage if the overall weighted average is pulled down by low consent or neuroplasticity scores. The flag catches this: any technique that can permanently alter neural tissue gets flagged for safety review, period.
          </p>
        </div>
      </section>

      <!-- Formula -->
      <section id="formula" class="mb-20">
        <h2 class="text-2xl font-bold font-[family-name:var(--font-heading)] mb-6">Scoring Formula</h2>
        <div class="glass rounded-xl p-8 text-center mb-6">
          <p class="text-lg font-[family-name:var(--font-mono)] text-[var(--color-accent-tertiary)] mb-4">
            NISS = (3.0&times;BI + 2.5&times;CG + 2.0&times;CV + 1.5&times;RV + 1.0&times;NP) / 10.0
          </p>
          <p class="text-sm text-[var(--color-text-faint)]">
            Score range: 0.0 – 10.0 &ensp;|&ensp; BI weighted highest (biological harm first)
          </p>
        </div>

        <div class="prose mb-6">
          <p>
            The weights reflect a deliberate priority ordering: <strong>biological harm first</strong> (BI = 3.0), then cognitive integrity (CG = 2.5), then consent (CV = 2.0), then reversibility (RV = 1.5), then neuroplasticity (NP = 1.0). A vulnerability that causes neural tissue damage always scores higher than one that violates consent alone.
          </p>
        </div>

        <div class="overflow-x-auto">
          <table class="w-full text-sm">
            <thead>
              <tr class="border-b border-[var(--color-border)]">
                <th class="py-2 px-3 text-left font-semibold text-xs text-[var(--color-text-faint)]">Metric</th>
                <th class="py-2 px-3 text-left font-semibold text-xs text-[var(--color-text-faint)]">Weight</th>
                <th class="py-2 px-3 text-left font-semibold text-xs text-[var(--color-text-faint)]">Share</th>
                <th class="py-2 px-3 text-left font-semibold text-xs text-[var(--color-text-faint)]">Rationale</th>
              </tr>
            </thead>
            <tbody>
              {[
                { id: 'BI', w: 3.0, share: '30%', why: 'Tissue damage is the most severe consequence — brains cannot be patched' },
                { id: 'CG', w: 2.5, share: '25%', why: 'Cognitive autonomy is the most personal asset a person has' },
                { id: 'CV', w: 2.0, share: '20%', why: 'Consent violation undermines the entire trust model for medical BCI' },
                { id: 'RV', w: 1.5, share: '15%', why: 'Permanence of damage amplifies all other impacts' },
                { id: 'NP', w: 1.0, share: '10%', why: 'Neuroplastic exploitation is insidious but typically requires sustained exposure' },
              ].map(r => (
                <tr class="border-b border-[var(--color-border)]/50">
                  <td class="py-2 px-3 font-[family-name:var(--font-mono)] text-[var(--color-accent-primary)] font-semibold">{r.id}</td>
                  <td class="py-2 px-3 font-semibold">{r.w}</td>
                  <td class="py-2 px-3 text-[var(--color-accent-secondary)]">{r.share}</td>
                  <td class="py-2 px-3 text-[var(--color-text-muted)]">{r.why}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </section>

      <!-- Severity Levels -->
      <section id="severity" class="mb-20">
        <h2 class="text-2xl font-bold font-[family-name:var(--font-heading)] mb-6">Severity Levels</h2>
        <div class="space-y-3">
          {severityLevels.map(level => (
            <div class="glass rounded-xl p-4 flex items-start gap-4 border-l-4" style={`border-left-color: ${level.color};`}>
              <div class="shrink-0 w-24">
                <div class="text-lg font-bold font-[family-name:var(--font-heading)]" style={`color: ${level.color};`}>{level.range}</div>
                <div class="text-xs font-semibold" style={`color: ${level.color};`}>{level.label}</div>
              </div>
              <p class="text-sm text-[var(--color-text-muted)]">{level.description}</p>
            </div>
          ))}
        </div>
      </section>

      <!-- Vector Format -->
      <section id="vector" class="mb-20">
        <h2 class="text-2xl font-bold font-[family-name:var(--font-heading)] mb-6">Vector Format</h2>
        <div class="prose mb-6">
          <p>
            Every scored technique carries a compact NISS vector string alongside its CVSS v4.0 base vector. The two together form a complete vulnerability assessment:
          </p>
        </div>
        <div class="glass rounded-xl p-6 mb-4">
          <p class="text-xs font-semibold text-[var(--color-text-faint)] mb-2">NISS Extension Vector</p>
          <p class="font-[family-name:var(--font-mono)] text-sm text-[var(--color-accent-tertiary)] break-all">
            NISS:1.0/BI:&lt;V&gt;/CG:&lt;V&gt;/CV:&lt;V&gt;/RV:&lt;V&gt;/NP:&lt;V&gt;
          </p>
        </div>
        <div class="glass rounded-xl p-6 mb-6">
          <p class="text-xs font-semibold text-[var(--color-text-faint)] mb-2">Companion CVSS v4.0 Base Vector</p>
          <p class="font-[family-name:var(--font-mono)] text-sm text-[var(--color-accent-primary)] break-all">
            CVSS:4.0/AV:&lt;V&gt;/AC:&lt;V&gt;/AT:&lt;V&gt;/PR:&lt;V&gt;/UI:&lt;V&gt;/VC:&lt;V&gt;/VI:&lt;V&gt;/VA:&lt;V&gt;/SC:&lt;V&gt;/SI:&lt;V&gt;/SA:&lt;V&gt;
          </p>
        </div>
        <div class="prose">
          <p>
            Both vectors are designed to be human-readable, machine-parseable, and diff-friendly. Security teams can compare CVSS vectors with standard tooling. BCI safety teams can filter and sort on NISS dimensions (e.g., "show all techniques with BI:H or BI:C") for targeted safety review.
          </p>
        </div>
      </section>

      <!-- Examples -->
      <section id="examples" class="mb-20">
        <h2 class="text-2xl font-bold font-[family-name:var(--font-heading)] mb-6">Scored Examples</h2>
        <p class="text-sm text-[var(--color-text-muted)] mb-6">
          Three examples from the <a href="/TARA/" class="text-[var(--color-accent-primary)] hover:underline">TARA registry</a> showing how NISS + CVSS vectors work together.
        </p>
        <div class="space-y-4">
          {THREAT_VECTORS.filter(t => ['QIF-T0001', 'QIF-T0003', 'QIF-T0045'].includes(t.id)).map(t => (
            <div class="glass rounded-xl p-5 border-l-4" style={`border-left-color: ${t.niss.severity === 'critical' ? '#ef4444' : t.niss.severity === 'high' ? '#f97316' : t.niss.severity === 'medium' ? '#f59e0b' : '#10b981'};`}>
              <div class="flex items-baseline justify-between mb-2">
                <h3 class="text-sm font-semibold font-[family-name:var(--font-heading)]">
                  <span class="font-[family-name:var(--font-mono)] text-[var(--color-text-faint)]">{t.id}</span> {t.name}
                </h3>
                <div class="flex items-center gap-2">
                  {t.niss.pins && (
                    <span class="text-[10px] font-bold px-2 py-0.5 rounded-full bg-[#ef4444]/10 text-[#ef4444]">PINS</span>
                  )}
                  <span class="text-lg font-bold font-[family-name:var(--font-mono)]" style={`color: ${t.niss.severity === 'critical' ? '#ef4444' : t.niss.severity === 'high' ? '#f97316' : t.niss.severity === 'medium' ? '#f59e0b' : '#10b981'};`}>
                    {t.niss.score.toFixed(1)}
                  </span>
                </div>
              </div>
              <p class="text-xs text-[var(--color-text-muted)] mb-3">{t.description}</p>
              <div class="space-y-1">
                <p class="font-[family-name:var(--font-mono)] text-xs text-[var(--color-accent-tertiary)] break-all">NISS: {t.niss.vector}</p>
                {t.cvss && (
                  <p class="font-[family-name:var(--font-mono)] text-xs text-[var(--color-accent-primary)] break-all">CVSS: {t.cvss.base_vector}</p>
                )}
              </div>
            </div>
          ))}
        </div>
        <div class="mt-8 prose">
          <p>
            All {totalTechniques} techniques are scored and browsable in the <a href="/TARA/">TARA Registrar</a>. The scoring methodology is documented in the <a href="/whitepaper/#niss">QIF Whitepaper §6.5</a>.
          </p>
        </div>
      </section>

    </div>
  </div>
</PageLayout>
