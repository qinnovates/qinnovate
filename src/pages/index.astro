---
import BaseLayout from '../layouts/BaseLayout.astro';
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';
import TrustBar from '../components/TrustBar.astro';
import PublicationCard from '../components/PublicationCard.astro';
import { getCollection } from 'astro:content';
import { getPostDate } from '../lib/utils';
import { HOURGLASS_BANDS, HOURGLASS_WIDTHS, STATS, PILLARS, LATEST_WHITEPAPER_HREF } from '../lib/qif-constants';
import HeroParticles from '../components/HeroParticles';
import Hourglass3D from '../components/Hourglass3D';
import '../styles/global.css';

const posts = (await getCollection('blog'))
  .sort((a, b) => new Date(getPostDate(b.data)).getTime() - new Date(getPostDate(a.data)).getTime())
  .slice(0, 4);

---

<BaseLayout title="Qinnovate — Open Standards for the Governance of Neurotechnology" description="Qinnovate develops open standards for the governance of neurotechnology — bridging security engineering and neuroethics. Home of QIF, NSP, and TARA.">
  <Nav />

  <!-- ═══ HERO + THREE PILLARS ═══ -->
  <section class="relative min-h-screen flex flex-col items-center justify-center px-4 overflow-hidden">
    <!-- Gradient background -->
    <div class="absolute inset-0 bg-[var(--color-bg-deep)]">
      <div class="absolute inset-0 opacity-30" style="background: radial-gradient(ellipse at 50% 30%, rgba(59,130,246,0.15) 0%, transparent 60%), radial-gradient(ellipse at 30% 70%, rgba(6,182,212,0.1) 0%, transparent 50%), radial-gradient(ellipse at 70% 60%, rgba(139,92,246,0.08) 0%, transparent 50%);"></div>
    </div>

    <!-- Hero particle system (React island) -->
    <HeroParticles client:idle />

    <div class="relative z-10 text-center max-w-5xl mx-auto pt-24">
      <p class="text-sm font-bold tracking-[0.2em] uppercase mb-6 bg-gradient-to-r from-[var(--color-accent-primary)] via-[var(--color-accent-secondary)] to-[var(--color-accent-tertiary)] bg-clip-text text-transparent">
        Neurotechnology starting with ethics and security at heart
      </p>

      <h1 class="text-4xl sm:text-5xl md:text-6xl font-bold font-[family-name:var(--font-heading)] tracking-tight mb-6 leading-[1.1]">
        <span class="text-[var(--color-text-primary)]">Quantifying the Interface</span>
        <br />
        <span class="bg-gradient-to-r from-[var(--color-accent-primary)] via-[var(--color-accent-secondary)] to-[var(--color-accent-tertiary)] bg-clip-text text-transparent">
          Where Mind Meets Silicon
        </span>
      </h1>
 
      <p class="text-lg sm:text-xl text-[var(--color-text-muted)] mb-12 max-w-2xl mx-auto leading-relaxed">
        Qinnovate develops <strong>QIF</strong> — an open security standard for neural interfaces, bringing engineering rigor to BCI safety.
      </p>

      <!-- Three Pillars — integrated into hero -->
      <div class="grid md:grid-cols-3 gap-4 mb-10 text-left max-w-4xl mx-auto">
        {PILLARS.map((pillar) => (
          <a href={pillar.href} class="glass rounded-xl p-5 card-hover group">
            <div class="flex items-center gap-2 mb-3">
              <div class="text-xl" style={`color: ${pillar.color}`} set:html={pillar.icon} />
              <h3 class="text-base font-semibold font-[family-name:var(--font-heading)] group-hover:text-[var(--color-accent-primary)] transition-colors">
                {pillar.name}
              </h3>
              <span class="text-[10px] px-1.5 py-0.5 rounded-full border border-[var(--color-border)] text-[var(--color-text-faint)] ml-auto whitespace-nowrap">
                v{pillar.version}
              </span>
            </div>
            <p class="text-xs text-[var(--color-text-faint)] mb-1.5 font-medium">{pillar.tagline}</p>
            <p class="text-sm text-[var(--color-text-muted)] leading-relaxed">
              {pillar.description}
            </p>
          </a>
        ))}
      </div>

      <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-6">
        <a
          href={LATEST_WHITEPAPER_HREF}
          class="px-6 py-3 rounded-lg bg-[var(--color-accent-primary)] text-white font-medium hover:bg-[var(--color-accent-primary)]/90 transition-colors"
        >
          Read the Whitepaper
        </a>
        <a
          href="/framework/"
          class="px-6 py-3 rounded-lg glass text-[var(--color-text-primary)] font-medium hover:bg-white/10 transition-colors"
        >
          Explore the Framework
        </a>
      </div>

      <TrustBar />
    </div>

    <!-- Scroll indicator -->
    <div class="absolute bottom-8 left-1/2 -translate-x-1/2 animate-bounce">
      <svg class="w-5 h-5 text-[var(--color-text-faint)]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
      </svg>
    </div>
  </section>

  <!-- ═══ MILESTONE CALLOUT ═══ -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="glass rounded-xl p-6 sm:p-8 reveal" style="border-left: 4px solid var(--color-accent-secondary);">
      <div class="flex flex-col sm:flex-row sm:items-center gap-4">
        <div class="flex-1">
          <p class="text-xs font-semibold tracking-[0.15em] uppercase text-[var(--color-accent-secondary)] mb-2">New</p>
          <h3 class="text-lg font-bold font-[family-name:var(--font-heading)] mb-2">
            Neural Impact Chain
          </h3>
          <p class="text-sm text-[var(--color-text-muted)] leading-relaxed">
            First formal mapping between BCI security techniques and DSM-5-TR psychiatric diagnoses via neural mechanism chains. Every attack vector is now traced from physical mechanism to clinical outcome.
          </p>
        </div>
        <div class="flex flex-col sm:flex-row gap-3 shrink-0">
          <a
            href="/TARA/#diagnostic"
            class="px-5 py-2.5 rounded-lg bg-[var(--color-accent-secondary)] text-white font-medium text-sm hover:bg-[var(--color-accent-secondary)]/90 transition-colors text-center"
          >
            Explore Diagnostic View
          </a>
          <a
            href="/publications/2026-02-13-the-neural-impact-chain-when-niss-scores-predict-psychiatric-diagnoses/"
            class="px-5 py-2.5 rounded-lg glass text-[var(--color-text-primary)] font-medium text-sm hover:bg-white/10 transition-colors text-center"
          >
            Read the Blog
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- ═══ CASE STUDY CALLOUT ═══ -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
    <div class="glass rounded-xl p-6 sm:p-8 reveal" style="border-left: 4px solid var(--color-accent-primary);">
      <div class="flex flex-col sm:flex-row sm:items-center gap-4">
        <div class="flex-1">
          <p class="text-xs font-semibold tracking-[0.15em] uppercase text-[var(--color-accent-primary)] mb-2">Case Study</p>
          <h3 class="text-lg font-bold font-[family-name:var(--font-heading)] mb-2">
            Your Headphones Already Know Your Biometrics
          </h3>
          <p class="text-sm text-[var(--color-text-muted)] leading-relaxed">
            28 consumer sensor exploitation techniques validated with real hardware. ANC earbuds extract ear canal biometrics at &minus;47 dB below music — completely inaudible. No firmware exploit. No elevated privileges. Just physics.
          </p>
        </div>
        <div class="flex flex-col sm:flex-row gap-3 shrink-0">
          <a
            href="/case-studies/t0079-anc-fingerprint/"
            class="px-5 py-2.5 rounded-lg bg-[var(--color-accent-primary)] text-white font-medium text-sm hover:bg-[var(--color-accent-primary)]/90 transition-colors text-center"
          >
            View Case Study
          </a>
          <a
            href="/publications/2026-02-11-your-earbuds-already-know-your-heart-rate-who-else-does/"
            class="px-5 py-2.5 rounded-lg glass text-[var(--color-text-primary)] font-medium text-sm hover:bg-white/10 transition-colors text-center"
          >
            Read the Blog
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- ═══ THE ROAD AHEAD ═══ -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
    <a href="/runemate/" class="block glass rounded-2xl p-8 sm:p-10 card-hover group relative overflow-hidden reveal" style="border: 1px solid rgba(139,92,246,0.2); background: linear-gradient(135deg, rgba(139,92,246,0.05) 0%, rgba(59,130,246,0.05) 100%);">
      <div class="absolute top-0 right-0 w-64 h-64 opacity-[0.03] pointer-events-none" style="background: radial-gradient(circle, var(--color-accent-tertiary), transparent 70%);"></div>
      <div class="flex flex-col sm:flex-row sm:items-center gap-6">
        <div class="flex-1">
          <p class="text-xs font-semibold tracking-[0.15em] uppercase text-[var(--color-accent-tertiary)] mb-2">Where This Is Going</p>
          <h2 class="text-xl sm:text-2xl font-bold font-[family-name:var(--font-heading)] mb-3 group-hover:text-[var(--color-accent-tertiary)] transition-colors">
            Project Runemate
          </h2>
          <p class="text-sm text-[var(--color-text-muted)] leading-relaxed max-w-2xl">
            The open standards that built today's internet — HTTP, TCP/IP, HTML, OSI — need equivalents for the neural frontier. Runemate demonstrates their feasibility: a bytecode compiler that compresses BCI data 65-90%, making post-quantum encryption viable on low-power implantable devices. This is a critical step toward protecting patients from unauthorized neural access — laying the foundation for a trustworthy neural web. Written in Rust. 200 KB on-chip.
          </p>
        </div>
        <div class="text-[var(--color-accent-tertiary)] opacity-60 group-hover:opacity-100 transition-opacity shrink-0">
          <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
          </svg>
        </div>
      </div>
    </a>
  </section>

  <!-- ═══ HOURGLASS PREVIEW ═══ -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24">
    <div class="text-center mb-12 reveal">
      <h2 class="text-3xl font-bold font-[family-name:var(--font-heading)] mb-4">The Hourglass Architecture</h2>
      <p class="text-[var(--color-text-muted)] max-w-2xl mx-auto">
        The QIF framework models the entire neurotechnology stack as a <strong>Quantified Interconnection</strong> — an 11-band hourglass. This architecture places the physical interface at the critical bottleneck, allowing for rigorous security controls at the bio-digital boundary.
      </p>
    </div>
 
    <!-- Interactive 3D hourglass (React island) -->
    <div class="h-[400px] mb-8 reveal">
      <Hourglass3D client:only="react" />
    </div>
 
    <div class="text-center mt-8">
      <a href="/framework/" class="text-sm text-[var(--color-accent-primary)] hover:text-[var(--color-accent-secondary)] transition-colors">
        Explore the full interactive model &rarr;
      </a>
    </div>
  </section>
 
  <!-- ═══ DEVELOPER / SDK SECTION ═══ -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
    <div class="glass rounded-2xl p-8 sm:p-12 overflow-hidden relative reveal">
      <div class="absolute top-0 right-0 w-1/3 h-full opacity-10 pointer-events-none bg-gradient-to-l from-[var(--color-accent-primary)] to-transparent"></div>
      <div class="grid md:grid-cols-2 gap-12 items-center">
        <div>
          <p class="text-xs font-semibold tracking-[0.15em] uppercase text-[var(--color-accent-primary)] mb-3">Researchers & Developers</p>
          <h2 class="text-3xl font-bold font-[family-name:var(--font-heading)] mb-6">Built for Interoperability</h2>
          <p class="text-[var(--color-text-muted)] mb-8 leading-relaxed">
            QIF is more than a paper — it's a technical ecosystem. We provide the tools needed to integrate neural security into existing workflows.
          </p>
          <ul class="space-y-4 mb-8">
            <li class="flex items-start gap-3">
              <div class="mt-1 text-[var(--color-accent-primary)]">
                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              </div>
              <div>
                <span class="font-semibold block">STIX 2.1 Threat Intel</span>
                <span class="text-sm text-[var(--color-text-faint)]">Ingest TARA threats directly into your SIEM/TIP via our JSON API.</span>
              </div>
            </li>
            <li class="flex items-start gap-3">
              <div class="mt-1 text-[var(--color-accent-primary)]">
                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              </div>
              <div>
                <span class="font-semibold block">Python SDK (qtara)</span>
                <span class="text-sm text-[var(--color-text-faint)]">Programmatic access to the registry and automated STIX exports.</span>
              </div>
            </li>
          </ul>
          <div class="flex flex-wrap gap-4">
            <a href="/public/docs/api.md" class="px-6 py-2.5 rounded-lg bg-[var(--color-accent-primary)] text-white text-sm font-medium hover:bg-[var(--color-accent-primary)]/90 transition-colors">API Documentation</a>
            <code class="px-4 py-2.5 rounded-lg glass text-xs font-mono text-[var(--color-text-primary)]">pip install qtara</code>
          </div>
        </div>
        <div class="hidden md:block glass rounded-xl p-6 bg-black/40 font-mono text-xs overflow-hidden border border-white/5 shadow-2xl">
          <div class="flex gap-1.5 mb-4">
            <div class="w-2 h-2 rounded-full bg-[#ff5f56]"></div>
            <div class="w-2 h-2 rounded-full bg-[#ffbd2e]"></div>
            <div class="w-2 h-2 rounded-full bg-[#27c93f]"></div>
          </div>
          <p class="text-gray-500 mb-2"># Fetching STIX Intelligence</p>
          <p class="text-blue-400">import <span class="text-white">requests</span></p>
          <p class="text-blue-400">from <span class="text-white">qtara</span> import <span class="text-white">TARA_Feed</span></p>
          <p class="mb-2 text-white">feed = TARA_Feed(<span class="text-green-400">"https://qinnovate.com/api/stix.json"</span>)</p>
          <p class="text-gray-500 mb-2"># Analyze Neural Impact</p>
          <p><span class="text-purple-400">for</span> threat <span class="text-purple-400">in</span> feed.get_critical():</p>
          <p class="pl-4">print(<span class="text-green-400">f"NISS Score: &#123;threat.niss&#125;"</span>)</p>
          <p class="text-gray-400 mt-4 animate-pulse">_</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ═══ LATEST PUBLICATIONS ═══ -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24">
    <div class="flex items-center justify-between mb-8 reveal">
      <h2 class="text-3xl font-bold font-[family-name:var(--font-heading)]">Latest News</h2>
      <a href="/news/" class="text-sm text-[var(--color-accent-primary)] hover:text-[var(--color-accent-secondary)] transition-colors">
        View all &rarr;
      </a>
    </div>

    <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6 reveal reveal-stagger">
      {posts.map((post) => (
        <PublicationCard
          title={post.data.title}
          date={post.data.date_posted || post.data.date || new Date()}
          tags={post.data.tags}
          slug={post.id}
          body={post.body || ''}
        />
      ))}
    </div>
  </section>

  <!-- ═══ ADOPTION CTA ═══ -->
  <section class="border-t border-[var(--color-border)] bg-[var(--color-bg-deep)]">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20 text-center reveal">
      <h2 class="text-2xl sm:text-3xl font-bold font-[family-name:var(--font-heading)] mb-4">
        The standard is open. Start here.
      </h2>
      <p class="text-[var(--color-text-muted)] max-w-2xl mx-auto mb-8">
        No login, no paywall. Read the spec, explore the threat registry, and adopt the standard at your own pace.
      </p>
      <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
        <a
          href="/TARA/"
          class="px-8 py-3.5 rounded-lg bg-[var(--color-accent-primary)] text-white font-medium hover:bg-[var(--color-accent-primary)]/90 transition-colors"
        >
          Explore the Standard
        </a>
        <a
          href="/adopt/"
          class="px-8 py-3.5 rounded-lg glass text-[var(--color-text-primary)] font-medium hover:bg-white/10 transition-colors"
        >
          Get Involved
        </a>
      </div>
    </div>
  </section>

  <Footer />
</BaseLayout>
