---
import PageLayout from '../../layouts/PageLayout.astro';
---

<PageLayout
  title="Case Study: ANC Ear Canal Fingerprinting (T0079)"
  description="Real hardware validation of covert ear canal biometric extraction via consumer ANC earbuds. 2 subjects, 2 devices, 6 sessions, >99% identification accuracy."
  breadcrumbs={[
    { label: 'TARA', href: '/TARA/' },
    { label: 'T0079 Case Study' },
  ]}
>
  <article class="max-w-3xl mx-auto pb-24">
    <!-- Header -->
    <header class="mb-12 mt-8">
      <p class="text-xs font-semibold tracking-[0.15em] uppercase text-[var(--color-accent-primary)] mb-3">Case Study &middot; QIF-T0079</p>
      <h1 class="text-3xl sm:text-4xl font-bold font-[family-name:var(--font-heading)] mb-4">
        Your Earbuds Can Fingerprint Your Ear Canal
      </h1>
      <p class="text-lg text-[var(--color-text-muted)] leading-relaxed mb-6">
        ANC earbuds contain all the hardware needed to silently extract a biometric fingerprint of your ear canal. We validated this on real hardware: 2 subjects, 2 devices, 6 sessions, >99% identification accuracy. The probe signal can be hidden 47 dB below music &mdash; completely inaudible.
      </p>
      <div class="flex flex-wrap gap-2">
        <span class="text-xs px-2 py-1 rounded-full border border-[var(--color-border)] text-[var(--color-text-faint)]">TARA: QIF-T0079</span>
        <span class="text-xs px-2 py-1 rounded-full border border-[var(--color-border)] text-[var(--color-text-faint)]">Domain: S (Sensor Exploitation)</span>
        <span class="text-xs px-2 py-1 rounded-full border border-[var(--color-border)] text-[var(--color-text-faint)]">Severity: High</span>
        <span class="text-xs px-2 py-1 rounded-full border border-[var(--color-border)] text-[var(--color-text-faint)]">Validated: 2026-02-11</span>
      </div>
    </header>

    <!-- Threat Model -->
    <section class="mb-12">
      <h2 class="text-xl font-bold font-[family-name:var(--font-heading)] mb-4">The Threat</h2>
      <div class="prose">
        <p>
          Your ear canal is a biometric. Its geometry &mdash; length, diameter, tympanic membrane reflectance &mdash; creates a unique acoustic transfer function per individual. Unlike a password, you cannot change it. Unlike a cookie, it follows you across devices. Unlike a MAC address, it is tied to your body.
        </p>
        <p>
          Active Noise Cancelling earbuds already contain a speaker and a feedback microphone pointed directly at the ear canal. The standard Bluetooth Hands-Free Profile (HFP) audio path gives any app with microphone permission the ability to play a probe signal through the speaker and record the ear canal's acoustic response through the microphone.
        </p>
        <p>
          No firmware exploit. No elevated privileges. No ANC telemetry API. Just the standard audio path that every music player, voice assistant, and conferencing app already uses.
        </p>
      </div>

      <!-- Attack surface diagram -->
      <div class="glass rounded-xl p-6 my-6 font-[family-name:var(--font-mono)] text-xs leading-relaxed overflow-x-auto">
        <pre class="text-[var(--color-text-muted)]">
  Phone App (attacker-controlled)
  ┌────────────────────────────────────────────────────┐
  │  Play probe ──── Bluetooth HFP ────┐               │
  │  signal                            ▼               │
  │                          ┌──────────────────┐      │
  │                          │   ANC Earbud      │      │
  │                          │  Speaker ──────►  │      │
  │                          │     │  Ear Canal   │      │
  │                          │     ▼  (unique     │      │
  │  Record     ◄─── BT ────│  Feedback geometry)│      │
  │  response                │  Mic ◄──────────  │      │
  │                          └──────────────────┘      │
  │                                                     │
  │  Extract IR → Features → Identity                   │
  └────────────────────────────────────────────────────┘</pre>
      </div>
    </section>

    <!-- Methodology -->
    <section class="mb-12">
      <h2 class="text-xl font-bold font-[family-name:var(--font-heading)] mb-4">Methodology</h2>
      <div class="prose mb-6">
        <p>
          We tested with two consumer ANC earbuds from different manufacturers (both under $250, standard Bluetooth, silicone tips) and two subjects.
        </p>
      </div>

      <div class="grid sm:grid-cols-2 gap-4 mb-6">
        <div class="glass rounded-lg p-5" style="border-left: 3px solid var(--color-accent-primary);">
          <h3 class="text-sm font-semibold mb-2">Probe Signal</h3>
          <p class="text-xs text-[var(--color-text-muted)]">Exponential swept sine, 200&ndash;7500 Hz, 1.5 s duration, 3 repetitions averaged. Stays below HFP Nyquist limit (8 kHz at 16 kHz sample rate).</p>
        </div>
        <div class="glass rounded-lg p-5" style="border-left: 3px solid var(--color-accent-secondary);">
          <h3 class="text-sm font-semibold mb-2">Impulse Response</h3>
          <p class="text-xs text-[var(--color-text-muted)]">Wiener deconvolution extracts the ear canal transfer function. Open-air control subtracts the earbud/Bluetooth channel, isolating the ear's contribution.</p>
        </div>
        <div class="glass rounded-lg p-5" style="border-left: 3px solid var(--color-accent-tertiary);">
          <h3 class="text-sm font-semibold mb-2">Feature Extraction</h3>
          <p class="text-xs text-[var(--color-text-muted)]">186-dimensional vector: 20 MFCCs + 20 GFCCs + 16 LPC coefficients + 10 spectral features. Captures the acoustic signature across multiple domains.</p>
        </div>
        <div class="glass rounded-lg p-5" style="border-left: 3px solid #10b981;">
          <h3 class="text-sm font-semibold mb-2">Classification</h3>
          <p class="text-xs text-[var(--color-text-muted)]">Cosine similarity on feature vectors. Intra-subject consistency and inter-subject separation measured across all session pairs.</p>
        </div>
      </div>
    </section>

    <!-- Results -->
    <section class="mb-12">
      <h2 class="text-xl font-bold font-[family-name:var(--font-heading)] mb-4">Results</h2>
      <div class="prose mb-6">
        <p>6 sessions across one evening. Each session: 3 in-ear trials + open-air control.</p>
      </div>

      <!-- Experiment conditions table -->
      <div class="overflow-x-auto mb-8">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-[var(--color-border)]">
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Session</th>
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Subject</th>
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Device</th>
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Conditions</th>
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Intra-session</th>
            </tr>
          </thead>
          <tbody>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-3 px-3">1</td>
              <td class="py-3 px-3">A</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)]">A</td>
              <td class="py-3 px-3 text-[var(--color-text-muted)]">Music, gum, reinsertion</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)] text-[#10b981]">&gt;99%</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-3 px-3">2</td>
              <td class="py-3 px-3">A</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)]">A</td>
              <td class="py-3 px-3 text-[var(--color-text-muted)]">No music, gum, typing</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)] text-[#10b981]">&gt;99%</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-3 px-3">3</td>
              <td class="py-3 px-3">A</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)]">A</td>
              <td class="py-3 px-3 text-[var(--color-text-muted)]">No music, partial gum</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)] text-[#10b981]">~99%</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-3 px-3">4</td>
              <td class="py-3 px-3">A</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)]">B</td>
              <td class="py-3 px-3 text-[var(--color-text-muted)]">Music, gum (cross-device)</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)] text-[#10b981]">&gt;99%</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-3 px-3">5</td>
              <td class="py-3 px-3">B</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)]">B</td>
              <td class="py-3 px-3 text-[var(--color-text-muted)]">Quiet</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)] text-[#10b981]">~97%</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-3 px-3">6</td>
              <td class="py-3 px-3">B</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)]">A</td>
              <td class="py-3 px-3 text-[var(--color-text-muted)]">Quiet (wrong-size tips)</td>
              <td class="py-3 px-3 font-[family-name:var(--font-mono)] text-[var(--color-text-muted)]">~96%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Key findings -->
      <div class="glass rounded-xl p-6 mb-8" style="border-left: 3px solid #10b981;">
        <h3 class="text-sm font-semibold text-[#10b981] uppercase tracking-wider mb-3">Key Findings</h3>
        <ul class="space-y-2 text-sm text-[var(--color-text-muted)]">
          <li><strong class="text-[var(--color-text-primary)]">Cross-session:</strong> &gt;99% similarity across all Subject A sessions, regardless of music, gum, typing, or reinsertion.</li>
          <li><strong class="text-[var(--color-text-primary)]">Cross-device:</strong> &gt;99% similarity for Subject A across two manufacturers' earbuds (different codecs, different sample rates).</li>
          <li><strong class="text-[var(--color-text-primary)]">Inter-subject:</strong> ~3.8x separation ratio between Subject A and Subject B on the same device.</li>
          <li><strong class="text-[var(--color-text-primary)]">Ear tip fit matters:</strong> Subject B using Subject A's tips showed degraded consistency (~96%), confirming the measurement reflects true acoustic coupling.</li>
        </ul>
      </div>
    </section>

    <!-- Covert Masking -->
    <section class="mb-12">
      <h2 class="text-xl font-bold font-[family-name:var(--font-heading)] mb-4">Covert Extraction: The Masking Simulation</h2>
      <div class="prose mb-6">
        <p>
          The critical question: can the probe be hidden inside music so the listener hears nothing, yet the fingerprint is still extractable?
        </p>
        <p>
          The swept sine probe has a bandwidth-time product of ~33,000. Wiener deconvolution provides ~45 dB of processing gain &mdash; it correlates the entire recording against the known probe, amplifying the response and suppressing uncorrelated music. The result:
        </p>
      </div>

      <div class="overflow-x-auto mb-6">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-[var(--color-border)]">
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Probe Attenuation</th>
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Probe-to-Masker Ratio</th>
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Fingerprint Similarity</th>
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Audible?</th>
            </tr>
          </thead>
          <tbody>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">0 dB</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">+13 dB</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)] text-[#10b981]">~96%</td>
              <td class="py-2 px-3 text-[#f85149]">Yes</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">-24 dB</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">-11 dB</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)] text-[#10b981]">~96%</td>
              <td class="py-2 px-3 text-[var(--color-text-muted)]">Borderline</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">-48 dB</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">-35 dB</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)] text-[#10b981]">~96%</td>
              <td class="py-2 px-3 text-[#10b981]">No</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">-60 dB</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">-47 dB</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)] text-[#10b981]">~96%</td>
              <td class="py-2 px-3 text-[#10b981]">No</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="glass rounded-xl p-6" style="border-left: 3px solid #f85149;">
        <p class="text-sm text-[var(--color-text-muted)] leading-relaxed">
          <strong class="text-[var(--color-text-primary)]">The fingerprint does not degrade.</strong> From 0 dB to &minus;60 dB attenuation (1000x reduction in probe amplitude), cosine distance changes from 0.0390 to 0.0391. At &minus;47 dB probe-to-masker ratio, the probe is ~200x quieter than the music &mdash; at least 17&ndash;27 dB below the human auditory masking threshold. The listener hears only music. The attacker gets a biometric identifier.
        </p>
      </div>
    </section>

    <!-- Why this matters for BCI -->
    <section class="mb-12">
      <h2 class="text-xl font-bold font-[family-name:var(--font-heading)] mb-4">Why This Matters for BCI Security</h2>
      <div class="prose">
        <p>
          T0079 is Step 1 of a 6-step kill chain documented in the <a href="https://doi.org/10.5281/zenodo.18640106">Zenodo preprint</a>. An ear canal fingerprint establishes persistent identity. Combined with other S-domain techniques (heart rate extraction via headphone driver, gait detection via accelerometer, cognitive state inference via typing dynamics), an attacker builds a multi-modal biometric profile &mdash; all from consumer devices the target already owns.
        </p>
        <p>
          For BCI users, this profile becomes the foundation for targeted attacks at the neural interface. The TARA framework maps this progression: from consumer sensor exploitation (S-domain) through data aggregation to neural-targeted threats.
        </p>
        <p>
          The ear canal fingerprint is <strong>persistent</strong> (geometry doesn't change), <strong>irrevocable</strong> (you can't reset it), <strong>cross-device</strong> (same ear = same fingerprint), and <strong>covert</strong> (embeddable in any audio). These properties make it fundamentally different from digital identifiers &mdash; and fundamentally more dangerous.
        </p>
      </div>
    </section>

    <!-- Limitations -->
    <section class="mb-12">
      <h2 class="text-xl font-bold font-[family-name:var(--font-heading)] mb-4">Limitations</h2>
      <div class="prose">
        <ul>
          <li><strong>N=2 subjects.</strong> Inter-subject discrimination is directionally correct but not statistically significant. A study with N&ge;10 and proper per-subject ear tip fitting is needed for d-prime and EER metrics.</li>
          <li><strong>Single platform.</strong> All recording on macOS Core Audio. Android, Windows, and mobile app paths are untested.</li>
          <li><strong>No longitudinal data.</strong> All sessions within ~3 hours on one evening. Day-over-day stability is unknown (though ear canal geometry is stable in adults).</li>
          <li><strong>Masking is simulated.</strong> The covert extraction uses a real channel model but has not been physically validated with masked audio played through real earbuds. The ~45 dB processing gain provides substantial margin.</li>
        </ul>
      </div>
    </section>

    <!-- Prior Art -->
    <section class="mb-12">
      <h2 class="text-xl font-bold font-[family-name:var(--font-heading)] mb-4">Prior Art</h2>
      <div class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-[var(--color-border)]">
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Work</th>
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Year</th>
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Accuracy</th>
              <th class="text-left py-3 px-3 text-[var(--color-text-faint)] font-medium">Covert?</th>
            </tr>
          </thead>
          <tbody>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-2 px-3">Akkermans et al. (NEC)</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">2005</td>
              <td class="py-2 px-3">&gt;99%</td>
              <td class="py-2 px-3 text-[var(--color-text-faint)]">No</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-2 px-3">Gao et al. (EarEcho, MobiCom)</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">2019</td>
              <td class="py-2 px-3">97.5%</td>
              <td class="py-2 px-3 text-[var(--color-text-faint)]">No</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-2 px-3">Fan et al. (HeadFi, MobiCom)</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">2021</td>
              <td class="py-2 px-3">97&ndash;99%</td>
              <td class="py-2 px-3 text-[var(--color-text-muted)]">Passive</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50">
              <td class="py-2 px-3">EarID</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">2025</td>
              <td class="py-2 px-3">98.7%</td>
              <td class="py-2 px-3 text-[var(--color-text-faint)]">No</td>
            </tr>
            <tr class="border-b border-[var(--color-border)]/50 bg-[var(--color-accent-primary)]/5">
              <td class="py-2 px-3 font-semibold">This work (T0079)</td>
              <td class="py-2 px-3 font-[family-name:var(--font-mono)]">2026</td>
              <td class="py-2 px-3 font-semibold">&gt;99%</td>
              <td class="py-2 px-3 text-[#10b981] font-semibold">Yes</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p class="text-xs text-[var(--color-text-faint)] mt-3">
        Our contribution: (1) attack framing vs. feature framing, (2) standard Bluetooth HFP path only, (3) psychoacoustic masking demonstration &mdash; no prior work has shown covert probe extraction hidden inside music.
      </p>
    </section>

    <!-- Links -->
    <section class="mb-12">
      <h2 class="text-xl font-bold font-[family-name:var(--font-heading)] mb-4">Related</h2>
      <div class="grid sm:grid-cols-2 gap-4">
        <a href="/publications/2026-02-11-your-earbuds-already-know-your-heart-rate-who-else-does/" class="glass rounded-lg p-5 card-hover group" style="border-left: 3px solid var(--color-accent-primary);">
          <p class="text-xs text-[var(--color-text-faint)] mb-1">Blog Post</p>
          <p class="text-sm font-semibold group-hover:text-[var(--color-accent-primary)] transition-colors">How Malicious Apps Derive Your Biometrics</p>
          <p class="text-xs text-[var(--color-text-muted)] mt-1">28 consumer sensor exploitation techniques across 4 tactics</p>
        </a>
        <a href="/TARA/?domain=S" class="glass rounded-lg p-5 card-hover group" style="border-left: 3px solid var(--color-accent-secondary);">
          <p class="text-xs text-[var(--color-text-faint)] mb-1">TARA Atlas</p>
          <p class="text-sm font-semibold group-hover:text-[var(--color-accent-secondary)] transition-colors">S-Domain: Consumer Sensor Exploitation</p>
          <p class="text-xs text-[var(--color-text-muted)] mt-1">Full technique registry with CVSS + NISS scoring</p>
        </a>
        <a href="https://doi.org/10.5281/zenodo.18640106" class="glass rounded-lg p-5 card-hover group" style="border-left: 3px solid var(--color-accent-tertiary);">
          <p class="text-xs text-[var(--color-text-faint)] mb-1">Academic Preprint</p>
          <p class="text-sm font-semibold group-hover:text-[var(--color-accent-tertiary)] transition-colors">Securing Neural Interfaces</p>
          <p class="text-xs text-[var(--color-text-muted)] mt-1">DOI: 10.5281/zenodo.18640106 &middot; T0079 is Step 1 of the kill chain</p>
        </a>
        <a href="/framework/" class="glass rounded-lg p-5 card-hover group" style="border-left: 3px solid #10b981;">
          <p class="text-xs text-[var(--color-text-faint)] mb-1">Framework</p>
          <p class="text-sm font-semibold group-hover:text-[#10b981] transition-colors">QIF Hourglass Architecture</p>
          <p class="text-xs text-[var(--color-text-muted)] mt-1">S-domain bands where sensor exploitation originates</p>
        </a>
      </div>
    </section>

    <!-- Disclosure -->
    <footer class="glass rounded-xl p-6 text-xs text-[var(--color-text-faint)]">
      <p class="mb-2"><strong class="text-[var(--color-text-muted)]">Responsible Disclosure:</strong> This case study presents findings from validated research. Proof-of-concept code is not publicly available. The purpose is to demonstrate that consumer audio hardware presents a real biometric privacy risk, informing security architecture decisions for BCI systems.</p>
      <p><strong class="text-[var(--color-text-muted)]">Citation:</strong> Qi, K. (2026). Securing Neural Interfaces: Architecture, Threat Taxonomy, and Neural Impact Scoring for Brain-Computer Interfaces. Zenodo. <a href="https://doi.org/10.5281/zenodo.18640106" class="text-[var(--color-accent-primary)]">https://doi.org/10.5281/zenodo.18640106</a></p>
    </footer>
  </article>
</PageLayout>
